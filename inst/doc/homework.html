<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="SA24204162" />


<title>Statistical Computing Homework</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Statistical Computing Homework</h1>
<h4 class="author">SA24204162</h4>
<h4 class="date">2024-12-5</h4>



<div id="homework1" class="section level2">
<h2>Homework1</h2>
<div id="exercise-3.4" class="section level3">
<h3>Exercise 3.4</h3>
<div id="question" class="section level4">
<h4>Question</h4>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},x\geq
0,\sigma&gt;0\]</span></p>
<p>Develop an aglorithm to generate random samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution.Generate
Rayleigh(<span class="math inline">\(\sigma\)</span>) samples for
several choices of <span class="math inline">\(\sigma&gt;0\)</span> and
check that the mode of the generated samples is close to the theoretical
mode <span class="math inline">\(\sigma\)</span>(check the
histogram).</p>
</div>
<div id="answer" class="section level4">
<h4>Answer</h4>
<p><span class="math display">\[F(x)=\int_{0}^{x}\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)}dx=1-e^{-\frac{x^2}{2\sigma^2}}\]</span>
then <span class="math display">\[F^{-1}(u)=\sqrt{-2\sigma^2ln(1-u)},0\leq u\leq
1\]</span> ,we can use inverse transform algorithm generate samples.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>Generate_Rayleign <span class="ot">&lt;-</span> <span class="cf">function</span>(N,seed,sig){</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u))</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Empirical Density Graph of Rayleign Distribution--&#39;</span>,sig))</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">8</span>,<span class="fl">0.01</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">lines</span>(y,y<span class="sc">/</span>(sig[<span class="dv">1</span>]<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)) )</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>}</span></code></pre></div>
<ul>
<li><span class="math inline">\(\sigma=0.1\)</span></li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>seed <span class="ot">=</span> <span class="dv">123</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>sig <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="dv">2</span>,<span class="fl">0.4</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="fu">Generate_Rayleign</span>(N,seed,sig[<span class="dv">1</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><span class="math inline">\(\sigma=0.5\)</span></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">Generate_Rayleign</span>(N,seed,sig[<span class="dv">2</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li><span class="math inline">\(\sigma=0.9\)</span></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="fu">Generate_Rayleign</span>(N,seed,sig[<span class="dv">3</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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AFRBilsWu0TB6n6YZXpA+70VSVFBjTPdsQBNC2jFIkBAkQer61Pkwer6FHmooYwmrfEAeS+z8jXqmW6WZH2S+0dQ3MwXA8hjsBpmdHWA8GA1zOj6AEU2SoDipCNAKSbrmTyuUQIUJ936AK1JBAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBBQfUNeO7nU9fY7vP4pblR434QrvXDs2aWtTdEB8H5mjl68vO3yD9nTPTBUZ3HCFrzbxy/UYuEdSbEDy1pDPFjJHnzvYcrceuOGK2JzFa8Nnsd0oTmYUG5BnicSdI+9NHvxiw29H7KtvZwbUueV9Xd6A8Hb7XIUHRubezG2QPNmezYEnIK+lEkeftpw3AOsDdMRttJDHTzCDrUbblH4V819qA0+LcG5uQL6NdOkJKGBfPrhBXaEWwITsYzffZd4PUNfeskYSjV9ELqej6FOgp2u/+OGltlbnoKQBij/U8O/0ewBSlQIbzL1rzuyAViYCBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBAqQPia9Wsn6icXqkD0r/yPptSB1QeL3/52m891jhKHlCZe64CHknpAzoGLUqNruQBne7/OOuujckDKq7+57d6dSSlDohvTTjsp18HKnVAcgH0jM106oBmFwECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgP4PbEVKD7WbI8UAAAAASUVORK5CYII=" /><!-- --></p>
<ul>
<li><span class="math inline">\(\sigma=1.3\)</span></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">Generate_Rayleign</span>(N,seed,sig[<span class="dv">4</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAxlBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtttmtv+QOgCQZgCQZjqQkDqQkGaQkLaQtpCQttuQtv+Q29uQ2/+2ZgC2Zjq2ZpC2kDq2kGa227a229u22/+2/7a2/9u2///T09PbkDrbkGbbtmbbtpDb27bb29vb2//b/9vb////tmb/25D/27b//7b//9v///9l5rcmAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAML0lEQVR4nO2dC3vcOBWGlWzCBLJlu5ntAm22CyzE5RZoTLdAnGT8//8UuliW5JH0Wb5q3PM9TzuxLR9J7xzJulnDalJUbO0E5C4CBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAGxwy27fFR/l0zq7Jv7Xrc2dx7+8tF7+efvua2vXv+3h6WSnd2Fo/lwxdjrJkKVwFfBBFq58R57I7dyfRzeA4gHfhe3aUf+/ObcB0hnppetKKBKWLlxbIaDDwekUnoU/tkLKJbergrmA2Ty4r18lMZIhOaiZXQXCNwDyLH9WK4LF5DMzOc3KgGHD/ye148qjX/mBxfSwL+vG3+UdxbS8rVKMf+yG3/hf5295bd+upLfPjfwxzfs/L7+mdtmr+5kzOd/54Xw4r5rX0kU0K9++yjCtUnXSX26kp/aFj/dxq6LvU66dXxxJ7/Lo7icXDfh2zzy2I8B1S97cYr/L3Tx0UAW6SxbvzCAzn9Ud7bexC81X8fT14KTuunysTJ2imOblrM1Z3gyPID4Of5pbJUmdhXEJF0dK9fjX6ME1HEXJ9cqvMmjH5D6oxDfOP+ypAOIb7oUzsDN7B7rT+JPdaeEwoO9k1E0rm/+avN7eV//h9/xi8fGJo+a2/8knVVdLpuqpvWRUnufKWLGgyxbVuxtmpqkq2POcvd4KFgD6MKJy8m1DG/l0VvEVJp4qBt9rpRFh8e4E/9d/MNOb9E4084uYYqBA0jX1Z//di2hFOpUYew3MdbGFXWZOK6DbmxbVuw6gzrpVhqFfTcvnlzL8FYeI4B4KMuHRRr1V8Sa2sGOvPE5bakBVOlyojN5eN/WsQ2DsmPfcRXrogto9+jYMrHrDOqky2NtzuJtufgxICuPEUAV8wLij3V19k8OIOHllgc08XcBiZgv/vB5bwGS33s30fov66IN6OKnji0Tu0yTlfS2yLR+2QOQlUc/IH7q/KMq2HV7qzH6/PtrmW0bkPBy62HdVNJdQMqxXvbDPYjH+ldp0bFlYtce9K62b+nlQTLXOqjOoxfQ863wW7uePTJ6+KFTvkWQa6sJoh/zB/70NIAqXf5vunVQx36wDrpUj8Sda8vE7nhM7VYDug7yA1K5tmjIPHYBWcWKXzp7Wz/vTf6kUZ6ub6UPmkeidg5mVcxWfSq6CSbQ5aNKSecp1kl0/Ckm2dq2TOwaiE667yl2BMjKtS6iOo/8arCr0TQmVDvFGP3gGpPFSD3HnDaz6Wq8bV3QnNyZdpCq4juJttpB/se89N/WlondaQe1aXTbQSFApqth8sizF+6sPr/n38s3990i9kmUzle6Ja0aqffS5d32/+fvr/SjwHmKXfykm1n/eu+zryRb0r+z73UaiqI0GFsm9iZIm3SrJf3r+1AdZOW6Cd/msT5MNtxhGkH95O/DzRq7aYYkaCpAvMSmZXhSQCD2QlaEVuMwQdMAkoX+BoezNCEgGLtuGCUMUrSaDNDZt2m3TAsIxP4s6sO+A4GuaMgViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAloaEHO0cORDtDigB0sEyBNfg4YRoEB8kg4T/xgB8sWnvUdyWjjyIVoeEKM6KBqfXUufggsNSeLTVdKaejc+B9AJNMNSUti8I9K+gzIoPvcxn78PJSWwUuvZR3gQ67aDsieUlr6XvXrZbyggdgQoe0KpySvO7sYA8rSkNwaoLtnNYEDM19XI3IXSUydef5wK0An0XAck63A7EJCschxA9sd2AI2Kywso557rwGSVA9pBLAToYYOAulb6VCSqSvYCYlsH1MtcGNADAWovBQCxjQDSb/MHa6CBgB42AqjU7xZXoZeMw+ZYFNBDtsOLKck63LZYysAr+hFAzceWAb3s2wZiFShkgwFlO3i2lAexLwEQr4PaXQAT6iC3xxUClH0RszbYCkuPKQY3CfECslmcLiC1T0za/htRc+bcQ6dJGACUJyE3VaMZbR2QQjRi15FRgLIk5CRKbCMjNmscsA+Rz5w+12kyB+ugzAGJCliRCTVyksxZ57YB6GU/ZPuhoDn7XF9AWRIygL5TfEa4Tx0CxPoCypDQEaAhY4Uec/Y5t88VAZSjCzVJKkxTd4bH/AYAGQ+ayJx9rj+gDAktMKLoLuj4MgFFB+1TAOVHSCXoZX/Trm2ZvpLeAKBZzfUFlOc89BKAwkw8B7nNQ9tdjRv58wSD+2GuOetcGqDMpllNSgqx1/muLgZsCOszZ51LApTbPLTVF3vHe/PvZulqbAZQITaknhpQbBjae5DXPLRVxHZiBeLLfuoilg4oq2lWZzxI/K7EKD6TAMprHnr2x3x33SYBOjqTDCireWiTErhyo1ZD+nLuMFSVbxlQgR9f5dldrWrxeQHlNAVkPebhSJmam5eTHr0BseR2UL6A4NpeHYS3ub9AQD0e8O3qjmI3M6As66AKLw/XWNTvLMXNmRODAGVDyF7d0ecppiAebr88QPOYk1MVgwDlQihXQNmMvVrpkD80WvSbFutbSQ8HlAshq5I+uytFb37IxGFwLHlDgMQzvIw0ARPNWYdDH/N5EHIaigLQpCOKWwKkPaiIjdqnvoowClAehLp1UBlrLia/irApQKqpGFtFlb6QfBygLAilpCH5VYQmm0MAZTPNmhJ5sgeNAGR/5AFI9cXi86qpryJsCVDRDKXGF5glvoowGlAGs4hN5JWunMdsfVPPAGj1WUQVuTVaNuHcfHMwBtD606ztAip9YoquhvsMGgVo9UkyDQg+wFPMOVVsOhMX0MpzQDMCYvGc9z0gQAhQDg3FnAGtPD6tAZkqNTtAORSxic1NDWhNQvMBYj1y3hfQioROAtCa4x6nAWhFQtPE3Bm6mQHQaoROxIPWIzQbINYn5/0BrVbITgLQmuOvJwHI/iBA4YNVhhdPCdAqo2dzAWIos4MOVhg9Oy1AKwwOnRig5TuupwZocUJp0fVc3TEvoGUJJcXWd3UHc0vFtIAW7nbMMjc/M6BFCc2yumNuQPWC5ez0PGjhjlliHdRvdcesgCxSSzSK0qLoubpj5Gxz74MlXGiedtBCgOSPA80M6cQBzV8hDbQafxVhOUBHqIZyCGqeQfsT0LKANiwCBDRxZ3V7mrizuj1N3NVojGat+QD1XmYVMRq+tP6V0cH7e9CQS+tfGR8cd1ah0fUxzAkId1ah0fUxzApovNH1MRCgwVemCD7a6PoYCNDgK1MEH210fQw5ANqSCBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECGh6QFVsG6unX3lnQ+SEpH+Yu4yZ82+4pgaGvXuQPF0FLgQ1OSCxj0wVytLL3jtddLjlN5TelItlJEFzlX9w/OmXIaIVD5/4uw9TA1JTQ4EtZKrApLXak8e3pEbuuhLayVluHeqLJjRppxKXtn3L1IDCeZWTRbEJx6CjhACVlz94AZUhFwm7VliTA5JpCHKIAQpuql/6yfGo/HVQ8XWgRqvO/7lP/RHHqQEpNwjXGmFAocnIKpAlUV68gMQPzHBKnptKUcITf1slG0BV+Oni/21lsG2oLyblimnbt+RSxKKT2T7eMqIIIN9mbKpqTNumbclKug4Diu++581ss5gllFlfhaxiT6uqF33MBwEFd5BVaIJ+5/Wg8D1q/c66RSzeUAwk7ukq6D8CgbXsxnPVc1Z8Pd6t1cuoNa+m72pE+wZ+QE1x8d5WRIpRqA4K31MFuzQhUWcViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEFDugMRaNesnKpdX7oD0r7yvptwBibXN36Uv/55O2QOqi8S3TyZW/oCq8Aq8JZQ9oMPtb1bdtTF7QOXl/9KWpU6s3AGJpc3jfvp1pHIHpNZJr1hN5w5odREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECOj/27OHxxOhS4sAAAAASUVORK5CYII=" /><!-- --></p>
<ul>
<li><span class="math inline">\(\sigma=1.7\)</span></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">Generate_Rayleign</span>(N,seed,sig[<span class="dv">5</span>])</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion" class="section level4">
<h4>Conclusion</h4>
<p>From the graph above,we can get that our algorithm behave robust for
different choice of <span class="math inline">\(\sigma\)</span>.when the
parameter <span class="math inline">\(\sigma\)</span> become lager,the
axis value x become more discrete.</p>
</div>
</div>
<div id="exercise-3.11" class="section level3">
<h3>Exercise 3.11</h3>
<div id="question-1" class="section level4">
<h4>Question</h4>
<p>Generate a random sample of size 1000 from a normal location
mixture.The components of the mixturre have <span class="math inline">\(N(0,1)\)</span> and <span class="math inline">\(N(3,1)\)</span>,distributions with mixing
probabilities <span class="math inline">\(p_1\)</span> and <span class="math inline">\(p_2=1-p_1\)</span>.Graph the histogram of the
sample with density superimposed,for <span class="math inline">\(p_1=0.75\)</span>.Repeat with different values for
<span class="math inline">\(p_1\)</span> and observe whether the
empirical distribution of the mixture appears to be binodal.Make a
conjecture about the values of <span class="math inline">\(p_1\)</span>
that produce bimodal mixtures.</p>
</div>
<div id="answer-1" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>theory_density <span class="ot">&lt;-</span> <span class="cf">function</span>(p1,y){</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">return</span>(p1<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>((y)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>))<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p1)<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>((y<span class="dv">-3</span>)<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(<span class="dv">2</span>)))</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> <span class="fl">0.75</span></span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="dv">1</span>,<span class="at">prob =</span> <span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1))</span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>x <span class="ot">&lt;-</span> p<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>x2</span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Mix-Gaussian Distribution--&#39;</span>,p1))</span>
<span id="cb8-9"><a href="#cb8-9" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="fl">0.01</span>)</span>
<span id="cb8-10"><a href="#cb8-10" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="fu">theory_density</span>(p1,y))</span></code></pre></div>
<p><img src="data:image/png;base64,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UaaN/lcyWw/vpgXkrnKptEo02MopaQ5AT1gEBDTyZPXpaeTJ6tPTyFONyESfqJOefpvVMZbijwhovBo0esBlAIqYrI6c6KkBwpPVkRM9OUAjiYDGSpSAxgpIQHOEzAk+jgjoCYmAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICGgOQPrxI17ULmPPw4q0VynxkLYZAO02styFQIeoqANpyhhCkfas2cQF9RkAmRN40CEq5hlTzFk0cfYq6eNGYwJazeaDUOVIKnaEvUrF5TcnAggdof/wW1Xg+Ce4cUfyS6vL90Fa8NGjqRGR9SL2UaZqt6cBqIzy0fGAsD2tjKNG5wEUcb+Tmljko3Btc9GAqq9rjzlrL8VJx57dV1QbYFLOsZujBkWdFxvfzcfZq7XoGqT1sIq639EDxUh7VssHVFV0WPYicqoRa6/S8gGdlggIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICGjpgNQWM+8rKqfX0gHZb3mfTUsHtC/Pf/xy2DeYD9PiAe23sW9hHEfLB1QmbdEcXYsHtNt8PeupjYsHVFy+38x5aOPSAamjCYedSThQSwekNu1632U+vZYOaHYREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERDQ/wEDtwrLtQP6+wAAAABJRU5ErkJggg==" /><!-- --></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>Generate_MixGaussian<span class="ot">&lt;-</span> <span class="cf">function</span>(p1,N,seed){</span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">3</span>,<span class="dv">1</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),N,<span class="at">prob =</span> <span class="fu">c</span>(p1,<span class="dv">1</span><span class="sc">-</span>p1),<span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>x <span class="ot">&lt;-</span> p<span class="sc">*</span>x1<span class="sc">+</span>(<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>x2</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a><span class="fu">hist</span>(x,<span class="at">probability =</span> <span class="cn">TRUE</span>,<span class="at">main =</span> <span class="fu">paste</span>(<span class="st">&#39;Mix-Gaussian Distribution--&#39;</span>,p1))</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">8</span>,<span class="dv">8</span>,<span class="fl">0.01</span>)</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a><span class="fu">lines</span>(y,<span class="fu">theory_density</span>(p1,y))</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>){</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">Generate_MixGaussian</span>(p[i],N,<span class="dv">123</span>)  </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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9rkAIg9Cwk81RhVyOYDGTlafD6BnKAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQKKAUjeyXbdH8n9u1558yr5dl07btQL0cYrAqDTPSeQOeoptp3J3YS8ebUFz82XnH+V1nseuqR23Ol+FqtuUrp3nPHlVZL7hzq+U9bTelOIU91uggG48ypl62+cgI6fTtuyTigaoO4t89UpoEcAnu32uQF3DMqv/rWd+v7qWIAcd7GVb/g8xJ1XSDQiN6BMPOGc+C6VSIByT4xGgFx5hfx7h2arPv7pVxxATh/o0cR8T1Bkdg8gaXfatmxhAenXs7v31sNB2rsvX6ZXuDgIKPDTQnUMD/LsD4u6eV9eI7cHqUfByTex48bjA2Cg6M2r5RlJixBlPQ8eowiAdDtwUMi8Uw1/XiXfVCOHExUkmqwCESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAkodkFh8Zr2iMr5SB2Te8n42pQ5IrHV+OX05+HglD6jYT/w1ykSlDyjHyzhDKnlAp/s/nnVLwuQBZesP05apTlTqgMRS52kLnScqdUB7udL5jGE6dUBnFwECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgH4DfKjTXcnkNE8AAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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73EQDEoE5WFYdAI0J0CtNkDpnMj5AMKT1V6JnA2gFlONXomcDaDea2EvBRB5EBJ+qtErkfMB1HeyejmALlAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIENAYgeSfbd38kD+96FYyrFNp17bBhbNBmJGMAOj5wApknn2LbmdxPKBhXWwjcfMn5VyO852Gg1I47zc9i1U1K/44zobhKcv9Qz3fK+hgvJYygZjfBAPxxlbL1N15Ah4+Hv/hzNEDNW+arIqBHAIHt9rkBfxuUX/2yHfr+6rEAee5iK98IeYg/rpCoRH5AmXjC2W2r9ZpGApQH2mgEyBdXKLx3aLZq459hjQPI6wMtqljoCYqMHgAk7Q7bli0tIP16dv/eeriRDu7Ll+kVLh4CCvywpnoMDwrsD4u6+VBcI78HqUfBs69ih03AB8BAMRhXKzCSFk2U8zy4j0YApOuBh0IWnGqE4yqFpho5nKgg0WQViAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIENDcAYnFZ84rKsfX3AGZt7xPprkDEmudvxi+HLy/Zg/otBv4a5SBmj+gHC/jTKnZAzo+fDXploSzB5St3w9bpjpQcwckljoPW+g8UHMHtJMrnSdspucOaHIRICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAjo/3ghGtH2Im++AAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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erFY46EkA0W229Wo5O7FYs5Ep/CgltNkBtRglQ+Qf6DYqlPnrySAYr8Ecg5KuPzxMkSAgEYCivKOw1koiwfNozn25D0OgkmJoDxMi06AzgnQyA1Qng0gfLE6KpGLATT6ffPPBdDotbDPBRB5EBKe1RiVyOUAGnux+nwAPUMRICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQUA5A8k627/5IGd71KhhXKbTr2n7FGNzEN6gMgA4bTqDw5FNsO1P6CQXjaguBmy8l/yn0noceygBI7bjTPRerblL6d5wJxVWS+4d6flPWU2zXkkDdboIB+OMqFctvvID2H09/6142QN1b5qsioCmAwHb73IC/DSqvfllPfX91LkCeu9jKN0Ie4o8rJCqRH1AhZjh7bLUeUiZAZaCNRoB8cYXCe4cWiz7+GVYeQF4f6FHFQjMoMnoAkLQb3JYNKi0g/Xp2/956uJEO7stX6BUuHgIK/LSmOocHBfaHRd18KK6R34PUVPDZV7H9KuADYKAYjKsVGEmLJsqZDx6jDIB0PfBQKIKXGuG4SqFLjRJeqCDRxSoQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgoHMHJBafOa+ozK9zB2Te8n4ynTsgsdb5i+nLwcfr7AEdtxOfRpmo8wdU4mWcKXX2gA6br066JeHZAyqW76ctU52ocwckljpPW+g8UecOaCtXOp+wmT53QCcXAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICACBAQAQIiQEAECIgAAREgIAIERICA/g9/YmgMPRYWQgAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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AI2eC/uxAGIEIeGnGqMyOR1AYwerHw+gj1AEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEA5AOk72aH7I2V81atoWqPYqmtPK/NJvfHKAGh7LwkUgeNUy86UYULRtNZD5OZLKf/V8zsPIWUAZFbc2f8s1tykDK84E0trpNcPDfzPeE/+pZB5tD9MMIBwWqPi8psgoKffTv/qXjZA+5fMN6eAHgFEltuXDsJ1UHn+z5up36/OBShwF9vERixCwmmVVCEKAyrUE86J31LJBKiM1NEIUCitUnzt0OKsT3zGlQdQMAZ6FLHYExSdPAJI+522LFtaQPbz7OG19XAlHV2Xr7AzXAIEDPhpVXWOCIqsD4ua+Vhap3AEmUfBiy9iT6tIDICOYjStVaQnraoo73nwGGUAZMtBgEIRHWrE0xrFhholHKggcbAKREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQEsHpCafeZ+ozK+lA3JfeT+Ylg5IzXX+cvp08PFaPKDdeuLbKBO1fEAlnsaZUosHtL3/w0GXJFw8oOLy/bRpqhO1dEBqqvO0ic4TtXRAaz3T+YDV9NIBHVwEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAT0fxf4wgvOuRIpAAAAAElFTkSuQmCC" /><!-- --><img src="data:image/png;base64,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AgIiICACAiIgIAICIiAgAgIiIKAlAOk72aH7I3l816toXqPYrmv7jXmVzHAtAOiwlQSyQD3VtjN5mFA0r7UQufmSyz/N/56HsTI77rQ/izU3KcM7zsTyGun9QwN/M9aXeCnhBGp3EwwgnNcou/4mCGj/23Fb1iktBqh9y3xzCugRQGS7fWkgHIPyy3/ejn1/9VKAAnexjW/EPCScV0k1ojCgTD3h7LfVekMLAcojMRoBCuVViu8dml108c+4lgEU9IEOTSz2BEVnjwDSdsdtyzYvIPt69vDeejhIR/fly+wKlwABA35cqF7CgyL7w6JuPpbXKexB5lFw8k1sv4n4ABgoRvNaRUbSKkR5z4OHaAFAth0EKGTRqUY8r1FsqpHDiQoSJ6tABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQEREBABAREQEAEBERAQAQElDogtfjMe0Xl8kodkHvL+2pKHZBa6/zl+OXgw5U8oONu5K9RRip9QDlexjmnkgd02P5h1S0JkweUXb8ft0x1pFIHpJY6j1voPFKpA9rplc4rhunUAa0uAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAICIiAgAgIiICACAiIgIAIC+j83WQicOJ3ArwAAAABJRU5ErkJggg==" /><!-- --><img src="data:image/png;base64,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IeFZjUGZnA+goYPVywF0gSJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCgKQDJO9mu+yMF2vXKE1fJt+vafqPeUjBcEwA63HMCuaOcYtuZwk3IG1en4Ln5UvCffO956KAJAKkdd9rnYtVNSveOM764SnL/UMdvKvUpXkoYQe1mggG44yrl62+cgPYfh791bzJA7Vvmq1NAUwCe7fZ5Am4fVFz9vA19f/VUgBx3sZVt+CzEHVdIVCI3oFzMcHbaat2tiQAVHh+NALniCvn3Ds1XXezTr2kAOW2gQxXzzaDI6B5AMt2wbdnGBaRfz+7eWw87ae++fLle4eIgoMCHueopLMizPyxq5n1xjdwWpKaCk69i+43HBkBH0RtXy9OTFi7Kmg8eogkA6XrgoJB7hxr+uEq+oUYBBypINFgFIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBJQ6ILH4zHpF5fRKHZB5y/tsSh2QWOv8Rfhy8OFKHtAxC3waJVDpAyrwMs4xlTygw/1Xs25JmDygfP0+bJlqoFIHJJY6hy10DlTqgDK50nlGN506oNlFgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESCg/wMIA1jdtuJBIwAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="conclusion-1" class="section level4">
<h4>Conclusion</h4>
<p>From the graph above,we find that the empirical distribution of the
mixture appears to be binodal when <span class="math inline">\(p_1\)</span> is close to 0.5.</p>
</div>
</div>
<div id="exercise-3.20" class="section level3">
<h3>Exercise 3.20</h3>
<div id="question-2" class="section level4">
<h4>Question</h4>
<p>A compound Poission process is a stochastic process <span class="math inline">\(\{X(t),t\geq 0\}\)</span> that can be represented
as the random sum <span class="math inline">\(X(t)=\sum_{i=1}^{N(t)}Y_i,t\geq 0\)</span>,where
<span class="math inline">\(\{N(t),t\geq 0\}\)</span> is a Poission
process and <span class="math inline">\(Y_1,Y_2,\cdots\)</span> are iid
and indepedent of <span class="math inline">\(\{N(t),t\geq
0\}\)</span>.Write a program to simulate a compound Poisson(<span class="math inline">\(\lambda\)</span>)-Gamma process (<span class="math inline">\(Y\)</span> has a Gamma distribution).Estimate the
mean and the variance of <span class="math inline">\(X(10)\)</span> for
several choices of the parameters and compare with the theoretical
values.</p>
</div>
<div id="answer-2" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># Function to simulate the compound Poisson-Gamma process</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>Generate_compound_poisson_gamma <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda, k, theta, t, N) {</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  </span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>N) {</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a><span class="co"># Simulate N(t), the number of events in time t, from Poisson distribution</span></span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>    N_t <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, lambda <span class="sc">*</span> t)</span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>    </span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>    <span class="co"># Simulate Y_i from Gamma distribution, shape = k, rate = theta</span></span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>    <span class="cf">if</span> (N_t <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>      Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(N_t, <span class="at">shape =</span> k, <span class="at">rate =</span> theta)</span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>      results[i] <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y)  <span class="co"># X(t) = sum of the Y&#39;s</span></span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a>      results[i] <span class="ot">&lt;-</span> <span class="dv">0</span>  <span class="co"># If N(t) = 0, X(t) = 0</span></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>    }</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>  }</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  </span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co">#parameters</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="dv">10</span><span class="co"># Time point for X(t)</span></span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>)<span class="co"># Rate of Poisson process</span></span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">100</span>)<span class="co"># Shape parameter of Gamma distribution</span></span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>theta <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">10</span>,<span class="dv">20</span>)<span class="co"># Rate parameter of Gamma distribution</span></span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span><span class="co"># Number of simulations</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" tabindex="-1"></a><span class="co">#Simalation</span></span>
<span id="cb14-2"><a href="#cb14-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb14-3"><a href="#cb14-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Parameters Combination&quot;</span>,<span class="st">&quot;Mean(Predict)&quot;</span>,<span class="st">&quot;Mean(True)&quot;</span>,<span class="st">&quot;Variance(Predict)&quot;</span>,<span class="st">&quot;Variance(True)&quot;</span>,<span class="st">&quot;Mean Error&quot;</span>,<span class="st">&quot;Variance Error&quot;</span>,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Parameters Combination Mean(Predict) Mean(True) Variance(Predict) Variance(True) Mean Error Variance Error</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda)){</span>
<span id="cb16-2"><a href="#cb16-2" tabindex="-1"></a>  <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k)){</span>
<span id="cb16-3"><a href="#cb16-3" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(theta)){</span>
<span id="cb16-4"><a href="#cb16-4" tabindex="-1"></a>      xt <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb16-5"><a href="#cb16-5" tabindex="-1"></a>      xt <span class="ot">&lt;-</span><span class="fu">Generate_compound_poisson_gamma</span>(lambda[i],k[j], theta[l], t, N)</span>
<span id="cb16-6"><a href="#cb16-6" tabindex="-1"></a>      mean_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(xt)</span>
<span id="cb16-7"><a href="#cb16-7" tabindex="-1"></a>      var_hat <span class="ot">&lt;-</span> <span class="fu">var</span>(xt)</span>
<span id="cb16-8"><a href="#cb16-8" tabindex="-1"></a>      mean_true <span class="ot">&lt;-</span> lambda[i] <span class="sc">*</span> t <span class="sc">*</span>(k[j]<span class="sc">/</span>theta[l])</span>
<span id="cb16-9"><a href="#cb16-9" tabindex="-1"></a>      var_true <span class="ot">&lt;-</span> lambda[i] <span class="sc">*</span> t <span class="sc">*</span>(((k[j]<span class="sc">+</span>k[j]<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>(theta[l]<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb16-10"><a href="#cb16-10" tabindex="-1"></a>      value <span class="ot">&lt;-</span> <span class="fu">c</span>(mean_hat,mean_true,var_hat,var_true)</span>
<span id="cb16-11"><a href="#cb16-11" tabindex="-1"></a>      relative_error<span class="ot">&lt;-</span><span class="fu">c</span>(<span class="fu">abs</span>((mean_hat<span class="sc">-</span>mean_true)<span class="sc">/</span>mean_true),<span class="fu">abs</span>((var_hat<span class="sc">-</span>var_true)<span class="sc">/</span>var_true))</span>
<span id="cb16-12"><a href="#cb16-12" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">&quot;(&quot;</span>,lambda[i],<span class="st">&quot;,&quot;</span>,k[j],<span class="st">&quot;,&quot;</span>,theta[l],<span class="st">&quot;):&quot;</span>,value,relative_error,<span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb16-13"><a href="#cb16-13" tabindex="-1"></a>    }</span>
<span id="cb16-14"><a href="#cb16-14" tabindex="-1"></a>  }</span>
<span id="cb16-15"><a href="#cb16-15" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## ( 1 , 1 , 0.5 ): 20.15465 20 80.41633 80 0.007732332 0.00520413 
## ( 1 , 1 , 1 ): 10.03192 10 20.09817 20 0.003191612 0.00490827 
## ( 1 , 1 , 3 ): 3.349719 3.333333 2.274089 2.222222 0.004915709 0.02334003 
## ( 1 , 1 , 10 ): 0.9944835 1 0.1958303 0.2 0.005516501 0.02084837 
## ( 1 , 1 , 20 ): 0.4977533 0.5 0.04964641 0.05 0.004493443 0.007071705 
## ( 1 , 5 , 0.5 ): 99.69828 100 1185.124 1200 0.003017239 0.01239648 
## ( 1 , 5 , 1 ): 49.75231 50 300.9812 300 0.0049538 0.003270583 
## ( 1 , 5 , 3 ): 16.62961 16.66667 32.83581 33.33333 0.00222369 0.01492556 
## ( 1 , 5 , 10 ): 4.980557 5 3.015816 3 0.003888535 0.005271948 
## ( 1 , 5 , 20 ): 2.516741 2.5 0.7642826 0.75 0.00669642 0.01904353 
## ( 1 , 10 , 0.5 ): 199.4139 200 4333.255 4400 0.002930639 0.01516938 
## ( 1 , 10 , 1 ): 99.81415 100 1082.79 1100 0.001858498 0.01564548 
## ( 1 , 10 , 3 ): 33.48427 33.33333 123.6196 122.2222 0.004528015 0.01143314 
## ( 1 , 10 , 10 ): 10.02505 10 11.16141 11 0.002504972 0.0146735 
## ( 1 , 10 , 20 ): 5.009454 5 2.766917 2.75 0.001890784 0.00615176 
## ( 1 , 20 , 0.5 ): 400.0184 400 17069.37 16800 4.604347e-05 0.01603417 
## ( 1 , 20 , 1 ): 200.1397 200 4280.807 4200 0.0006984486 0.01923987 
## ( 1 , 20 , 3 ): 67.02839 66.66667 466.5796 466.6667 0.005425792 0.0001865025 
## ( 1 , 20 , 10 ): 19.98317 20 41.88085 42 0.0008416057 0.002836939 
## ( 1 , 20 , 20 ): 9.982916 10 10.44565 10.5 0.001708449 0.005176033 
## ( 1 , 100 , 0.5 ): 2001.478 2000 408059.8 404000 0.0007391974 0.01004895 
## ( 1 , 100 , 1 ): 999.181 1000 101840.9 101000 0.0008190429 0.008326128 
## ( 1 , 100 , 3 ): 331.8197 333.3333 10991.45 11222.22 0.004540755 0.02056346 
## ( 1 , 100 , 10 ): 99.48316 100 997.0568 1010 0.005168423 0.0128151 
## ( 1 , 100 , 20 ): 49.93955 50 251.2791 252.5 0.001209043 0.004835392 
## ( 3 , 1 , 0.5 ): 60.00532 60 239.3907 240 8.866335e-05 0.002538752 
## ( 3 , 1 , 1 ): 30.00159 30 59.25655 60 5.288982e-05 0.0123908 
## ( 3 , 1 , 3 ): 10.03156 10 6.721371 6.666667 0.003155767 0.00820571 
## ( 3 , 1 , 10 ): 2.994774 3 0.6071314 0.6 0.001742145 0.01188558 
## ( 3 , 1 , 20 ): 1.498155 1.5 0.1486413 0.15 0.00123013 0.009057728 
## ( 3 , 5 , 0.5 ): 300.3206 300 3538.946 3600 0.001068698 0.01695951 
## ( 3 , 5 , 1 ): 149.911 150 881.9785 900 0.0005932577 0.02002387 
## ( 3 , 5 , 3 ): 49.94104 50 98.58649 100 0.001179231 0.01413509 
## ( 3 , 5 , 10 ): 14.98521 15 9.155753 9 0.0009856842 0.01730585 
## ( 3 , 5 , 20 ): 7.492602 7.5 2.220337 2.25 0.0009864261 0.01318357 
## ( 3 , 10 , 0.5 ): 602.4606 600 12852.17 13200 0.004101042 0.02635112 
## ( 3 , 10 , 1 ): 299.6104 300 3312.624 3300 0.00129877 0.003825463 
## ( 3 , 10 , 3 ): 99.84661 100 360.1248 366.6667 0.001533887 0.01784134 
## ( 3 , 10 , 10 ): 29.961 30 33.05196 33 0.001300025 0.001574536 
## ( 3 , 10 , 20 ): 14.96574 15 8.207554 8.25 0.002283971 0.005145018 
## ( 3 , 20 , 0.5 ): 1198.141 1200 50514.06 50400 0.001549237 0.002263076 
## ( 3 , 20 , 1 ): 598.424 600 12674.01 12600 0.002626598 0.005874021 
## ( 3 , 20 , 3 ): 200.2193 200 1387.526 1400 0.001096588 0.008909929 
## ( 3 , 20 , 10 ): 59.95306 60 127.8332 126 0.0007824096 0.01454955 
## ( 3 , 20 , 20 ): 30.04424 30 32.0526 31.5 0.001474572 0.01754277 
## ( 3 , 100 , 0.5 ): 6011.147 6000 1199212 1212000 0.001857759 0.0105512 
## ( 3 , 100 , 1 ): 2994.546 3000 303275.6 303000 0.001818076 0.0009095294 
## ( 3 , 100 , 3 ): 997.1288 1000 33911.44 33666.67 0.002871169 0.007270501 
## ( 3 , 100 , 10 ): 300.9026 300 3025.032 3030 0.003008574 0.001639521 
## ( 3 , 100 , 20 ): 150.1925 150 782.4648 757.5 0.001283509 0.03295678 
## ( 5 , 1 , 0.5 ): 100.095 100 400.4952 400 0.0009504519 0.001238065 
## ( 5 , 1 , 1 ): 50.06918 50 99.1273 100 0.001383644 0.008726954 
## ( 5 , 1 , 3 ): 16.63816 16.66667 11.15359 11.11111 0.001710204 0.003823132 
## ( 5 , 1 , 10 ): 5.000685 5 0.9919192 1 0.0001370626 0.008080771 
## ( 5 , 1 , 20 ): 2.492468 2.5 0.2489099 0.25 0.00301261 0.004360299 
## ( 5 , 5 , 0.5 ): 500.7781 500 6171.949 6000 0.001556228 0.02865812 
## ( 5 , 5 , 1 ): 249.6172 250 1513.525 1500 0.001531089 0.009016451 
## ( 5 , 5 , 3 ): 83.36312 83.33333 167.0578 166.6667 0.0003574275 0.00234682 
## ( 5 , 5 , 10 ): 25.02419 25 15.23154 15 0.0009674966 0.01543606 
## ( 5 , 5 , 20 ): 12.47367 12.5 3.685836 3.75 0.002106286 0.01711032 
## ( 5 , 10 , 0.5 ): 1001.475 1000 21567.14 22000 0.001475381 0.01967533 
## ( 5 , 10 , 1 ): 501.2104 500 5314.946 5500 0.002420836 0.03364618 
## ( 5 , 10 , 3 ): 166.355 166.6667 612.2679 611.1111 0.001870249 0.001892979 
## ( 5 , 10 , 10 ): 50.12011 50 56.38217 55 0.002402173 0.02513034 
## ( 5 , 10 , 20 ): 25.05554 25 13.42108 13.75 0.002221508 0.02392165 
## ( 5 , 20 , 0.5 ): 1997.128 2000 83996.68 84000 0.001435899 3.95431e-05 
## ( 5 , 20 , 1 ): 1001.687 1000 21138.52 21000 0.001686603 0.00659601 
## ( 5 , 20 , 3 ): 333.1184 333.3333 2330.686 2333.333 0.0006449115 0.001134554 
## ( 5 , 20 , 10 ): 100.0281 100 210.2795 210 0.0002810724 0.001331171 
## ( 5 , 20 , 20 ): 50.05367 50 52.50621 52.5 0.001073441 0.0001182537 
## ( 5 , 100 , 0.5 ): 10010.2 10000 2022126 2020000 0.001019795 0.00105229 
## ( 5 , 100 , 1 ): 5000.093 5000 511246.9 505000 1.865143e-05 0.01237009 
## ( 5 , 100 , 3 ): 1670.104 1666.667 57049.92 56111.11 0.002062105 0.01673119 
## ( 5 , 100 , 10 ): 500.7789 500 4908.599 5050 0.001557822 0.02800028 
## ( 5 , 100 , 20 ): 250.4951 250 1264.133 1262.5 0.001980259 0.001293249 
## ( 10 , 1 , 0.5 ): 199.8501 200 812.6256 800 0.0007493044 0.01578202 
## ( 10 , 1 , 1 ): 99.94654 100 199.8221 200 0.0005346373 0.0008894207 
## ( 10 , 1 , 3 ): 33.2756 33.33333 22.20298 22.22222 0.001731857 0.0008659366 
## ( 10 , 1 , 10 ): 9.983651 10 2.000549 2 0.001634937 0.0002745462 
## ( 10 , 1 , 20 ): 5.001073 5 0.5054382 0.5 0.0002146008 0.0108765 
## ( 10 , 5 , 0.5 ): 999.5128 1000 12246.03 12000 0.0004872205 0.02050219 
## ( 10 , 5 , 1 ): 499.7995 500 3002.032 3000 0.0004009214 0.0006772715 
## ( 10 , 5 , 3 ): 166.6816 166.6667 326.3793 333.3333 8.945371e-05 0.02086223 
## ( 10 , 5 , 10 ): 50.00556 50 28.93445 30 0.000111252 0.03551843 
## ( 10 , 5 , 20 ): 25.03121 25 7.438435 7.5 0.001248492 0.008208643 
## ( 10 , 10 , 0.5 ): 1997.966 2000 43986.33 44000 0.001016984 0.0003105761 
## ( 10 , 10 , 1 ): 998.007 1000 10721.95 11000 0.001992957 0.02527711 
## ( 10 , 10 , 3 ): 332.8975 333.3333 1241.829 1222.222 0.00130737 0.01604179 
## ( 10 , 10 , 10 ): 99.86279 100 109.4467 110 0.001372083 0.00503035 
## ( 10 , 10 , 20 ): 50.0369 50 26.89662 27.5 0.0007380663 0.02194092 
## ( 10 , 20 , 0.5 ): 4003.824 4000 166509.9 168000 0.0009558837 0.008869911 
## ( 10 , 20 , 1 ): 1998.214 2000 41225.12 42000 0.0008928373 0.01844942 
## ( 10 , 20 , 3 ): 666.2113 666.6667 4661.147 4666.667 0.0006830969 0.001182748 
## ( 10 , 20 , 10 ): 200.2087 200 419.1864 420 0.001043425 0.001937196 
## ( 10 , 20 , 20 ): 100.1046 100 104.5013 105 0.001045595 0.004749464 
## ( 10 , 100 , 0.5 ): 19991.89 20000 4072951 4040000 0.0004054017 0.008156235 
## ( 10 , 100 , 1 ): 9988.913 10000 989502 1010000 0.001108691 0.02029503 
## ( 10 , 100 , 3 ): 3331.468 3333.333 110802 112222.2 0.0005594908 0.01265526 
## ( 10 , 100 , 10 ): 1000.65 1000 9809.437 10100 0.0006496818 0.02876864 
## ( 10 , 100 , 20 ): 499.4555 500 2533.757 2525 0.001088943 0.003468105 
## ( 20 , 1 , 0.5 ): 399.7208 400 1648.537 1600 0.0006980022 0.03033558 
## ( 20 , 1 , 1 ): 200.2593 200 399.565 400 0.001296332 0.001087497 
## ( 20 , 1 , 3 ): 66.61625 66.66667 44.1341 44.44444 0.0007562102 0.006982767 
## ( 20 , 1 , 10 ): 19.96194 20 3.913936 4 0.001903164 0.02151594 
## ( 20 , 1 , 20 ): 10.01545 10 1.026047 1 0.00154496 0.02604748 
## ( 20 , 5 , 0.5 ): 1999.776 2000 23352.59 24000 0.0001121569 0.0269753 
## ( 20 , 5 , 1 ): 1000.532 1000 5923.718 6000 0.0005319691 0.01271363 
## ( 20 , 5 , 3 ): 332.9038 333.3333 682.0856 666.6667 0.00128862 0.02312833 
## ( 20 , 5 , 10 ): 100.0117 100 60.02531 60 0.0001166025 0.000421762 
## ( 20 , 5 , 20 ): 50.04858 50 14.66681 15 0.0009716956 0.02221272 
## ( 20 , 10 , 0.5 ): 3999.551 4000 90439.71 88000 0.0001121476 0.02772396 
## ( 20 , 10 , 1 ): 1997.974 2000 21730.51 22000 0.001013082 0.01224972 
## ( 20 , 10 , 3 ): 666.1688 666.6667 2416.013 2444.444 0.0007468379 0.01163094 
## ( 20 , 10 , 10 ): 199.9549 200 223.7096 220 0.0002252734 0.01686167 
## ( 20 , 10 , 20 ): 99.9616 100 55.81155 55 0.0003839699 0.01475539 
## ( 20 , 20 , 0.5 ): 7996.62 8000 335299.5 336000 0.000422516 0.002084826 
## ( 20 , 20 , 1 ): 3997.915 4000 82549.72 84000 0.0005212166 0.01726521 
## ( 20 , 20 , 3 ): 1334.358 1333.333 9537.513 9333.333 0.0007687177 0.02187639 
## ( 20 , 20 , 10 ): 399.6439 400 836.7308 840 0.0008902667 0.003891963 
## ( 20 , 20 , 20 ): 199.9153 200 206.5324 210 0.0004232681 0.01651238 
## ( 20 , 100 , 0.5 ): 40015 40000 8124890 8080000 0.0003749448 0.005555654 
## ( 20 , 100 , 1 ): 19998.98 20000 2023518 2020000 5.07878e-05 0.001741378 
## ( 20 , 100 , 3 ): 6669.92 6666.667 223431 224444.4 0.0004879869 0.004515347 
## ( 20 , 100 , 10 ): 2000.622 2000 20420.04 20200 0.0003111729 0.01089298 
## ( 20 , 100 , 20 ): 1000.41 1000 5102.913 5050 0.0004098531 0.01047785</code></pre>
</div>
<div id="conclusion-2" class="section level4">
<h4>Conclusion</h4>
<p>From the result,we can get a conclusion that estimation
error(relative error) is very small,and behave robust for choice of
parameters.</p>
</div>
</div>
</div>
<div id="homework2" class="section level2">
<h2>Homework2</h2>
<div id="complexity-of-quicksort" class="section level3">
<h3>Complexity of Quicksort</h3>
<div id="question-3" class="section level4">
<h4>Question</h4>
<ul>
<li><p>For <span class="math inline">\(n = 10^4, 2 × 10^4, 4 × 10^4, 6 ×
10^4, 8 × 10^4\)</span>, apply the fast sorting algorithm to randomly
permuted numbers of <span class="math inline">\(1,\cdots,n\)</span>.</p></li>
<li><p>Calculate computation time averaged over 100 simulations, denoted
by <span class="math inline">\(a_n\)</span>.</p></li>
<li><p>Regress an on <span class="math inline">\(t_n:= n
log(n)\)</span>, and graphically show the results (scatter plot and
regression line).</p></li>
</ul>
</div>
<div id="answer-3" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" tabindex="-1"></a><span class="co">#Quicksort Alogorithm Realization</span></span>
<span id="cb18-2"><a href="#cb18-2" tabindex="-1"></a>Quicksort <span class="ot">&lt;-</span> <span class="cf">function</span>(a){</span>
<span id="cb18-3"><a href="#cb18-3" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(a)<span class="sc">&lt;=</span><span class="dv">1</span>) {</span>
<span id="cb18-4"><a href="#cb18-4" tabindex="-1"></a>      <span class="fu">return</span>(a)</span>
<span id="cb18-5"><a href="#cb18-5" tabindex="-1"></a>  }</span>
<span id="cb18-6"><a href="#cb18-6" tabindex="-1"></a>  <span class="co">#select a bechmark element</span></span>
<span id="cb18-7"><a href="#cb18-7" tabindex="-1"></a>  pivot <span class="ot">&lt;-</span> a[<span class="dv">1</span>]</span>
<span id="cb18-8"><a href="#cb18-8" tabindex="-1"></a>  left <span class="ot">&lt;-</span> a[a<span class="sc">&lt;</span>pivot]</span>
<span id="cb18-9"><a href="#cb18-9" tabindex="-1"></a>  right <span class="ot">&lt;-</span> a[a<span class="sc">&gt;</span>pivot]</span>
<span id="cb18-10"><a href="#cb18-10" tabindex="-1"></a>  <span class="co">#recursively use Quicksort function</span></span>
<span id="cb18-11"><a href="#cb18-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="fu">Quicksort</span>(left),pivot,<span class="fu">Quicksort</span>(right)))</span>
<span id="cb18-12"><a href="#cb18-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a><span class="co">#Test on Quicksort function</span></span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">124</span>)</span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>v <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">3</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">9</span>)</span>
<span id="cb19-4"><a href="#cb19-4" tabindex="-1"></a><span class="fu">Quicksort</span>(v)</span></code></pre></div>
<pre><code>## [1] -1  2  3  4  6  9</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="co">#Construct a function to compute the compution time</span></span>
<span id="cb21-2"><a href="#cb21-2" tabindex="-1"></a>measure_sort_time <span class="ot">&lt;-</span> <span class="cf">function</span>(n,<span class="at">simulations =</span> <span class="dv">100</span>){</span>
<span id="cb21-3"><a href="#cb21-3" tabindex="-1"></a>  times <span class="ot">&lt;-</span> <span class="fu">replicate</span>(simulations,{</span>
<span id="cb21-4"><a href="#cb21-4" tabindex="-1"></a>    <span class="co"># Generate a random permutation of numbers from 1 to n</span></span>
<span id="cb21-5"><a href="#cb21-5" tabindex="-1"></a>    perm <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n)</span>
<span id="cb21-6"><a href="#cb21-6" tabindex="-1"></a>    <span class="co"># Measure the sorting time via Quicksort</span></span>
<span id="cb21-7"><a href="#cb21-7" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb21-8"><a href="#cb21-8" tabindex="-1"></a>    <span class="fu">Quicksort</span>(perm)</span>
<span id="cb21-9"><a href="#cb21-9" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb21-10"><a href="#cb21-10" tabindex="-1"></a>    time <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb21-11"><a href="#cb21-11" tabindex="-1"></a>    time</span>
<span id="cb21-12"><a href="#cb21-12" tabindex="-1"></a>  })</span>
<span id="cb21-13"><a href="#cb21-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(times))</span>
<span id="cb21-14"><a href="#cb21-14" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" tabindex="-1"></a>n_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)<span class="sc">*</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span></span>
<span id="cb22-2"><a href="#cb22-2" tabindex="-1"></a><span class="co"># Calculate average sorting times</span></span>
<span id="cb22-3"><a href="#cb22-3" tabindex="-1"></a>a_n <span class="ot">&lt;-</span> <span class="fu">sapply</span>(n_values,measure_sort_time)</span>
<span id="cb22-4"><a href="#cb22-4" tabindex="-1"></a><span class="co">#Calculate tn</span></span>
<span id="cb22-5"><a href="#cb22-5" tabindex="-1"></a>t_n <span class="ot">&lt;-</span> n_values <span class="sc">*</span> <span class="fu">log</span>(n_values)</span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="at">t_n =</span> t_n, </span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>  <span class="at">a_n =</span> a_n</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>)</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(a_n<span class="sc">~</span>t_n,<span class="at">data=</span> df)</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = a_n ~ t_n, data = df)
## 
## Residuals:
##          1          2          3          4          5 
##  0.0010648 -0.0004953 -0.0006935 -0.0007487  0.0008727 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 3.333e-03  8.429e-04   3.955   0.0289 *  
## t_n         1.199e-07  1.550e-09  77.384 4.76e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.00103 on 3 degrees of freedom
## Multiple R-squared:  0.9995, Adjusted R-squared:  0.9993 
## F-statistic:  5988 on 1 and 3 DF,  p-value: 4.756e-06</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" tabindex="-1"></a><span class="co">#Regress Plot</span></span>
<span id="cb25-2"><a href="#cb25-2" tabindex="-1"></a><span class="co"># Plot scatter plot and regression line</span></span>
<span id="cb25-3"><a href="#cb25-3" tabindex="-1"></a><span class="fu">ggplot</span>(df, <span class="fu">aes</span>(<span class="at">x =</span> t_n, <span class="at">y =</span> a_n)) <span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb25-5"><a href="#cb25-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-6"><a href="#cb25-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Regression of Average Sorting Time on t_n&quot;</span>,</span>
<span id="cb25-7"><a href="#cb25-7" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;t_n = n log(n)&quot;</span>,</span>
<span id="cb25-8"><a href="#cb25-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Average Sorting Time (a_n)&quot;</span>) <span class="sc">+</span></span>
<span id="cb25-9"><a href="#cb25-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span></code></pre></div>
<pre><code>## `geom_smooth()` using formula = &#39;y ~ x&#39;</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion-3" class="section level4">
<h4>Conclusion</h4>
<p>Based on the regression output, the regression effect is significant,
and the regression plot also shows a good fit. Therefore, through our
numerical simulation method for verification, we can indeed conclude
that the quicksort algorithm has an average time complexity of <span class="math inline">\(O(n \log n)\)</span>.</p>
</div>
</div>
<div id="exercise-5.4" class="section level3">
<h3>Exercise 5.4</h3>
<div id="question-4" class="section level4">
<h4>Question</h4>
<p>Write a function to compute a Monte Carlo estimate of the Beta(3,3)
cdf,and use the function to estimate <span class="math inline">\(F(x)\)</span> for <span class="math inline">\(x=0.1,0.2,\cdots,0.9\)</span>.Compute the
estimates with the values returned by the pbeta function in R.</p>
</div>
<div id="answer-4" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" tabindex="-1"></a><span class="co">#A function of estimate for Beta(3,3)</span></span>
<span id="cb27-2"><a href="#cb27-2" tabindex="-1"></a>BetaF_estimate <span class="ot">&lt;-</span> <span class="cf">function</span>(x,<span class="at">seed=</span><span class="dv">123</span>,<span class="at">N=</span><span class="dv">10000</span>){</span>
<span id="cb27-3"><a href="#cb27-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(seed)</span>
<span id="cb27-4"><a href="#cb27-4" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb27-5"><a href="#cb27-5" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(N,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb27-6"><a href="#cb27-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">sum</span>(X<span class="sc">&lt;</span>x)<span class="sc">/</span>N)</span>
<span id="cb27-7"><a href="#cb27-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a><span class="co">#Get an estimate via Monte Carlo</span></span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>x_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="fl">0.9</span>,<span class="fl">0.1</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a>F_estimate <span class="ot">&lt;-</span> <span class="fu">sapply</span>(x_values,BetaF_estimate)</span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a><span class="co">#Generate value via pbeta function</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a>F_theory <span class="ot">&lt;-</span> <span class="fu">pbeta</span>(x_values,<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a><span class="co">#Compare the theory and simulation result</span></span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a><span class="fu">plot</span>(x_values,<span class="at">y =</span> F_estimate,<span class="at">type =</span> <span class="st">&#39;l&#39;</span>,<span class="at">col =</span> <span class="st">&#39;red&#39;</span>,</span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&#39;cdf value of Beta(3,3)&#39;</span>,<span class="at">xlab =</span> <span class="st">&#39;x&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;F(x)&#39;</span>)</span>
<span id="cb28-9"><a href="#cb28-9" tabindex="-1"></a><span class="fu">lines</span>(x_values,<span class="at">y=</span>F_theory,<span class="at">col =</span> <span class="st">&#39;blue&#39;</span>)</span>
<span id="cb28-10"><a href="#cb28-10" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&#39;topleft&#39;</span>,<span class="at">col =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>,<span class="st">&#39;blue&#39;</span>),<span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb28-11"><a href="#cb28-11" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>),<span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&#39;Estimate&#39;</span>,<span class="st">&#39;Theory&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAA0lBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrY6AAA6ADo6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmAGZmOgBmOjpmOpBmZgBmZmZmkJBmkLZmkNtmtrZmtttmtv+QOgCQOmaQZgCQZjqQkDqQkGaQkLaQttuQ27aQ2/+2ZgC2Zjq2ZpC2kDq2kGa2tv+225C227a229u22/+2/7a2/9u2///bkDrbtmbbtpDb27bb/7bb/9vb////AAD/tmb/25D/27b//7b//9v///9X1+73AAAACXBIWXMAAA7DAAAOwwHHb6hkAAALn0lEQVR4nO2dD5+bthnHucvuZqdNk9m3ZmuXxrdla3qs7dqlK027O3w27/8tVf8ACSR+YJAQvuf3+eRi7AcJvjx6JIQkkoLUqWTuA4hdBAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAEC8gMoTS5/Lo7/XifJK7fR8Ta5vu+dpJZalkhdvPzQNPr2Z/OLw/birige3zHjv9V5Vdv79WVjh5Y8Asr5SWzcRsMAaamVgJKkcXqPnzfPN+NZHLbCeFV+WW+zQ+g4QCGPgLKEXz23hgHSUqsBNU4vbRKTAJj9W/5nV+9fbmfwEKYB9MsnSfKHt+KQWEm4es+PNBWl4E478Fwc08fP2fcv7kpA8jd2UTdib7bLK+2QP75mCfPCoKXGzkpy2K+FV1Q7pcqpqhxYjmyX4/efsnyYsQKkb9ffegWUVpeTnXTp/NopSTLMjB1YruLHnQWQ8v2ryg2UrwizNqCPa3MnBajOobJkB5aa/qy21YXxDIgd0Z/uH7cq7qzu+SU1ihhDsVIHwz7+UVy+jQUQ+/xB/ibFPjKLLJHlxFLEru+NnWTdYOSwqg7x6s485Cvl3KCMTQFInmP28r9FfbpmDMqM7V+//4SHyBYgdTnry66KZjOiVYAu3hbGTlUMUjmw31b1LnqFWm23wlZTEwDSgm15yZqnxIu6Mju+S1Qd0gLErOrSoSUsEnIFaX0nmVadg+aMqjzWUtuoJpkIUFmDlpesCYibyKPlQerq61+3DUDixzwxAZWpiRDW9EcmUar1ncoiVuagA2r5ivL7MIA0DxIfW9U8O6d/is19GVgtgJpVituD1Kny7/SdRFpaDpEAUlnlL947Y5AsCPxsZYWmBWlplScyBq0sCVtikPKgW/advlPZPt3VxBmgx9frTaGFY2M7CCB2SK/uuWfvVC2WJk1AogrmV1pUTOzMKg8SdRT/QtRCLOyyglM6JKzFpAtWOwkbLQcJ78g5Fr8k5TXRtsME6aodtKo/tgDl6r6gaiiVgKogWzdp9JJZ1eZWQKopU37k8ejyf0YOq6Ios2CpGFmqYBCgmlct6Tf80/G7NWtTt281qpLA65ir97yUqBCzZ+3elz/KyvrxHTt2/RZUtKTfSCptQC+EZb0Tb4BdfahzKO8kHl+rm1OVZbXd42bsvLs78laESc0ot1+DEHTmgJiDmLda+7W5nQe6WY1WmVkvHt+9MX9PZ+ruiEaHbWclNVuH2RmJAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERIKCJASWL0VyApk3OX/YEaCpLAjRZkp2pDC7afoSzf3j2rKdl7yQHKWpADI7CQ4Baenio4XRb9k7yJEUJ6KFJx2nZO8mTFR0gCedZD8veSY5SZIAsruOw7J3kSEUF6OHBQadl2TvJ0YoJUAceAgTwECCAxxugNElWYkKTa7J5JIAeAB5fgDIxf03M8HZMcRgBqJxpps0uyXcsJ+fE/7z9i8weuk/hCdDxlmHJxfyhzDFJZgygVpIdcBy/iux74PEESBxSLleZcEwCmR8QLl2lZT959qCHDjVMNUBizuSO/73+jWHYr7/aJsmGb8sVLvj/4lcxoVWb0ZT0KV3WAx1vyFXFIIGqR3JdfNyAxKy3PNlxHzkIQGJaOJ9iyZdXYPln7AvhQZmYxVsdTNITzyJrsTJIb6ryWwPaFOWf3eHmTiKUv3I2dXmPtsNsiuRqDypnwdWAdoX2R02+57/I8l7Ps3wigArlpHZALOpc/qA8KFdeFx+gzHstlvJFFSyAqo3ag07JfoF90g1A7PytgETAyTX/Mo6j/xFPbug9uRqQ8Iuce9DG7kFqtaGNrMW4sw3OfomAlA+ys83lf3zdiN9sMejiLhWL4ah2UF3cZwdUrrzhnEwdyc3qhJbDGoplozV3zcd/2oC09rOHm9UpNDMgrc7wcLM6hciDgOaPQcqFKAY5pFZ7cq8p89QB+UuuRJ9c/tTZTTZV9osDxLV/zlvE3f2IU2VPgKayjBHQl6pvtepOzeWHw82/ksu/8iWlspU9heUBetah1s4lIN7Bqv6JfkR5786XReTLLYvVSB1OtjhAXXzcgFTfatmdKptf6u5e3t4/dyxdtzhAw6TFIPan6k6VPaoCmXiosXI2U58YoLI7VQJSHWjCp1LX0nVPC1DZDdbwoMPNNzeuxSG9Amp2gJ+kCQFV1b0Wg3Zi89MJGvJDAdWLDh9v0fq4k+Rrkwmo7k6tazGBLHMvDukN0OHPOhNzq1cqkwwkbwCqu1PLdpAE5KzDzj4G9dT+M+fyqz4BHf7TO/Ep8h2hzL38qldAWxn6jn8/PQKFALRfd6zf67sW2+kvtThJZ90fJJ/poOWDJ8rXjzwHablu/yidNSD+VqlBb7Qak68f+Q3SonTlFIMchoe/SNeJvRabKPtzbihOkr3XW43mqwVOydePZr5ZrR7NuMd3nC2gold3h3qg2uVBM6vvaft7sipeNhOyiPUe+TxM3oJ0Kh41hAPkic/gIN3/YV3G5wQEA+SLz0mAnPMLTJVTJsbl20/e+PgE1H6j0Cn59pI/Pl4BTZJvH3nk4x2Qh5H2TfWd2HSaAnvQCQ0RJK94zqCIeeYzHFDtA1F0d/jm46uhGGqkvXc+ngCFGmnvn48fQKHGSQfg4wdQoJH2Ifgs2YOC8PEWg5QLeYxBYfj46w+StZi/kfaB+Cy20z4Un6UCCsZnmYD83p6aWiKggHgWCSgonwUCCstneYAC81kaoJDhWWpZgILjWRigGfgsCtAcfEIDGtNpPwuf5XhQ+PAstRRAM+FZDKDZ+CwE0Hx8FgForvAjFD+gWfHED2hmPLEDmh1P3IAiwBM1oBjwRDx4IQr3KaIdvBALnkgfPceDJ8rBCzHhic+Deq81H0oxDV6wv79qZsUyeMH9/qqZFUM7yPZiuGg0NyDXi+GikW9A3SPtY3YdpXk77WOnU8xfxKIXAQKK9mY1Fs12s7oY+QDU41ZjdEazmE2VRI+b1dEZLRoQeRASvlkdndGyAeGb1dEZLRyQ/4wIUIxmnpOYNCMCFKOZ5yTOWwQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgTkG1AuX2stJJ6q2ftqdTOu1N5naZjxFS/tb6ozzPj7XXZWs17yDIi/4ql8zdPxlr92znpOupnYtnfqGmY5M+Fv/AFmmXo50KnyC0g+B0nlWcglYG3jQgyzQnR92wAZZnIDpna8XRlJD5ZfQBYm+UX71UVNs+z6HzZAhpn7FUiGWeyAxFkYTxlTyzVvmLFNawwyzPLLn7b2iGamFncRk+5iRhfLOZlmvIhYARlm4h070j+6M23G/4EKDCh3xujajD+17QHoouWc1tS4x4qXkZ6osEXM8UTWMBMbuIjJGGNb+9tMzVkz9FTQIO16+Z5hlqnxKZYz180kAFuoNs1ahXygAlbz9aP9bjMuqwcZZtU7RbvNJK3hg1EqBWwodkSCZkPR0ZI2W4DMxL6AsWEWdwwSBYYfKq9uVNmxertmJuS41TDMcueNi2GWOs16iW5WgQgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAERICACBESAgAgQEAECIkBABAiIAAHFDogPFDtsx7/G/GTFDogPkRq+Fs+Eih0QHw99M2IU72hFD6hIHTNWAil+QGOGyU+g6AEdb784fYjqBIoeUHb9f+tQ1lCKHRAfDj1ilPN4xQ4oFaOhZwzTsQOaXQQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAiJAQAQIiAABESAgAgREgIAIEBABAvods2kpBr6bckEAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="conclusion-4" class="section level4">
<h4>Conclusion</h4>
<p>From the scatter plot,we conclude that Monte Carlo estimate is almost
as good as the theoretical value generated by the function rbeta.</p>
</div>
</div>
<div id="exercise-5.9" class="section level3">
<h3>Exercise 5.9</h3>
<div id="question-5" class="section level4">
<h4>Question</h4>
<p>The Rayleigh density is <span class="math display">\[f(x)=\frac{x}{\sigma^2}e^{-x^2/(2\sigma^2)},x\geq0,\sigma&gt;0.\]</span>
Implement a function to generate samples from a Rayleigh(<span class="math inline">\(\sigma\)</span>) distribution,using antithetic
varibles.What is the percent reduction in variance of <span class="math inline">\(\frac{X+X^{&#39;}}{2}\)</span> compared with <span class="math inline">\(\frac{X_1+X_2}{2}\)</span> for indepedent <span class="math inline">\(X_1,X_2\)</span>?</p>
</div>
<div id="answer-5" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" tabindex="-1"></a><span class="co">#density function of rayleigh </span></span>
<span id="cb29-2"><a href="#cb29-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(sig,x){</span>
<span id="cb29-3"><a href="#cb29-3" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">/</span>(sig<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb29-4"><a href="#cb29-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co">#Generate Rayleign distribution via Inverse transformation</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>Generate_Rayleign <span class="ot">&lt;-</span> <span class="cf">function</span>(sig,u,<span class="at">seed =</span> <span class="dv">123</span>){</span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a><span class="fu">set.seed</span>(seed)</span>
<span id="cb30-4"><a href="#cb30-4" tabindex="-1"></a>u1 <span class="ot">&lt;-</span> u[<span class="dv">1</span><span class="sc">:</span>(<span class="fu">length</span>(u)<span class="sc">/</span><span class="dv">2</span>)]</span>
<span id="cb30-5"><a href="#cb30-5" tabindex="-1"></a>u2 <span class="ot">&lt;-</span> u[(<span class="fu">length</span>(u)<span class="sc">/</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(<span class="fu">length</span>(u))]</span>
<span id="cb30-6"><a href="#cb30-6" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u1))</span>
<span id="cb30-7"><a href="#cb30-7" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span><span class="sc">*</span>sig<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="fu">log</span>(<span class="dv">1</span><span class="sc">-</span>u2))</span>
<span id="cb30-8"><a href="#cb30-8" tabindex="-1"></a>x <span class="ot">&lt;-</span> (<span class="fu">as.vector</span>(x1) <span class="sc">+</span> <span class="fu">as.vector</span>(x2))<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb30-9"><a href="#cb30-9" tabindex="-1"></a><span class="fu">return</span>(x)</span>
<span id="cb30-10"><a href="#cb30-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a><span class="co">#antithetic variables</span></span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>N <span class="ot">=</span> <span class="dv">10000</span></span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>U1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(N<span class="sc">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">c</span>(U1,<span class="dv">1</span><span class="sc">-</span>U1)</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>sig_values <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>,<span class="dv">2</span>,<span class="fl">0.4</span>)</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>,<span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol =</span> <span class="fu">length</span>(sig_values))</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a><span class="fu">rownames</span>(A) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;anti_variance&#39;</span>,<span class="st">&#39;simple_variance&#39;</span>,<span class="st">&#39;reduction percent&#39;</span>)</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a><span class="fu">colnames</span>(A) <span class="ot">&lt;-</span> sig_values</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a><span class="cf">for</span>(sig <span class="cf">in</span> sig_values){</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">Generate_Rayleign</span>(sig,u)</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>  var_anti <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>  A[<span class="dv">1</span>,count] <span class="ot">&lt;-</span> var_anti</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>  count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>}</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a></span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a><span class="co">#simple variables</span></span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>count <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a><span class="cf">for</span>(sig <span class="cf">in</span> sig_values){</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">Generate_Rayleign</span>(sig,u)</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>  var_simple <span class="ot">&lt;-</span> <span class="fu">var</span>(x)</span>
<span id="cb31-23"><a href="#cb31-23" tabindex="-1"></a>  A[<span class="dv">2</span>,count] <span class="ot">&lt;-</span> var_simple</span>
<span id="cb31-24"><a href="#cb31-24" tabindex="-1"></a>  count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb31-25"><a href="#cb31-25" tabindex="-1"></a>}</span>
<span id="cb31-26"><a href="#cb31-26" tabindex="-1"></a>A[<span class="dv">3</span>,] <span class="ot">&lt;-</span> (A[<span class="dv">2</span>,]<span class="sc">-</span>A[<span class="dv">1</span>,])<span class="sc">/</span>A[<span class="dv">2</span>,]</span>
<span id="cb31-27"><a href="#cb31-27" tabindex="-1"></a>A</span></code></pre></div>
<pre><code>##                           0.1         0.5         0.9        1.3        1.7
## anti_variance     0.000114925 0.002873126 0.009308927 0.01942233 0.03321333
## simple_variance   0.002046931 0.051173272 0.165801400 0.34593132 0.59156302
## reduction percent 0.943854953 0.943854953 0.943854953 0.94385495 0.94385495</code></pre>
</div>
<div id="conclusion-5" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,we can conclude that the variance of antithetic
variable reduce approximate 94% compare with the simple
variable(indepedent).At the same time,this result behaves robust for
different choices of parameter <span class="math inline">\(\sigma\)</span>.</p>
</div>
</div>
<div id="exercise-5.13" class="section level3">
<h3>Exercise 5.13</h3>
<div id="question-6" class="section level4">
<h4>Question</h4>
<p>Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((0,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1.\]</span>
Which of your two importance functions should produce the smaller
variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span>
by importance sampling?Explain. #### Answer</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>  <span class="fu">return</span>(x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span><span class="sc">*</span>pi)<span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">2</span>)) <span class="sc">*</span> (x<span class="sc">&gt;</span><span class="dv">1</span>)</span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>}</span>
<span id="cb33-4"><a href="#cb33-4" tabindex="-1"></a>f3 <span class="ot">&lt;-</span> <span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">2</span></span></code></pre></div>
<ul>
<li><p>the first importance functions use <span class="math inline">\(x\sim N(0,1),x&gt;1\)</span></p></li>
<li><p>the second importance function use <span class="math inline">\(N(3,0.5^2),x&gt;1\)</span></p></li>
<li><p>the third importance function use <span class="math inline">\(x^2,x&gt;1\)</span></p></li>
</ul>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co">#Estimate the integral via importance sampling</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb34-3"><a href="#cb34-3" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb34-4"><a href="#cb34-4" tabindex="-1"></a>replica <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb34-5"><a href="#cb34-5" tabindex="-1"></a>estimate_f1 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(replica)</span>
<span id="cb34-6"><a href="#cb34-6" tabindex="-1"></a>estimate_f2 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(replica)</span>
<span id="cb34-7"><a href="#cb34-7" tabindex="-1"></a>estimate_f3 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(replica)</span>
<span id="cb34-8"><a href="#cb34-8" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>replica){</span>
<span id="cb34-9"><a href="#cb34-9" tabindex="-1"></a>  sample_1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb34-10"><a href="#cb34-10" tabindex="-1"></a>  sample_2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(N,<span class="dv">3</span>,<span class="fl">0.5</span>)</span>
<span id="cb34-11"><a href="#cb34-11" tabindex="-1"></a>  u <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb34-12"><a href="#cb34-12" tabindex="-1"></a>  sample_3 <span class="ot">&lt;-</span> (<span class="dv">3</span><span class="sc">*</span>u)<span class="sc">^</span>{<span class="dv">1</span><span class="sc">/</span><span class="dv">3</span>}</span>
<span id="cb34-13"><a href="#cb34-13" tabindex="-1"></a>  estimate_f1[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(sample_1)<span class="sc">/</span><span class="fu">dnorm</span>(sample_1)<span class="sc">*</span>(sample_1<span class="sc">&gt;</span><span class="dv">1</span>))</span>
<span id="cb34-14"><a href="#cb34-14" tabindex="-1"></a>  estimate_f2[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(sample_2)<span class="sc">/</span><span class="fu">dnorm</span>(sample_2,<span class="dv">3</span>,<span class="fl">0.5</span>)<span class="sc">*</span>(sample_2<span class="sc">&gt;</span><span class="dv">1</span>))</span>
<span id="cb34-15"><a href="#cb34-15" tabindex="-1"></a>  estimate_f3[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">g</span>(sample_3)<span class="sc">/</span><span class="fu">f3</span>(sample_3)<span class="sc">*</span>(sample_3<span class="sc">&gt;</span><span class="dv">1</span>))</span>
<span id="cb34-16"><a href="#cb34-16" tabindex="-1"></a>}</span>
<span id="cb34-17"><a href="#cb34-17" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;the mean and variance of f1:&#39;</span>,<span class="fu">mean</span>(estimate_f1),<span class="st">&quot;,&quot;</span>,<span class="fu">var</span>(estimate_f1),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## the mean and variance of f1: 0.4010488 , 0.0001339638</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;the mean and variance of f2:&#39;</span>,<span class="fu">mean</span>(estimate_f2),<span class="st">&quot;,&quot;</span>,<span class="fu">var</span>(estimate_f2),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## the mean and variance of f2: 0.4020189 , 0.003246173</code></pre>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&#39;the mean and variance of f3:&#39;</span>,<span class="fu">mean</span>(estimate_f3),<span class="st">&quot;,&quot;</span>,<span class="fu">var</span>(estimate_f3),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span></code></pre></div>
<pre><code>## the mean and variance of f3: 0.1226257 , 8.096703e-07</code></pre>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a>integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(x) (x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span> <span class="sc">*</span> pi)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>true_value <span class="ot">&lt;-</span> <span class="fu">integrate</span>(integrand, <span class="dv">1</span>, <span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>true_value</span></code></pre></div>
<pre><code>## [1] 0.400626</code></pre>
</div>
<div id="conclusion-6" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,two normal distribution have smaller bias,and
standard norm distribution have lower bias and variance than the other
normal distribution <span class="math inline">\(N(3,0.5^2)\)</span>(<strong>It is coincide with
our intuition,because the standard normal density is more likely to the
goal function</strong>).At the same time,<span class="math inline">\(f(x)=x^2\)</span> have smallest variance but it
has very large bias,which means that it is not a good function to
estimate our goal integral(<strong>although they have a same term <span class="math inline">\(x^2\)</span>,but the value of goal function have
larger difference with it</strong>).</p>
</div>
</div>
</div>
<div id="homework3" class="section level2">
<h2>Homework3</h2>
<div id="exercises-6.6" class="section level3">
<h3>Exercises 6.6</h3>
<div id="question-7" class="section level4">
<h4>Question</h4>
<p>Estimate the 0.025,0.05,0.95,and 0.975 quantiles of the skewness
<span class="math inline">\(\sqrt{b_1}\)</span> under normality by a
Monte Carlo experiment.Compute the standard error of the estimates from
(2.14) using the normal approximation for the density (with exact
variance formula).Compare the estimated quantiles with the quantiles of
the large sample approximation <span class="math inline">\(\sqrt{b_1}\approx N(0,6/n).\)</span></p>
</div>
<div id="answer-6" class="section level4">
<h4>Answer</h4>
<p>The variance of the q sample quantile is <span class="math display">\[
Var(\hat{x_q})=\frac{q(1-q)}{nf(x_q)^2}
\]</span></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb42-2"><a href="#cb42-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co">#Generate data</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>Generate_skewness <span class="ot">&lt;-</span> <span class="cf">function</span>(sample_size,mean,se){</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(sample_size,mean,se)</span>
<span id="cb43-4"><a href="#cb43-4" tabindex="-1"></a>  skewness_values <span class="ot">&lt;-</span> <span class="fu">skewness</span>(x)</span>
<span id="cb43-5"><a href="#cb43-5" tabindex="-1"></a>  <span class="fu">return</span>(skewness_values)</span>
<span id="cb43-6"><a href="#cb43-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co">#statistical inference </span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>Skewness_quantiles <span class="ot">&lt;-</span> <span class="cf">function</span>(skewness_values,quantile_value,mean,se){</span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>  quantiles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(skewness_values, <span class="at">probs =</span> quantile_value)</span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  variances <span class="ot">&lt;-</span> quantile_value <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>quantile_value)<span class="sc">/</span>(<span class="fu">length</span>(skewness_values)<span class="sc">*</span><span class="fu">dnorm</span>(quantiles,mean,se))</span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  SE <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(variances)</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(quantiles,SE))</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co">#result reporting</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>Skewness_Result <span class="ot">&lt;-</span> <span class="cf">function</span>(quantile.hat,quantile.se,quantile_values,sample_size){</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a>  <span class="co">#Generate large sample approximation of quantile</span></span>
<span id="cb45-4"><a href="#cb45-4" tabindex="-1"></a>  approx_quantiles <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(quantile_values, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="fu">sqrt</span>(<span class="dv">6</span><span class="sc">/</span>sample_size))</span>
<span id="cb45-5"><a href="#cb45-5" tabindex="-1"></a>  table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(quantile.hat, quantile.se, approx_quantiles), <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb45-6"><a href="#cb45-6" tabindex="-1"></a></span>
<span id="cb45-7"><a href="#cb45-7" tabindex="-1"></a><span class="co">#rename the matrix</span></span>
<span id="cb45-8"><a href="#cb45-8" tabindex="-1"></a><span class="fu">rownames</span>(table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;quantile(estimate)&quot;</span>, <span class="st">&quot;quantile(sd)&quot;</span>, <span class="st">&quot;quantile(theory)&quot;</span>)</span>
<span id="cb45-9"><a href="#cb45-9" tabindex="-1"></a><span class="fu">colnames</span>(table) <span class="ot">&lt;-</span> quantile_values</span>
<span id="cb45-10"><a href="#cb45-10" tabindex="-1"></a></span>
<span id="cb45-11"><a href="#cb45-11" tabindex="-1"></a><span class="co"># output the result</span></span>
<span id="cb45-12"><a href="#cb45-12" tabindex="-1"></a><span class="fu">print</span>(table)</span>
<span id="cb45-13"><a href="#cb45-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb46-2"><a href="#cb46-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb46-3"><a href="#cb46-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb46-4"><a href="#cb46-4" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb46-5"><a href="#cb46-5" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb46-6"><a href="#cb46-6" tabindex="-1"></a>quantile_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</span>
<span id="cb46-7"><a href="#cb46-7" tabindex="-1"></a>Skw <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb46-8"><a href="#cb46-8" tabindex="-1"></a>quantile.hat <span class="ot">&lt;-</span> quantile.se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(quantile_values))</span>
<span id="cb46-9"><a href="#cb46-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb46-10"><a href="#cb46-10" tabindex="-1"></a>  Skw[i] <span class="ot">&lt;-</span> <span class="fu">Generate_skewness</span>(<span class="at">sample_size=</span>n,<span class="at">mean=</span>mean,<span class="at">se=</span>se)</span>
<span id="cb46-11"><a href="#cb46-11" tabindex="-1"></a>}</span>
<span id="cb46-12"><a href="#cb46-12" tabindex="-1"></a></span>
<span id="cb46-13"><a href="#cb46-13" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(quantile_values)){</span>
<span id="cb46-14"><a href="#cb46-14" tabindex="-1"></a>  quantile.hat[j] <span class="ot">&lt;-</span> <span class="fu">Skewness_quantiles</span>(Skw,quantile_values[j],mean,se)[<span class="dv">1</span>]</span>
<span id="cb46-15"><a href="#cb46-15" tabindex="-1"></a>  quantile.se[j] <span class="ot">&lt;-</span> <span class="fu">Skewness_quantiles</span>(Skw,quantile_values[j],mean,se)[<span class="dv">2</span>] </span>
<span id="cb46-16"><a href="#cb46-16" tabindex="-1"></a>}</span>
<span id="cb46-17"><a href="#cb46-17" tabindex="-1"></a><span class="fu">Skewness_Result</span>(quantile.hat,quantile.se,quantile_values,n)</span></code></pre></div>
<pre><code>##                           0.025        0.05       0.95      0.975
## quantile(estimate) -0.153400461 -0.12632189 0.12512550 0.15007675
## quantile(sd)        0.002486407  0.00346437 0.00346411 0.00248578
## quantile(theory)   -0.151818157 -0.12740981 0.12740981 0.15181816</code></pre>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb48-3"><a href="#cb48-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb48-4"><a href="#cb48-4" tabindex="-1"></a>mean <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb48-5"><a href="#cb48-5" tabindex="-1"></a>se <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb48-6"><a href="#cb48-6" tabindex="-1"></a>quantile_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>,<span class="fl">0.05</span>,<span class="fl">0.95</span>,<span class="fl">0.975</span>)</span>
<span id="cb48-7"><a href="#cb48-7" tabindex="-1"></a>Skw <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb48-8"><a href="#cb48-8" tabindex="-1"></a>quantile.hat <span class="ot">&lt;-</span> quantile.se <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(quantile_values))</span>
<span id="cb48-9"><a href="#cb48-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb48-10"><a href="#cb48-10" tabindex="-1"></a>  Skw[i] <span class="ot">&lt;-</span> <span class="fu">Generate_skewness</span>(<span class="at">sample_size=</span>n,<span class="at">mean=</span>mean,<span class="at">se=</span>se)</span>
<span id="cb48-11"><a href="#cb48-11" tabindex="-1"></a>}</span>
<span id="cb48-12"><a href="#cb48-12" tabindex="-1"></a></span>
<span id="cb48-13"><a href="#cb48-13" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(quantile_values)){</span>
<span id="cb48-14"><a href="#cb48-14" tabindex="-1"></a>  quantile.hat[j] <span class="ot">&lt;-</span> <span class="fu">Skewness_quantiles</span>(Skw,quantile_values[j],mean,se)[<span class="dv">1</span>]</span>
<span id="cb48-15"><a href="#cb48-15" tabindex="-1"></a>  quantile.se[j] <span class="ot">&lt;-</span> <span class="fu">Skewness_quantiles</span>(Skw,quantile_values[j],mean,se)[<span class="dv">2</span>] </span>
<span id="cb48-16"><a href="#cb48-16" tabindex="-1"></a>}</span>
<span id="cb48-17"><a href="#cb48-17" tabindex="-1"></a><span class="fu">Skewness_Result</span>(quantile.hat,quantile.se,quantile_values,n)</span></code></pre></div>
<pre><code>##                           0.025         0.05        0.95       0.975
## quantile(estimate) -0.971644469 -0.811599545 0.815198203 0.986373571
## quantile(sd)        0.003129831  0.004068259 0.004074217 0.003152478
## quantile(theory)   -1.518181574 -1.274098141 1.274098141 1.518181574</code></pre>
</div>
<div id="conclusion-7" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,we conclude that Estimate quantiles with Monte
Carlo method is nearly same with the large sample
approximation.However,if sample size <span class="math inline">\(n\)</span> is small,they will have some
differences.For example,if we set sample size is equal to 10,they have
significant differences between MC estimators and large sample
estimators because of large sample condition is failed.</p>
</div>
</div>
<div id="exercise-6.b" class="section level3">
<h3>Exercise 6.B</h3>
<div id="question-8" class="section level4">
<h4>Question</h4>
<p>Tests for association based on Pearson product moment correlation
<span class="math inline">\(\rho\)</span>, Spear- man’s rank correlation
coefficient <span class="math inline">\(\rho_s\)</span>, or Kendall’s
coefficient <span class="math inline">\(\tau\)</span> , are implemented
in cor.test. Show (empirically) that the nonparametric tests based on
<span class="math inline">\(\rho_s\)</span> or <span class="math inline">\(\tau\)</span> are less powerful than the
correlation test when the sampled distribution is bivariate normal. Find
an example of an alternative (a bivariate distribution <span class="math inline">\((X,Y)\)</span> such that <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are dependent) such that at least one
of the nonparametric tests have better empirical power than the
correlation test against this alternative.</p>
</div>
<div id="answer-7" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co">#Generate data</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>Generate_biogauss <span class="ot">&lt;-</span> <span class="cf">function</span>(sample_size,mu,sigma){</span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  data_normal <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(sample_size, mu, sigma)</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>  x_normal <span class="ot">&lt;-</span> data_normal[, <span class="dv">1</span>]</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>  y_normal <span class="ot">&lt;-</span> data_normal[, <span class="dv">2</span>]</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x_normal,<span class="at">y=</span>y_normal))</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>}</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" tabindex="-1"></a>Generate_alternative <span class="ot">&lt;-</span> <span class="cf">function</span>(sample_size){</span>
<span id="cb50-10"><a href="#cb50-10" tabindex="-1"></a>  x_dep <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(sample_size)</span>
<span id="cb50-11"><a href="#cb50-11" tabindex="-1"></a>  y_dep <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">abs</span>(x_dep)) <span class="sc">+</span> <span class="fu">rnorm</span>(sample_size, <span class="at">sd =</span> <span class="fl">0.1</span>)  <span class="co"># create dependent relationship</span></span>
<span id="cb50-12"><a href="#cb50-12" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x_dep,<span class="at">y=</span>y_dep))</span>
<span id="cb50-13"><a href="#cb50-13" tabindex="-1"></a>  }</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" tabindex="-1"></a><span class="co">#Statistical Inference</span></span>
<span id="cb51-2"><a href="#cb51-2" tabindex="-1"></a>Compare_Test <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y){</span>
<span id="cb51-3"><a href="#cb51-3" tabindex="-1"></a>  pearson_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y)</span>
<span id="cb51-4"><a href="#cb51-4" tabindex="-1"></a>  spearman_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb51-5"><a href="#cb51-5" tabindex="-1"></a>  kendall_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;kendall&quot;</span>)</span>
<span id="cb51-6"><a href="#cb51-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">p=</span>pearson_result,<span class="at">s=</span>spearman_result,<span class="at">k=</span>kendall_result))</span>
<span id="cb51-7"><a href="#cb51-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co">#result reporting</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>Correlation_Result <span class="ot">&lt;-</span><span class="cf">function</span>(normal,alternative){</span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>  normal_value <span class="ot">&lt;-</span> <span class="fu">c</span>(normal<span class="sc">$</span>p<span class="sc">$</span>p.value,normal<span class="sc">$</span>s<span class="sc">$</span>p.value,normal<span class="sc">$</span>k<span class="sc">$</span>p.value)</span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>  alternative_value <span class="ot">&lt;-</span> <span class="fu">c</span>(alternative<span class="sc">$</span>p<span class="sc">$</span>p.value,alternative<span class="sc">$</span>s<span class="sc">$</span>p.value,alternative<span class="sc">$</span>k<span class="sc">$</span>p.value)</span>
<span id="cb52-5"><a href="#cb52-5" tabindex="-1"></a>table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(normal_value,alternative_value),<span class="at">byrow =</span> T,<span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb52-6"><a href="#cb52-6" tabindex="-1"></a><span class="co">#rename the matrix</span></span>
<span id="cb52-7"><a href="#cb52-7" tabindex="-1"></a><span class="fu">rownames</span>(table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;normal condition&quot;</span>, <span class="st">&quot;other condition&quot;</span>)</span>
<span id="cb52-8"><a href="#cb52-8" tabindex="-1"></a><span class="fu">colnames</span>(table) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;pearson&#39;</span>,<span class="st">&#39;spearman&#39;</span>,<span class="st">&#39;kendall&#39;</span>)</span>
<span id="cb52-9"><a href="#cb52-9" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" tabindex="-1"></a><span class="co"># output the result</span></span>
<span id="cb52-11"><a href="#cb52-11" tabindex="-1"></a><span class="fu">print</span>(table)</span>
<span id="cb52-12"><a href="#cb52-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" tabindex="-1"></a><span class="co">#Experiment procedure</span></span>
<span id="cb53-2"><a href="#cb53-2" tabindex="-1"></a><span class="do">## parameter settings</span></span>
<span id="cb53-3"><a href="#cb53-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb53-4"><a href="#cb53-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb53-5"><a href="#cb53-5" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb53-6"><a href="#cb53-6" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="fl">0.8</span>,<span class="fl">0.8</span>,<span class="dv">1</span>),<span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb53-7"><a href="#cb53-7" tabindex="-1"></a>rnormal <span class="ot">&lt;-</span> <span class="fu">Generate_biogauss</span>(n,mu,sigma)</span>
<span id="cb53-8"><a href="#cb53-8" tabindex="-1"></a>ralternative <span class="ot">&lt;-</span> <span class="fu">Generate_alternative</span>(n)</span>
<span id="cb53-9"><a href="#cb53-9" tabindex="-1"></a>normal <span class="ot">&lt;-</span> <span class="fu">Compare_Test</span>(rnormal<span class="sc">$</span>x,rnormal<span class="sc">$</span>y)</span>
<span id="cb53-10"><a href="#cb53-10" tabindex="-1"></a>alternative <span class="ot">&lt;-</span> <span class="fu">Compare_Test</span>(ralternative<span class="sc">$</span>x,ralternative<span class="sc">$</span>y)</span>
<span id="cb53-11"><a href="#cb53-11" tabindex="-1"></a><span class="fu">Correlation_Result</span>(normal,alternative)</span></code></pre></div>
<pre><code>##                      pearson    spearman    kendall
## normal condition 0.003223048 0.008235571 0.01666612
## other condition  0.297035596 0.178219329 0.15574184</code></pre>
</div>
<div id="conclusion-8" class="section level4">
<h4>Conclusion</h4>
<p>From the results above, it can be seen that, in terms of power, the
correlation test has optimal power under normality. However, if the
normality assumption is not met, the other two tests exhibit better
power.</p>
</div>
</div>
<div id="powers-test" class="section level3">
<h3>Powers test</h3>
<div id="question-9" class="section level4">
<h4>Question</h4>
<ul>
<li><p>If we obtain the powers for two methods under a particular
simulation setting with 10,000 experiments: say, 0.651 for one method
and 0.676 for another method. We want to know if the powers are
different at 0.05 level.</p></li>
<li><p>What is the corresponding hypothesis test problem?</p></li>
<li><p>What test should we use? Z-test, two-sample t-test, paired-t test
or McNemar test? Why?</p></li>
<li><p>Please provide the least necessary information for hypothesis
testing</p></li>
</ul>
</div>
<div id="answer-8" class="section level4">
<h4>Answer</h4>
<p>To answer the question step by step:</p>
<div id="what-is-the-corresponding-hypothesis-test-problem" class="section level5">
<h5>1. <strong>What is the corresponding hypothesis test
problem?</strong></h5>
<ul>
<li><strong>Null hypothesis (<span class="math inline">\(H_0\)</span>))</strong>: The powers of the two
methods are not significantly different, i.e., <span class="math inline">\(( \text{Power}_1 = \text{Power}_2 )\)</span>.</li>
<li><strong>Alternative hypothesis (<span class="math inline">\(H_A\)</span>))</strong>: The powers of the two
methods are significantly different, i.e., <span class="math inline">\((
\text{Power}_1 \neq \text{Power}_2 )\)</span>.</li>
</ul>
<p>We want to test whether the power values (0.651 and 0.676) are
significantly different at the 0.05 significance level.</p>
</div>
<div id="what-test-should-we-use" class="section level5">
<h5>2. <strong>What test should we use?</strong></h5>
<ul>
<li><strong>McNemar’s test</strong> is used for paired binary data, such
as correct vs incorrect classifications, and is not applicable
here.</li>
<li><strong>Z-test</strong>: Since we are comparing two proportions
(power estimates) from large samples (10,000 experiments), a
<strong>two-proportion Z-test</strong> is appropriate. The power is
based on a large number of simulations, and a Z-test can compare two
proportions.</li>
<li><strong>Two-sample t-test</strong> is used for comparing means of
independent samples, but we are comparing proportions, not means.</li>
<li><strong>Paired t-test</strong> is used for dependent samples with
continuous data, which is not relevant here.</li>
</ul>
<p>Therefore, the <strong>Z-test</strong> is the most suitable method
because we are comparing two proportions derived from large independent
samples. The test will determine if the difference in powers is
statistically significant.</p>
</div>
<div id="what-is-the-least-necessary-information-for-hypothesis-testing" class="section level5">
<h5>3. <strong>What is the least necessary information for hypothesis
testing?</strong></h5>
<p>For the hypothesis test, we need: - The two power estimates: <span class="math inline">\(\hat{p}_1 = 0.651\)</span> and <span class="math inline">\(\hat{p}_2 = 0.676\)</span>. - The sample sizes for
both methods: <span class="math inline">\(n_1 = n_2 = 10,000\)</span>. -
The significance level: <span class="math inline">\(\alpha =
0.05\)</span>.</p>
</div>
<div id="steps-for-the-z-test" class="section level5">
<h5>4. <strong>Steps for the Z-test</strong></h5>
<p>For the two-proportion Z-test, the formula is: <span class="math display">\[
   Z = \frac{ \hat{p}_1 - \hat{p}_2 }{\sqrt{\hat{p}(1-\hat{p})
\left(\frac{1}{n_1} + \frac{1}{n_2}\right)}}
\]</span> Where <span class="math inline">\(\hat{p}\)</span> is the
pooled proportion, calculated as: <span class="math display">\[
   \hat{p} = \frac{\hat{p}_1 n_1 + \hat{p}_2 n_2}{n_1 + n_2}
\]</span></p>
<p>Once we compute the Z-value, you can compare it against the critical
value from the standard normal distribution or calculate the p-value. If
the p-value is less than 0.05, you reject the null hypothesis,
indicating a significant difference in power between the two
methods.</p>
</div>
</div>
</div>
</div>
<div id="homework4" class="section level2">
<h2>Homework4</h2>
<div id="comparation-of-bonferroni-correction-and-b-h-correction" class="section level3">
<h3>Comparation of Bonferroni correction and B-H correction</h3>
<div id="question-10" class="section level4">
<h4>Question</h4>
<p>Of <span class="math inline">\(N = 1000\)</span> hypotheses, 950 are
null and 50 are alternative. The p-value under any null hypothesis is
uniformly distributed (use runif), and the p-value under any alternative
hypothesis follows the beta distribution with parameter 0.1 and 1 (use
rbeta). Obtain Bonferroni adjusted p-values and B-H adjusted p-values.
Calculate FWER, FDR, and TPR under nominal level <span class="math inline">\(\alpha=0.1\)</span> for each of the two adjustment
methods based on <span class="math inline">\(m = 10000\)</span>
simulation replicates. You should output the 6 numbers (3) to a 3 × 2
table (column names: Bonferroni correction, B-H correction; row names:
FWER, FDR, TPR). Comment the results.</p>
</div>
<div id="answer-9" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co">#data generation</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>data_generation1 <span class="ot">&lt;-</span> <span class="cf">function</span>(N0,N1){</span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  p_null <span class="ot">&lt;-</span> <span class="fu">runif</span>(N0)                            <span class="co"># Null hypotheses</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  p_alt <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(N1, <span class="fl">0.1</span>, <span class="dv">1</span>)                     <span class="co"># Alternative hypotheses</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">c</span>(p_null, p_alt)</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a>  <span class="fu">return</span>(p_values)</span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># Statistical Inference</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>statistical_inference1 <span class="ot">&lt;-</span> <span class="cf">function</span>(p_values,alpha,N0,N1){</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a>  <span class="co"># Bonferroni correction</span></span>
<span id="cb56-4"><a href="#cb56-4" tabindex="-1"></a>  bonf_rejected <span class="ot">&lt;-</span> (<span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>) <span class="sc">&lt;</span> alpha)</span>
<span id="cb56-5"><a href="#cb56-5" tabindex="-1"></a>  <span class="co"># Benjamini-Hochberg correction</span></span>
<span id="cb56-6"><a href="#cb56-6" tabindex="-1"></a>  bh_rejected <span class="ot">&lt;-</span> (<span class="fu">p.adjust</span>(p_values, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>) <span class="sc">&lt;</span> alpha)</span>
<span id="cb56-7"><a href="#cb56-7" tabindex="-1"></a>  </span>
<span id="cb56-8"><a href="#cb56-8" tabindex="-1"></a>  <span class="co"># Functions to calculate FWER, FDR, TPR</span></span>
<span id="cb56-9"><a href="#cb56-9" tabindex="-1"></a>calc_metrics <span class="ot">&lt;-</span> <span class="cf">function</span>(rejected, true_alt) {</span>
<span id="cb56-10"><a href="#cb56-10" tabindex="-1"></a>  FWER <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">sum</span>(rejected[<span class="dv">1</span><span class="sc">:</span>N0])<span class="sc">&gt;</span><span class="dv">0</span>)   <span class="co"># FWER: At least one false rejection</span></span>
<span id="cb56-11"><a href="#cb56-11" tabindex="-1"></a>  FDR <span class="ot">&lt;-</span> <span class="fu">sum</span>(rejected[<span class="dv">1</span><span class="sc">:</span>N0]) <span class="sc">/</span> <span class="fu">max</span>(<span class="dv">1</span>, <span class="fu">sum</span>(rejected))</span>
<span id="cb56-12"><a href="#cb56-12" tabindex="-1"></a>  TPR <span class="ot">&lt;-</span> <span class="fu">sum</span>(rejected[(N0 <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(N0<span class="sc">+</span>N1)]) <span class="sc">/</span> N1</span>
<span id="cb56-13"><a href="#cb56-13" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">c</span>(<span class="at">FWER =</span> FWER, <span class="at">FDR =</span> FDR, <span class="at">TPR =</span> TPR))</span>
<span id="cb56-14"><a href="#cb56-14" tabindex="-1"></a>}</span>
<span id="cb56-15"><a href="#cb56-15" tabindex="-1"></a>  </span>
<span id="cb56-16"><a href="#cb56-16" tabindex="-1"></a>  <span class="co"># Update metrics for Bonferroni correction</span></span>
<span id="cb56-17"><a href="#cb56-17" tabindex="-1"></a>  bonf_metrics <span class="ot">&lt;-</span> <span class="fu">calc_metrics</span>(bonf_rejected, <span class="at">true_alt =</span> p_values[(N0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(N0<span class="sc">+</span>N1)])</span>
<span id="cb56-18"><a href="#cb56-18" tabindex="-1"></a>  </span>
<span id="cb56-19"><a href="#cb56-19" tabindex="-1"></a>  </span>
<span id="cb56-20"><a href="#cb56-20" tabindex="-1"></a>  <span class="co"># Update metrics for B-H correction</span></span>
<span id="cb56-21"><a href="#cb56-21" tabindex="-1"></a>  bh_metrics <span class="ot">&lt;-</span> <span class="fu">calc_metrics</span>(bh_rejected, <span class="at">true_alt =</span> p_values[(N0<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(N0<span class="sc">+</span>N1)])</span>
<span id="cb56-22"><a href="#cb56-22" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">bonf_metrics=</span>bonf_metrics,<span class="at">bh_metrics=</span>bh_metrics))</span>
<span id="cb56-23"><a href="#cb56-23" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" tabindex="-1"></a><span class="co">#Result Reporting</span></span>
<span id="cb57-2"><a href="#cb57-2" tabindex="-1"></a>result_reporting1 <span class="ot">&lt;-</span> <span class="cf">function</span>(results,bonf_metrics,bh_metrics,m){</span>
<span id="cb57-3"><a href="#cb57-3" tabindex="-1"></a>  </span>
<span id="cb57-4"><a href="#cb57-4" tabindex="-1"></a><span class="co"># Store averages of metrics</span></span>
<span id="cb57-5"><a href="#cb57-5" tabindex="-1"></a>  results[,<span class="dv">1</span> ] <span class="ot">&lt;-</span> results[,<span class="dv">1</span> ] <span class="sc">+</span> bonf_metrics<span class="sc">/</span>m </span>
<span id="cb57-6"><a href="#cb57-6" tabindex="-1"></a>  results[,<span class="dv">2</span> ] <span class="ot">&lt;-</span> results[,<span class="dv">2</span>] <span class="sc">+</span> bh_metrics <span class="sc">/</span>m</span>
<span id="cb57-7"><a href="#cb57-7" tabindex="-1"></a>  <span class="fu">return</span>(results)</span>
<span id="cb57-8"><a href="#cb57-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb58-2"><a href="#cb58-2" tabindex="-1"></a></span>
<span id="cb58-3"><a href="#cb58-3" tabindex="-1"></a><span class="co"># Simulation parameters</span></span>
<span id="cb58-4"><a href="#cb58-4" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">1000</span>      <span class="co"># Total number of hypotheses</span></span>
<span id="cb58-5"><a href="#cb58-5" tabindex="-1"></a>N0 <span class="ot">&lt;-</span> <span class="dv">950</span>        <span class="co"># Number of null hypotheses</span></span>
<span id="cb58-6"><a href="#cb58-6" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> N <span class="sc">-</span> N0     <span class="co"># Number of alternative hypotheses</span></span>
<span id="cb58-7"><a href="#cb58-7" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">10000</span>       <span class="co"># Number of simulation replicates</span></span>
<span id="cb58-8"><a href="#cb58-8" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span>     <span class="co"># Nominal significance level</span></span>
<span id="cb58-9"><a href="#cb58-9" tabindex="-1"></a><span class="co"># Storing results</span></span>
<span id="cb58-10"><a href="#cb58-10" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb58-11"><a href="#cb58-11" tabindex="-1"></a>  <span class="fu">colnames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni correction&quot;</span>, <span class="st">&quot;B-H correction&quot;</span>)</span>
<span id="cb58-12"><a href="#cb58-12" tabindex="-1"></a>  <span class="fu">rownames</span>(results) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;FWER&quot;</span>, <span class="st">&quot;FDR&quot;</span>, <span class="st">&quot;TPR&quot;</span>)</span>
<span id="cb58-13"><a href="#cb58-13" tabindex="-1"></a></span>
<span id="cb58-14"><a href="#cb58-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb58-15"><a href="#cb58-15" tabindex="-1"></a>  p_values <span class="ot">&lt;-</span> <span class="fu">data_generation1</span>(N0,N1)</span>
<span id="cb58-16"><a href="#cb58-16" tabindex="-1"></a>  </span>
<span id="cb58-17"><a href="#cb58-17" tabindex="-1"></a>  bonf_metrics <span class="ot">&lt;-</span> <span class="fu">statistical_inference1</span>(p_values,alpha,N0,N1)<span class="sc">$</span>bonf_metrics</span>
<span id="cb58-18"><a href="#cb58-18" tabindex="-1"></a>  bh_metrics <span class="ot">&lt;-</span> <span class="fu">statistical_inference1</span>(p_values,alpha,N0,N1)<span class="sc">$</span>bh_metrics</span>
<span id="cb58-19"><a href="#cb58-19" tabindex="-1"></a>  </span>
<span id="cb58-20"><a href="#cb58-20" tabindex="-1"></a>  results <span class="ot">&lt;-</span> <span class="fu">result_reporting1</span>(results,bonf_metrics,bh_metrics,m)</span>
<span id="cb58-21"><a href="#cb58-21" tabindex="-1"></a>  </span>
<span id="cb58-22"><a href="#cb58-22" tabindex="-1"></a>}</span>
<span id="cb58-23"><a href="#cb58-23" tabindex="-1"></a></span>
<span id="cb58-24"><a href="#cb58-24" tabindex="-1"></a><span class="fu">print</span>(results)</span></code></pre></div>
<pre><code>##      Bonferroni correction B-H correction
## FWER           0.087300000     0.93050000
## FDR            0.004510088     0.09502215
## TPR            0.396736000     0.56106200</code></pre>
</div>
<div id="conclusion-9" class="section level4">
<h4>Conclusion</h4>
<p>From the table above,we can see:</p>
<ul>
<li><p>Bonferroni correction: Tends to be more conservative, aiming to
control FWER at the cost of TPR.</p></li>
<li><p>B-H correction: More powerful (higher TPR) but may allow a higher
FDR, as it targets the false discovery rate instead of FWER.</p></li>
</ul>
</div>
</div>
<div id="exericise-7.4" class="section level3">
<h3>Exericise 7.4</h3>
<div id="question-11" class="section level4">
<h4>Question</h4>
<p>Refer to the air-conditioning data set aircondit provided in the boot
package.The 12 observations are the times in hours between faliures of
air-conditioning equipment[63,Example 1.1]: <span class="math display">\[
3,5,7,18,43,85,91,98,100,130,230,487
\]</span> Assume that the times between failures follow an exponential
model <span class="math inline">\(Exp(\lambda)\)</span>.Obtain the MLE
of the hazard rate <span class="math inline">\(\lambda\)</span> and use
bootstrap to estimate the bias and standard error of the estimate.</p>
</div>
<div id="answer-10" class="section level4">
<h4>Answer</h4>
<p>As we all know,the MLE estimate of hazard rate <span class="math inline">\(\lambda\)</span> is: <span class="math display">\[\hat{\lambda}=1/\bar{x}\]</span> where <span class="math inline">\(\bar{x}\)</span> is the mean of the failure
times.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co">#loading package</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a><span class="fu">library</span>(boot)</span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" tabindex="-1"></a><span class="co">#data generation</span></span>
<span id="cb61-2"><a href="#cb61-2" tabindex="-1"></a>data_generation2 <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb61-3"><a href="#cb61-3" tabindex="-1"></a>  <span class="co"># Air-conditioning failure times data</span></span>
<span id="cb61-4"><a href="#cb61-4" tabindex="-1"></a>  failure_times <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">18</span>, <span class="dv">43</span>, <span class="dv">85</span>, <span class="dv">91</span>, <span class="dv">98</span>, <span class="dv">100</span>, <span class="dv">130</span>, <span class="dv">230</span>, <span class="dv">487</span>)</span>
<span id="cb61-5"><a href="#cb61-5" tabindex="-1"></a>  <span class="fu">return</span>(failure_times)</span>
<span id="cb61-6"><a href="#cb61-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a><span class="co">#statistical inference</span></span>
<span id="cb62-2"><a href="#cb62-2" tabindex="-1"></a>statistical_inference2 <span class="ot">&lt;-</span> <span class="cf">function</span>(data,Repetitions){</span>
<span id="cb62-3"><a href="#cb62-3" tabindex="-1"></a>  <span class="co"># Function to compute MLE of lambda for bootstrap samples</span></span>
<span id="cb62-4"><a href="#cb62-4" tabindex="-1"></a>  lambda_mle_fn <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb62-5"><a href="#cb62-5" tabindex="-1"></a>  resampled_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb62-6"><a href="#cb62-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(resampled_data))</span>
<span id="cb62-7"><a href="#cb62-7" tabindex="-1"></a>}</span>
<span id="cb62-8"><a href="#cb62-8" tabindex="-1"></a></span>
<span id="cb62-9"><a href="#cb62-9" tabindex="-1"></a>  <span class="co"># Perform bootstrap</span></span>
<span id="cb62-10"><a href="#cb62-10" tabindex="-1"></a>  bootstrap_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> data, <span class="at">statistic =</span> lambda_mle_fn, <span class="at">R =</span> Repetitions)</span>
<span id="cb62-11"><a href="#cb62-11" tabindex="-1"></a>  <span class="fu">return</span>(bootstrap_results)</span>
<span id="cb62-12"><a href="#cb62-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co">#result reporting</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a>result_reporting2 <span class="ot">&lt;-</span> <span class="cf">function</span>(lambda_mle,bootstrap_results){</span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>  <span class="co"># Extract bias and standard error</span></span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>  lambda_mle_bias <span class="ot">&lt;-</span> <span class="fu">mean</span>(bootstrap_results<span class="sc">$</span>t) <span class="sc">-</span> lambda_mle</span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>  lambda_mle_se <span class="ot">&lt;-</span> <span class="fu">sd</span>(bootstrap_results<span class="sc">$</span>t)</span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>  <span class="co"># Output the results</span></span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;MLE of lambda:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Bootstrap estimate of bias:&quot;</span>, lambda_mle_bias, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Bootstrap estimate of standard error:&quot;</span>, lambda_mle_se, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;Relative Error of Estimate:&#39;</span>,<span class="fu">abs</span>(lambda_mle_bias)<span class="sc">/</span>lambda_mle<span class="sc">*</span><span class="dv">100</span>,<span class="st">&#39;%&#39;</span>)</span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="co">#Experimental Settings</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a>Repetitions <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb64-4"><a href="#cb64-4" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">data_generation2</span>()</span>
<span id="cb64-5"><a href="#cb64-5" tabindex="-1"></a><span class="co"># MLE of lambda</span></span>
<span id="cb64-6"><a href="#cb64-6" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">mean</span>(data)</span>
<span id="cb64-7"><a href="#cb64-7" tabindex="-1"></a></span>
<span id="cb64-8"><a href="#cb64-8" tabindex="-1"></a>bootstrap_results <span class="ot">&lt;-</span> <span class="fu">statistical_inference2</span>(data,Repetitions)</span>
<span id="cb64-9"><a href="#cb64-9" tabindex="-1"></a><span class="fu">result_reporting2</span>(lambda_mle,bootstrap_results)</span></code></pre></div>
<pre><code>## MLE of lambda: 0.00925212 
## Bootstrap estimate of bias: 0.00151119 
## Bootstrap estimate of standard error: 0.004217765 
## Relative Error of Estimate: 16.33344 %</code></pre>
</div>
<div id="conclusion-10" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,we concluded that bootstrap method has
approximate 16.3% relative error rate,which is not low or high
enough.</p>
</div>
</div>
<div id="exericise-7.5" class="section level3">
<h3>Exericise 7.5</h3>
<div id="question-12" class="section level4">
<h4>Question</h4>
<p>Refer to Exercise 7.4.Compute 95% bootstrap confidence intervals for
the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard
normal,basic,percentile,and BCa methods.Compare the intervals and
explain why they may differ.</p>
</div>
<div id="answer-11" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a><span class="co">#statistical inference</span></span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a>statistical_inference3 <span class="ot">&lt;-</span> <span class="cf">function</span>(data,Repetitions,alpha){</span>
<span id="cb66-3"><a href="#cb66-3" tabindex="-1"></a>  <span class="co"># Function to compute MLE of 1/lambda for bootstrap samples</span></span>
<span id="cb66-4"><a href="#cb66-4" tabindex="-1"></a>  lambda_mle_fn2 <span class="ot">&lt;-</span> <span class="cf">function</span>(data, indices) {</span>
<span id="cb66-5"><a href="#cb66-5" tabindex="-1"></a>  resampled_data <span class="ot">&lt;-</span> data[indices]</span>
<span id="cb66-6"><a href="#cb66-6" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">mean</span>(resampled_data))</span>
<span id="cb66-7"><a href="#cb66-7" tabindex="-1"></a>}</span>
<span id="cb66-8"><a href="#cb66-8" tabindex="-1"></a></span>
<span id="cb66-9"><a href="#cb66-9" tabindex="-1"></a>  <span class="co"># Perform bootstrap</span></span>
<span id="cb66-10"><a href="#cb66-10" tabindex="-1"></a>  bootstrap_results <span class="ot">&lt;-</span> <span class="fu">boot</span>(<span class="at">data =</span> data, <span class="at">statistic =</span> lambda_mle_fn2, <span class="at">R =</span> Repetitions)</span>
<span id="cb66-11"><a href="#cb66-11" tabindex="-1"></a>  ci <span class="ot">&lt;-</span> <span class="fu">boot.ci</span>(bootstrap_results,<span class="at">type=</span><span class="fu">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>),<span class="at">conf =</span> alpha)</span>
<span id="cb66-12"><a href="#cb66-12" tabindex="-1"></a>  <span class="fu">return</span>(ci)</span>
<span id="cb66-13"><a href="#cb66-13" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="co">#result reporting</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>result_reporting3 <span class="ot">&lt;-</span> <span class="cf">function</span>(lambdad_mle,norm_ci,basic_ci,perc_ci,BCa_ci){</span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>  <span class="co"># Output results</span></span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>  mu <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> lambda_mle</span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Mean time between failures:&quot;</span>, mu, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Normal CI:(&quot;</span>,norm_ci[<span class="dv">1</span>],<span class="st">&#39;,&#39;</span>,norm_ci[<span class="dv">2</span>],<span class="st">&#39;)&#39;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Basic CI:(&quot;</span>,basic_ci[<span class="dv">1</span>],<span class="st">&#39;,&#39;</span>,basic_ci[<span class="dv">2</span>],<span class="st">&#39;)&#39;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Percentile CI:(&quot;</span>,perc_ci[<span class="dv">1</span>],<span class="st">&#39;,&#39;</span>,perc_ci[<span class="dv">2</span>],<span class="st">&#39;)&#39;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;BCa CI:(&quot;</span>,BCa_ci[<span class="dv">1</span>],<span class="st">&#39;,&#39;</span>,BCa_ci[<span class="dv">2</span>],<span class="st">&#39;)&#39;</span>, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a></span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a><span class="co">#Experimental Settings</span></span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.95</span></span>
<span id="cb68-3"><a href="#cb68-3" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb68-4"><a href="#cb68-4" tabindex="-1"></a>Repetitions <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb68-5"><a href="#cb68-5" tabindex="-1"></a></span>
<span id="cb68-6"><a href="#cb68-6" tabindex="-1"></a>ci.norm<span class="ot">&lt;-</span>ci.basic<span class="ot">&lt;-</span>ci.perc<span class="ot">&lt;-</span>ci.bca<span class="ot">&lt;-</span><span class="fu">matrix</span>(<span class="cn">NA</span>,m,<span class="dv">2</span>)</span>
<span id="cb68-7"><a href="#cb68-7" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m){</span>
<span id="cb68-8"><a href="#cb68-8" tabindex="-1"></a>ci <span class="ot">&lt;-</span> <span class="fu">statistical_inference3</span>(data,Repetitions,alpha)</span>
<span id="cb68-9"><a href="#cb68-9" tabindex="-1"></a>ci.norm[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>norm[<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>];ci.basic[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>basic[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb68-10"><a href="#cb68-10" tabindex="-1"></a>ci.perc[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>percent[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>];ci.bca[i,]<span class="ot">&lt;-</span>ci<span class="sc">$</span>bca[<span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb68-11"><a href="#cb68-11" tabindex="-1"></a>}</span>
<span id="cb68-12"><a href="#cb68-12" tabindex="-1"></a></span>
<span id="cb68-13"><a href="#cb68-13" tabindex="-1"></a>norm_ci <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.norm[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.norm[,<span class="dv">2</span>]))</span>
<span id="cb68-14"><a href="#cb68-14" tabindex="-1"></a>basic_ci <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.basic[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.basic[,<span class="dv">2</span>]))</span>
<span id="cb68-15"><a href="#cb68-15" tabindex="-1"></a>perc_ci <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.perc[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.perc[,<span class="dv">2</span>]))</span>
<span id="cb68-16"><a href="#cb68-16" tabindex="-1"></a>BCa_ci <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(ci.bca[,<span class="dv">1</span>]),<span class="fu">mean</span>(ci.bca[,<span class="dv">2</span>]))</span>
<span id="cb68-17"><a href="#cb68-17" tabindex="-1"></a></span>
<span id="cb68-18"><a href="#cb68-18" tabindex="-1"></a><span class="fu">result_reporting3</span>(lambda_mle,norm_ci,basic_ci,perc_ci,BCa_ci)</span></code></pre></div>
<pre><code>## Mean time between failures: 108.0833 
## Normal CI:( 34.35325 , 181.8475 ) 
## Basic CI:( 24.69839 , 169.4745 ) 
## Percentile CI:( 46.69213 , 191.4683 ) 
## BCa CI:( 56.97844 , 228.2832 )</code></pre>
</div>
<div id="conclusion-11" class="section level4">
<h4>Conclusion</h4>
<p>It can be seen that the average results from the 10,000 simulations
yield intervals that all include the mean time between failures, but
their ranges and lengths vary significantly.There are some explanations
and comparison below.</p>
<p>Explanation of the Methods:</p>
<pre><code>Normal Method: Uses the mean of the bootstrap estimates and the standard deviation to create a CI based on the normal distribution.

Basic Method: Computes the CI based on the distribution of the bootstrap estimates.

Percentile Method: Directly uses the quantiles of the bootstrap estimates to form the CI.

BCa (Bias-Corrected and Accelerated) Method: Adjusts for both bias and skewness in the bootstrap distribution, providing a more accurate CI.</code></pre>
<p>Comparison of Intervals:</p>
<pre><code>Width and Location: The width and central location of the intervals may differ due to the methods used. The normal method assumes symmetry, while the percentile and BCa methods directly reflect the empirical distribution of the estimates.

Bias Adjustment: The BCa method often provides narrower intervals, accounting for bias, which might make it preferable in some cases.

Robustness: Percentile and BCa methods tend to perform better with small sample sizes and non-normal distributions, while the normal method may be less reliable if the distribution of estimates is skewed.</code></pre>
</div>
</div>
</div>
<div id="homework5" class="section level2">
<h2>Homework5</h2>
<div id="exercises-7.8" class="section level3">
<h3>Exercises 7.8</h3>
<div id="question-13" class="section level4">
<h4>Question</h4>
<p>Refer to Exercise 7.7. Obtain the jackknife estimates of bias and
standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-12" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a><span class="fu">library</span>(DAAG)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a><span class="co">#generating data</span></span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a>scor_generate <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb75-3"><a href="#cb75-3" tabindex="-1"></a>  <span class="fu">data</span>(scor)</span>
<span id="cb75-4"><a href="#cb75-4" tabindex="-1"></a>  <span class="fu">return</span>(scor)</span>
<span id="cb75-5"><a href="#cb75-5" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="co">#statistical inference</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>jackknife_infer <span class="ot">&lt;-</span> <span class="cf">function</span>(data){</span>
<span id="cb76-3"><a href="#cb76-3" tabindex="-1"></a>  <span class="co"># Jackknife 方法</span></span>
<span id="cb76-4"><a href="#cb76-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb76-5"><a href="#cb76-5" tabindex="-1"></a>  theta_jackknife <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb76-6"><a href="#cb76-6" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n) {</span>
<span id="cb76-8"><a href="#cb76-8" tabindex="-1"></a>    <span class="co"># 排除第 i 个观测</span></span>
<span id="cb76-9"><a href="#cb76-9" tabindex="-1"></a>    data_excluded <span class="ot">&lt;-</span> data[<span class="sc">-</span>i, ]</span>
<span id="cb76-10"><a href="#cb76-10" tabindex="-1"></a>    Sigma_hat_i <span class="ot">&lt;-</span> <span class="fu">cov</span>(data_excluded)</span>
<span id="cb76-11"><a href="#cb76-11" tabindex="-1"></a>    eigenvalues_i <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma_hat_i)<span class="sc">$</span>values</span>
<span id="cb76-12"><a href="#cb76-12" tabindex="-1"></a>    lambda_hat_i <span class="ot">&lt;-</span> <span class="fu">sort</span>(eigenvalues_i, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb76-13"><a href="#cb76-13" tabindex="-1"></a>  </span>
<span id="cb76-14"><a href="#cb76-14" tabindex="-1"></a>    <span class="co"># 计算每次排除的theta</span></span>
<span id="cb76-15"><a href="#cb76-15" tabindex="-1"></a>    theta_jackknife[i] <span class="ot">&lt;-</span> lambda_hat_i[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda_hat_i)</span>
<span id="cb76-16"><a href="#cb76-16" tabindex="-1"></a>  }</span>
<span id="cb76-17"><a href="#cb76-17" tabindex="-1"></a></span>
<span id="cb76-18"><a href="#cb76-18" tabindex="-1"></a>  <span class="fu">return</span>(theta_jackknife)</span>
<span id="cb76-19"><a href="#cb76-19" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="co">#result reporting</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a>jackknife_report <span class="ot">&lt;-</span> <span class="cf">function</span>(data,theta_jackknife){</span>
<span id="cb77-3"><a href="#cb77-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(data)</span>
<span id="cb77-4"><a href="#cb77-4" tabindex="-1"></a>  <span class="co"># 计算协方差矩阵的MLE</span></span>
<span id="cb77-5"><a href="#cb77-5" tabindex="-1"></a>  Sigma_hat <span class="ot">&lt;-</span> <span class="fu">cov</span>(data)</span>
<span id="cb77-6"><a href="#cb77-6" tabindex="-1"></a></span>
<span id="cb77-7"><a href="#cb77-7" tabindex="-1"></a>  <span class="co"># 计算协方差矩阵的特征值</span></span>
<span id="cb77-8"><a href="#cb77-8" tabindex="-1"></a>  eigenvalues <span class="ot">&lt;-</span> <span class="fu">eigen</span>(Sigma_hat)<span class="sc">$</span>values</span>
<span id="cb77-9"><a href="#cb77-9" tabindex="-1"></a>  lambda_hat <span class="ot">&lt;-</span> <span class="fu">sort</span>(eigenvalues, <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span>
<span id="cb77-10"><a href="#cb77-10" tabindex="-1"></a></span>
<span id="cb77-11"><a href="#cb77-11" tabindex="-1"></a>  <span class="co"># 计算样本估计的theta</span></span>
<span id="cb77-12"><a href="#cb77-12" tabindex="-1"></a>  hat_theta <span class="ot">&lt;-</span> lambda_hat[<span class="dv">1</span>] <span class="sc">/</span> <span class="fu">sum</span>(lambda_hat)</span>
<span id="cb77-13"><a href="#cb77-13" tabindex="-1"></a>  <span class="co"># 计算 Jackknife 偏差和标准误</span></span>
<span id="cb77-14"><a href="#cb77-14" tabindex="-1"></a>  bias_theta <span class="ot">&lt;-</span> (n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="fu">mean</span>(theta_jackknife) <span class="sc">-</span> hat_theta)</span>
<span id="cb77-15"><a href="#cb77-15" tabindex="-1"></a>  se_theta <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> n <span class="sc">*</span> <span class="fu">sum</span>((theta_jackknife <span class="sc">-</span> <span class="fu">mean</span>(theta_jackknife))<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb77-16"><a href="#cb77-16" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;the jackknife estimates of theta is&#39;</span>,(n<span class="dv">-1</span>) <span class="sc">*</span> <span class="fu">mean</span>(theta_jackknife),<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb77-17"><a href="#cb77-17" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;the jackknife estimates of bias is&#39;</span>,bias_theta,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb77-18"><a href="#cb77-18" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;the jackknife estimates of standard error is&#39;</span>,se_theta,<span class="st">&#39;</span><span class="sc">\n</span><span class="st">&#39;</span>)</span>
<span id="cb77-19"><a href="#cb77-19" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">scor_generate</span>()</span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a>theta_jackknife <span class="ot">&lt;-</span> <span class="fu">jackknife_infer</span>(data)</span>
<span id="cb78-3"><a href="#cb78-3" tabindex="-1"></a><span class="fu">jackknife_report</span>(data,theta_jackknife)</span></code></pre></div>
<pre><code>## the jackknife estimates of theta is 53.86408 
## the jackknife estimates of bias is 0.001069139 
## the jackknife estimates of standard error is 0.04955231</code></pre>
</div>
<div id="conclusion-12" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,we will conclude that the estimate bias of
jackknife is very small.At the same time,standard error is small enough
too.</p>
</div>
</div>
<div id="exercise-7.10" class="section level3">
<h3>Exercise 7.10</h3>
<div id="question-14" class="section level4">
<h4>Question</h4>
<p>In Example 7.18, leave-one-out (n-fold) cross validation was used to
select the best fitting model. Repeat the analysis replacing the Log-Log
model with a cubic polynomial model. Which of the four models is
selected by the cross validation procedure? Which model is selected
according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
</div>
<div id="answer-13" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="co">#data generating</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>ironslag_generate <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a>  <span class="fu">attach</span>(ironslag)</span>
<span id="cb80-4"><a href="#cb80-4" tabindex="-1"></a> </span>
<span id="cb80-5"><a href="#cb80-5" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">chemical=</span>chemical,<span class="at">magnetic=</span>magnetic)</span>
<span id="cb80-6"><a href="#cb80-6" tabindex="-1"></a>  <span class="fu">detach</span>(ironslag)</span>
<span id="cb80-7"><a href="#cb80-7" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb80-8"><a href="#cb80-8" tabindex="-1"></a>}</span></code></pre></div>
<p>Cubic polynomial model is <span class="math display">\[Y =
\beta_0+\beta_1X+\beta_2X^2+\beta X^3+\epsilon\]</span></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" tabindex="-1"></a><span class="co">#Statistical inference</span></span>
<span id="cb81-2"><a href="#cb81-2" tabindex="-1"></a>Cross_Validation <span class="ot">&lt;-</span> <span class="cf">function</span>(chemical,magnetic){</span>
<span id="cb81-3"><a href="#cb81-3" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(magnetic)</span>
<span id="cb81-4"><a href="#cb81-4" tabindex="-1"></a>  e1 <span class="ot">&lt;-</span> e2 <span class="ot">&lt;-</span> e3 <span class="ot">&lt;-</span> e4 <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb81-5"><a href="#cb81-5" tabindex="-1"></a>  </span>
<span id="cb81-6"><a href="#cb81-6" tabindex="-1"></a>  <span class="co">#for n-fold cross validation</span></span>
<span id="cb81-7"><a href="#cb81-7" tabindex="-1"></a>  <span class="co">#fit models on leave-one-out samples</span></span>
<span id="cb81-8"><a href="#cb81-8" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n){</span>
<span id="cb81-9"><a href="#cb81-9" tabindex="-1"></a>    x <span class="ot">&lt;-</span> chemical[<span class="sc">-</span>k]</span>
<span id="cb81-10"><a href="#cb81-10" tabindex="-1"></a>    y <span class="ot">&lt;-</span> magnetic[<span class="sc">-</span>k]</span>
<span id="cb81-11"><a href="#cb81-11" tabindex="-1"></a>    </span>
<span id="cb81-12"><a href="#cb81-12" tabindex="-1"></a>    J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb81-13"><a href="#cb81-13" tabindex="-1"></a>    yhat1 <span class="ot">&lt;-</span> J1<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J1<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb81-14"><a href="#cb81-14" tabindex="-1"></a>    e1[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat1</span>
<span id="cb81-15"><a href="#cb81-15" tabindex="-1"></a>    </span>
<span id="cb81-16"><a href="#cb81-16" tabindex="-1"></a>    J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb81-17"><a href="#cb81-17" tabindex="-1"></a>    yhat2 <span class="ot">&lt;-</span> J2<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J2<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]<span class="sc">+</span>J2<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb81-18"><a href="#cb81-18" tabindex="-1"></a>    e2[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat2</span>
<span id="cb81-19"><a href="#cb81-19" tabindex="-1"></a>    </span>
<span id="cb81-20"><a href="#cb81-20" tabindex="-1"></a>    J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x )</span>
<span id="cb81-21"><a href="#cb81-21" tabindex="-1"></a>    logyhat3 <span class="ot">&lt;-</span> J3<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J3<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k]</span>
<span id="cb81-22"><a href="#cb81-22" tabindex="-1"></a>    yhat3 <span class="ot">&lt;-</span> <span class="fu">exp</span>(logyhat3)</span>
<span id="cb81-23"><a href="#cb81-23" tabindex="-1"></a>    e3[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat3</span>
<span id="cb81-24"><a href="#cb81-24" tabindex="-1"></a>    </span>
<span id="cb81-25"><a href="#cb81-25" tabindex="-1"></a>    J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>))</span>
<span id="cb81-26"><a href="#cb81-26" tabindex="-1"></a>    yhat4 <span class="ot">&lt;-</span> J4<span class="sc">$</span>coef[<span class="dv">1</span>] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">2</span>] <span class="sc">*</span> chemical[k] <span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">3</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span> J4<span class="sc">$</span>coef[<span class="dv">4</span>] <span class="sc">*</span> chemical[k]<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb81-27"><a href="#cb81-27" tabindex="-1"></a>    e4[k] <span class="ot">&lt;-</span> magnetic[k] <span class="sc">-</span> yhat4</span>
<span id="cb81-28"><a href="#cb81-28" tabindex="-1"></a>  }</span>
<span id="cb81-29"><a href="#cb81-29" tabindex="-1"></a>  mse <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">mean</span>(e1<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e2<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e3<span class="sc">^</span><span class="dv">2</span>),<span class="fu">mean</span>(e4<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb81-30"><a href="#cb81-30" tabindex="-1"></a>  x <span class="ot">&lt;-</span> chemical</span>
<span id="cb81-31"><a href="#cb81-31" tabindex="-1"></a>  y <span class="ot">&lt;-</span> magnetic</span>
<span id="cb81-32"><a href="#cb81-32" tabindex="-1"></a>  J1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb81-33"><a href="#cb81-33" tabindex="-1"></a>  J2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x <span class="sc">+</span> <span class="fu">I</span>(x<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb81-34"><a href="#cb81-34" tabindex="-1"></a>  J3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(<span class="fu">log</span>(y) <span class="sc">~</span> x )</span>
<span id="cb81-35"><a href="#cb81-35" tabindex="-1"></a>  J4 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">3</span>, <span class="at">raw =</span> <span class="cn">TRUE</span>))</span>
<span id="cb81-36"><a href="#cb81-36" tabindex="-1"></a>  model_result <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">mse =</span> mse,<span class="at">model1=</span>J1,<span class="at">model2=</span>J2,<span class="at">model3=</span>J3,<span class="at">model4=</span>J4) </span>
<span id="cb81-37"><a href="#cb81-37" tabindex="-1"></a>  <span class="fu">return</span>(model_result)</span>
<span id="cb81-38"><a href="#cb81-38" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a><span class="co">#Result Reporting</span></span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a>CV_result <span class="ot">&lt;-</span> <span class="cf">function</span>(model_result){</span>
<span id="cb82-3"><a href="#cb82-3" tabindex="-1"></a>  adj_r <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">summary</span>(model_result<span class="sc">$</span>model1)<span class="sc">$</span>adj.r.squared,<span class="fu">summary</span>(model_result<span class="sc">$</span>model2)<span class="sc">$</span>adj.r.squared,<span class="fu">summary</span>(model_result<span class="sc">$</span>model3)<span class="sc">$</span>adj.r.squared,<span class="fu">summary</span>(model_result<span class="sc">$</span>model4)<span class="sc">$</span>adj.r.squared)</span>
<span id="cb82-4"><a href="#cb82-4" tabindex="-1"></a> </span>
<span id="cb82-5"><a href="#cb82-5" tabindex="-1"></a>  pred_error <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(model_result<span class="sc">$</span>mse,adj_r),<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">ncol =</span> <span class="dv">4</span>,<span class="at">byrow =</span> T)</span>
<span id="cb82-6"><a href="#cb82-6" tabindex="-1"></a>  <span class="fu">colnames</span>(pred_error) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Linear&#39;</span>,<span class="st">&#39;Quadratic&#39;</span>,<span class="st">&#39;Exponential&#39;</span>,<span class="st">&#39;Cubic&#39;</span>)</span>
<span id="cb82-7"><a href="#cb82-7" tabindex="-1"></a>  <span class="fu">rownames</span>(pred_error) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;prediction error&#39;</span>,<span class="st">&#39;adj_Rsquare&#39;</span>)</span>
<span id="cb82-8"><a href="#cb82-8" tabindex="-1"></a>  <span class="fu">print</span>(pred_error)</span>
<span id="cb82-9"><a href="#cb82-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">ironslag_generate</span>()</span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>chemical <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(data<span class="sc">$</span>chemical)</span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>magnetic <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(data<span class="sc">$</span>magnetic)</span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>model_result <span class="ot">&lt;-</span> <span class="fu">Cross_Validation</span>(chemical,magnetic)</span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a><span class="fu">CV_result</span>(model_result)</span></code></pre></div>
<pre><code>##                      Linear  Quadratic Exponential      Cubic
## prediction error 19.5564444 17.8524751  18.4418785 18.1775605
## adj_Rsquare       0.5281545  0.5768151   0.5280556  0.5740396</code></pre>
</div>
<div id="conclusion-13" class="section level4">
<h4>Conclusion</h4>
<p>Quadratic model is selected by the cross validation procedure</p>
<p>Quadratic model is selected according to maximum adjusted <span class="math inline">\(R^2\)</span>?</p>
</div>
</div>
<div id="exercise-8.1" class="section level3">
<h3>Exercise 8.1</h3>
<div id="question-15" class="section level4">
<h4>Question</h4>
<p>Implement the two-sample Cram´er-von Mises test for equal
distributions as a permutation test. Apply the test to the data in
Examples 8.1 and 8.2.</p>
</div>
<div id="answer-14" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" tabindex="-1"></a><span class="co">#data generate</span></span>
<span id="cb85-2"><a href="#cb85-2" tabindex="-1"></a>chickwts_generate <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb85-3"><a href="#cb85-3" tabindex="-1"></a>  <span class="fu">attach</span>(chickwts)</span>
<span id="cb85-4"><a href="#cb85-4" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&#39;soybean&#39;</span>]))</span>
<span id="cb85-5"><a href="#cb85-5" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">as.vector</span>(weight[feed <span class="sc">==</span> <span class="st">&#39;linseed&#39;</span>]))</span>
<span id="cb85-6"><a href="#cb85-6" tabindex="-1"></a>  <span class="fu">detach</span>(chickwts)</span>
<span id="cb85-7"><a href="#cb85-7" tabindex="-1"></a>  data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">y=</span>y)</span>
<span id="cb85-8"><a href="#cb85-8" tabindex="-1"></a>  <span class="fu">return</span>(data)</span>
<span id="cb85-9"><a href="#cb85-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a><span class="co">#statistical inference</span></span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a><span class="co"># Cramér-von Mises test function</span></span>
<span id="cb86-3"><a href="#cb86-3" tabindex="-1"></a>cramer_von_mises <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb86-4"><a href="#cb86-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb86-5"><a href="#cb86-5" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">length</span>(y)</span>
<span id="cb86-6"><a href="#cb86-6" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb86-7"><a href="#cb86-7" tabindex="-1"></a>  </span>
<span id="cb86-8"><a href="#cb86-8" tabindex="-1"></a>  <span class="co"># Calculate empirical CDFs</span></span>
<span id="cb86-9"><a href="#cb86-9" tabindex="-1"></a>  ecdf_x <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(x)</span>
<span id="cb86-10"><a href="#cb86-10" tabindex="-1"></a>  ecdf_y <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(y)</span>
<span id="cb86-11"><a href="#cb86-11" tabindex="-1"></a>  </span>
<span id="cb86-12"><a href="#cb86-12" tabindex="-1"></a>  <span class="co"># Compute the Cramér-von Mises statistic</span></span>
<span id="cb86-13"><a href="#cb86-13" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">sum</span>((<span class="fu">ecdf_x</span>(combined) <span class="sc">-</span> <span class="fu">ecdf_y</span>(combined))<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">/</span> (n <span class="sc">*</span> m))</span>
<span id="cb86-14"><a href="#cb86-14" tabindex="-1"></a>  </span>
<span id="cb86-15"><a href="#cb86-15" tabindex="-1"></a>  <span class="fu">return</span>(W)</span>
<span id="cb86-16"><a href="#cb86-16" tabindex="-1"></a>}</span>
<span id="cb86-17"><a href="#cb86-17" tabindex="-1"></a></span>
<span id="cb86-18"><a href="#cb86-18" tabindex="-1"></a><span class="co"># Permutation test function</span></span>
<span id="cb86-19"><a href="#cb86-19" tabindex="-1"></a>permutation_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, n_permutations) {</span>
<span id="cb86-20"><a href="#cb86-20" tabindex="-1"></a>  observed_stat <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises</span>(x, y)</span>
<span id="cb86-21"><a href="#cb86-21" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">c</span>(x, y)</span>
<span id="cb86-22"><a href="#cb86-22" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb86-23"><a href="#cb86-23" tabindex="-1"></a>  </span>
<span id="cb86-24"><a href="#cb86-24" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb86-25"><a href="#cb86-25" tabindex="-1"></a>    permuted <span class="ot">&lt;-</span> <span class="fu">sample</span>(combined)</span>
<span id="cb86-26"><a href="#cb86-26" tabindex="-1"></a>    new_x <span class="ot">&lt;-</span> permuted[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(x)]</span>
<span id="cb86-27"><a href="#cb86-27" tabindex="-1"></a>    new_y <span class="ot">&lt;-</span> permuted[(<span class="fu">length</span>(x) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(permuted)]</span>
<span id="cb86-28"><a href="#cb86-28" tabindex="-1"></a>    permuted_stat <span class="ot">&lt;-</span> <span class="fu">cramer_von_mises</span>(new_x, new_y)</span>
<span id="cb86-29"><a href="#cb86-29" tabindex="-1"></a>    </span>
<span id="cb86-30"><a href="#cb86-30" tabindex="-1"></a>    <span class="cf">if</span> (permuted_stat <span class="sc">&gt;=</span> observed_stat) {</span>
<span id="cb86-31"><a href="#cb86-31" tabindex="-1"></a>      count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb86-32"><a href="#cb86-32" tabindex="-1"></a>    }</span>
<span id="cb86-33"><a href="#cb86-33" tabindex="-1"></a>  }</span>
<span id="cb86-34"><a href="#cb86-34" tabindex="-1"></a>  </span>
<span id="cb86-35"><a href="#cb86-35" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> count <span class="sc">/</span> n_permutations</span>
<span id="cb86-36"><a href="#cb86-36" tabindex="-1"></a>  <span class="fu">return</span>(p_value)</span>
<span id="cb86-37"><a href="#cb86-37" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co">#Result Reporting</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>permutation_result <span class="ot">&lt;-</span> <span class="cf">function</span>(p_value){</span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;P-value:&quot;</span>, p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">chickwts_generate</span>()<span class="sc">$</span>x</span>
<span id="cb88-4"><a href="#cb88-4" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">chickwts_generate</span>()<span class="sc">$</span>y</span>
<span id="cb88-5"><a href="#cb88-5" tabindex="-1"></a><span class="co"># 执行置换测试</span></span>
<span id="cb88-6"><a href="#cb88-6" tabindex="-1"></a>p_value <span class="ot">&lt;-</span> <span class="fu">permutation_test</span>(x, y, R)</span>
<span id="cb88-7"><a href="#cb88-7" tabindex="-1"></a><span class="fu">permutation_result</span>(p_value)</span></code></pre></div>
<pre><code>## P-value: 0.422</code></pre>
</div>
<div id="conclusion-14" class="section level4">
<h4>Conclusion</h4>
<p>From the result,the p-value from permutation test is 0.422,which is
near from the example 8.1 and 8.2.</p>
</div>
</div>
<div id="exercise-8.2" class="section level3">
<h3>Exercise 8.2</h3>
<div id="question-16" class="section level4">
<h4>Question</h4>
<p>Implement the bivariate Spearman rank correlation test for
independence [255] as a permutation test. The Spearman rank correlation
test statistic can be obtained from function cor with method =
“spearman”. Compare the achieved significance level of the permutation
test with the p-value reported by cor.test on the same samples.</p>
</div>
<div id="answer-15" class="section level4">
<h4>Answer</h4>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a><span class="co">#data generating</span></span>
<span id="cb90-2"><a href="#cb90-2" tabindex="-1"></a>random_generate <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb90-3"><a href="#cb90-3" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb90-4"><a href="#cb90-4" tabindex="-1"></a>  y <span class="ot">&lt;-</span> <span class="fu">sin</span>(x)</span>
<span id="cb90-5"><a href="#cb90-5" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x,<span class="at">y=</span>y))</span>
<span id="cb90-6"><a href="#cb90-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="do">##Statistical inference</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a><span class="co"># Spearman rank correlation permutation test function</span></span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>permutation_spearman_test <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, n_permutations) {</span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>  observed_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>  count <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>  </span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a>  combined <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(x, y)</span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a>  </span>
<span id="cb91-9"><a href="#cb91-9" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_permutations) {</span>
<span id="cb91-10"><a href="#cb91-10" tabindex="-1"></a>    <span class="co"># Permute the y-values</span></span>
<span id="cb91-11"><a href="#cb91-11" tabindex="-1"></a>    permuted_y <span class="ot">&lt;-</span> <span class="fu">sample</span>(y)</span>
<span id="cb91-12"><a href="#cb91-12" tabindex="-1"></a>    </span>
<span id="cb91-13"><a href="#cb91-13" tabindex="-1"></a>    <span class="co"># Calculate Spearman correlation on permuted data</span></span>
<span id="cb91-14"><a href="#cb91-14" tabindex="-1"></a>    permuted_cor <span class="ot">&lt;-</span> <span class="fu">cor</span>(x, permuted_y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb91-15"><a href="#cb91-15" tabindex="-1"></a>    </span>
<span id="cb91-16"><a href="#cb91-16" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(permuted_cor) <span class="sc">&gt;=</span> <span class="fu">abs</span>(observed_cor)) {</span>
<span id="cb91-17"><a href="#cb91-17" tabindex="-1"></a>      count <span class="ot">&lt;-</span> count <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb91-18"><a href="#cb91-18" tabindex="-1"></a>    }</span>
<span id="cb91-19"><a href="#cb91-19" tabindex="-1"></a>  }</span>
<span id="cb91-20"><a href="#cb91-20" tabindex="-1"></a>  </span>
<span id="cb91-21"><a href="#cb91-21" tabindex="-1"></a>  p_value <span class="ot">&lt;-</span> count <span class="sc">/</span> n_permutations</span>
<span id="cb91-22"><a href="#cb91-22" tabindex="-1"></a>  <span class="fu">return</span>(p_value)</span>
<span id="cb91-23"><a href="#cb91-23" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co">#Result Reporting</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>Spearman_reporting <span class="ot">&lt;-</span> <span class="cf">function</span>(x,y,permutation_p_value){</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a>  <span class="co"># 计算 Spearman 相关性和 p 值</span></span>
<span id="cb92-4"><a href="#cb92-4" tabindex="-1"></a>spearman_test_result <span class="ot">&lt;-</span> <span class="fu">cor.test</span>(x, y, <span class="at">method =</span> <span class="st">&quot;spearman&quot;</span>)</span>
<span id="cb92-5"><a href="#cb92-5" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb92-6"><a href="#cb92-6" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Spearman correlation coefficient:&quot;</span>, spearman_test_result<span class="sc">$</span>estimate, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb92-7"><a href="#cb92-7" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value from cor.test:&quot;</span>, spearman_test_result<span class="sc">$</span>p.value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb92-8"><a href="#cb92-8" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value from permutation test:&quot;</span>, permutation_p_value, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb92-9"><a href="#cb92-9" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb93-2"><a href="#cb93-2" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb93-3"><a href="#cb93-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb93-4"><a href="#cb93-4" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">random_generate</span>(n)<span class="sc">$</span>x</span>
<span id="cb93-5"><a href="#cb93-5" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">random_generate</span>(n)<span class="sc">$</span>y</span>
<span id="cb93-6"><a href="#cb93-6" tabindex="-1"></a></span>
<span id="cb93-7"><a href="#cb93-7" tabindex="-1"></a><span class="co"># 执行置换测试</span></span>
<span id="cb93-8"><a href="#cb93-8" tabindex="-1"></a>permutation_p_value <span class="ot">&lt;-</span> <span class="fu">permutation_spearman_test</span>(x, y,R)</span>
<span id="cb93-9"><a href="#cb93-9" tabindex="-1"></a><span class="fu">Spearman_reporting</span>(x,y,permutation_p_value)</span></code></pre></div>
<pre><code>## Spearman correlation coefficient: 0.03979542 
## P-value from cor.test: 0.3744264 
## P-value from permutation test: 0.368</code></pre>
</div>
<div id="conclusion-15" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,we find that the p-value generated by cor.test
is approximately near from permutation test.</p>
</div>
</div>
</div>
<div id="homework6" class="section level2">
<h2>Homework6</h2>
<div id="exercise-9.3" class="section level3">
<h3>Exercise 9.3</h3>
<div id="question-17" class="section level4">
<h4>Question</h4>
<p>Use the Metropolis-Hastings sampler to generate random variables from
a standard Cauchy distribution.Discard the first 1000 of the chain,and
compare the deciles of the generated observations with the deciles of
the standard Cauchy distribution(see qcauchy or qt with df=1).Recall
that a Cauchy(<span class="math inline">\(\theta,\eta\)</span>)
distribution has density function <span class="math display">\[
f(x)=\frac{1}{\theta\pi(1+[(x-\eta)/\theta]^2)},-\infty&lt;x&lt;\infty,\theta&gt;0
\]</span> The standard Cauchy has the Cauchy(<span class="math inline">\(\theta=1,\eta=0\)</span>)density.(Note that the
standard Cauchy density is equal to the Student t density with one
degree of freedom).</p>
</div>
<div id="answer-16" class="section level4">
<h4>Answer</h4>
<p>To generate random variables from a standard Cauchy distribution
using the Metropolis-Hastings sampler, we can follow these steps. Here’s
a complete implementation:</p>
<ul>
<li><p>Define the target distribution: The standard Cauchy
distribution.</p></li>
<li><p>Set up the proposal distribution: For simplicity, we can use a
normal distribution centered at the current value.</p></li>
<li><p>Implement the Metropolis-Hastings algorithm.</p></li>
<li><p>Discard the first 1000 samples.</p></li>
<li><p>Compare the deciles of the generated samples with the deciles of
the standard Cauchy distribution.</p></li>
</ul>
<p>Detail codes are shown below:</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co">#upload package</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="do">## data generating</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a><span class="co"># Metropolis-Hastings sampler function</span></span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a>metropolis_hastings <span class="ot">&lt;-</span> <span class="cf">function</span>(n, proposal_sd,X0) {</span>
<span id="cb96-4"><a href="#cb96-4" tabindex="-1"></a>  <span class="co"># Initialize the chain</span></span>
<span id="cb96-5"><a href="#cb96-5" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n)</span>
<span id="cb96-6"><a href="#cb96-6" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> X0  <span class="co"># Start from some given value</span></span>
<span id="cb96-7"><a href="#cb96-7" tabindex="-1"></a>  </span>
<span id="cb96-8"><a href="#cb96-8" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n) {</span>
<span id="cb96-9"><a href="#cb96-9" tabindex="-1"></a>    <span class="co"># Current value</span></span>
<span id="cb96-10"><a href="#cb96-10" tabindex="-1"></a>    current_x <span class="ot">&lt;-</span> x[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb96-11"><a href="#cb96-11" tabindex="-1"></a>    </span>
<span id="cb96-12"><a href="#cb96-12" tabindex="-1"></a>    <span class="co"># Propose a new value from a normal distribution</span></span>
<span id="cb96-13"><a href="#cb96-13" tabindex="-1"></a>    proposed_x <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> current_x, <span class="at">sd =</span> proposal_sd)</span>
<span id="cb96-14"><a href="#cb96-14" tabindex="-1"></a>    </span>
<span id="cb96-15"><a href="#cb96-15" tabindex="-1"></a>    <span class="co"># Calculate acceptance probability</span></span>
<span id="cb96-16"><a href="#cb96-16" tabindex="-1"></a>    acceptance_prob <span class="ot">&lt;-</span> <span class="fu">dcauchy</span>(proposed_x) <span class="sc">/</span> <span class="fu">dcauchy</span>(current_x)</span>
<span id="cb96-17"><a href="#cb96-17" tabindex="-1"></a>    </span>
<span id="cb96-18"><a href="#cb96-18" tabindex="-1"></a>    <span class="co"># Accept or reject the proposed value</span></span>
<span id="cb96-19"><a href="#cb96-19" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">runif</span>(<span class="dv">1</span>) <span class="sc">&lt;</span> acceptance_prob) {</span>
<span id="cb96-20"><a href="#cb96-20" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> proposed_x</span>
<span id="cb96-21"><a href="#cb96-21" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb96-22"><a href="#cb96-22" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> current_x</span>
<span id="cb96-23"><a href="#cb96-23" tabindex="-1"></a>    }</span>
<span id="cb96-24"><a href="#cb96-24" tabindex="-1"></a>  }</span>
<span id="cb96-25"><a href="#cb96-25" tabindex="-1"></a>  </span>
<span id="cb96-26"><a href="#cb96-26" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb96-27"><a href="#cb96-27" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" tabindex="-1"></a><span class="do">## statistical inference</span></span>
<span id="cb97-2"><a href="#cb97-2" tabindex="-1"></a>deciles_calculating <span class="ot">&lt;-</span> <span class="cf">function</span>(samples){</span>
<span id="cb97-3"><a href="#cb97-3" tabindex="-1"></a><span class="co"># Calculate deciles of the generated samples</span></span>
<span id="cb97-4"><a href="#cb97-4" tabindex="-1"></a>sample_deciles <span class="ot">&lt;-</span> <span class="fu">quantile</span>(samples, <span class="at">probs =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</span>
<span id="cb97-5"><a href="#cb97-5" tabindex="-1"></a></span>
<span id="cb97-6"><a href="#cb97-6" tabindex="-1"></a><span class="co"># Calculate deciles of the standard Cauchy distribution</span></span>
<span id="cb97-7"><a href="#cb97-7" tabindex="-1"></a>cauchy_deciles <span class="ot">&lt;-</span> <span class="fu">qcauchy</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>))</span>
<span id="cb97-8"><a href="#cb97-8" tabindex="-1"></a></span>
<span id="cb97-9"><a href="#cb97-9" tabindex="-1"></a><span class="co"># Create a comparison data frame</span></span>
<span id="cb97-10"><a href="#cb97-10" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb97-11"><a href="#cb97-11" tabindex="-1"></a>  <span class="at">Decile =</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>),</span>
<span id="cb97-12"><a href="#cb97-12" tabindex="-1"></a>  <span class="at">Sample_Deciles =</span> sample_deciles,</span>
<span id="cb97-13"><a href="#cb97-13" tabindex="-1"></a>  <span class="at">Cauchy_Deciles =</span> cauchy_deciles</span>
<span id="cb97-14"><a href="#cb97-14" tabindex="-1"></a>)</span>
<span id="cb97-15"><a href="#cb97-15" tabindex="-1"></a></span>
<span id="cb97-16"><a href="#cb97-16" tabindex="-1"></a><span class="co"># Print the comparison data frame</span></span>
<span id="cb97-17"><a href="#cb97-17" tabindex="-1"></a><span class="fu">return</span>(comparison)</span>
<span id="cb97-18"><a href="#cb97-18" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a><span class="do">## result reporting</span></span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a>Comparison_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(comparison){</span>
<span id="cb98-3"><a href="#cb98-3" tabindex="-1"></a><span class="co"># Plot the comparison</span></span>
<span id="cb98-4"><a href="#cb98-4" tabindex="-1"></a><span class="fu">ggplot</span>(comparison, <span class="fu">aes</span>(<span class="at">x =</span> Decile)) <span class="sc">+</span></span>
<span id="cb98-5"><a href="#cb98-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Sample_Deciles, <span class="at">color =</span> <span class="st">&quot;Sample Deciles&quot;</span>), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb98-6"><a href="#cb98-6" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> Cauchy_Deciles, <span class="at">color =</span> <span class="st">&quot;Cauchy Deciles&quot;</span>), <span class="at">linewidth =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb98-7"><a href="#cb98-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Deciles Comparison&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Value&quot;</span>, <span class="at">x =</span> <span class="st">&quot;Decile&quot;</span>) <span class="sc">+</span></span>
<span id="cb98-8"><a href="#cb98-8" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;Sample Deciles&quot;</span> <span class="ot">=</span> <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;Cauchy Deciles&quot;</span> <span class="ot">=</span> <span class="st">&quot;red&quot;</span>)) <span class="sc">+</span></span>
<span id="cb98-9"><a href="#cb98-9" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb98-10"><a href="#cb98-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>discard_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>X0 <span class="ot">=</span> <span class="sc">-</span><span class="dv">5</span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>proposal_sd <span class="ot">&lt;-</span> <span class="dv">1</span>  <span class="co"># Standard deviation of the proposal distribution</span></span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(n_samples, proposal_sd,X0)</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a><span class="co"># Discard the first 1000 samples</span></span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>samples <span class="ot">&lt;-</span> samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>discard_samples)]</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a></span>
<span id="cb99-10"><a href="#cb99-10" tabindex="-1"></a>comparison <span class="ot">&lt;-</span> <span class="fu">deciles_calculating</span>(samples)</span>
<span id="cb99-11"><a href="#cb99-11" tabindex="-1"></a></span>
<span id="cb99-12"><a href="#cb99-12" tabindex="-1"></a><span class="fu">Comparison_plot</span>(comparison)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion-16" class="section level4">
<h4>Conclusion</h4>
<p>From the plot above,the deciles of the generated observations with
the deciles of the standard Cauchy distribution is very similar.</p>
</div>
</div>
<div id="exercise-9.8" class="section level3">
<h3>Exercise 9.8</h3>
<div id="question-18" class="section level4">
<h4>Question</h4>
<p>This example appears in [40].Consider the bivariate density <span class="math display">\[
f(x, y) \propto\binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1,
\ldots, n, 0 \leq y \leq 1 .
\]</span> It can be shown that for fixed <span class="math inline">\(a,b,n\)</span>,the conditional distributions are
Binomial(<span class="math inline">\(n,y\)</span>) and Beta(<span class="math inline">\(x+a,n-x+b\)</span>).Use the Gibbs sampler to
generate a chain with target joint density <span class="math inline">\(f(x,y)\)</span>.</p>
</div>
<div id="answer-17" class="section level4">
<h4>Answer</h4>
<p>To implement a Gibbs sampler for the given bivariate density in R, we
need to follow these steps:</p>
<ul>
<li><p>Define the conditional distributions:</p>
<ul>
<li><p><span class="math inline">\(X|Y=y\)</span> follows a Binomial
distribution:<span class="math inline">\(X\sim
Binomial(n,y)\)</span></p></li>
<li><p><span class="math inline">\(Y|X=x\)</span> follows a Beta
distribution:<span class="math inline">\(Y\sim
Beta(x+a,n-x+b)\)</span></p></li>
</ul></li>
<li><p>Set up the Gibbs sampler: This will involve iterating between
drawing from the conditional distributions.</p></li>
<li><p>Generate samples and visualize the results.</p></li>
</ul>
<p>Here’s the R code to implement the Gibbs sampler:</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="co">#data generating</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a><span class="co"># Gibbs sampler function</span></span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a>gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(n_samples, n, a, b) {</span>
<span id="cb100-4"><a href="#cb100-4" tabindex="-1"></a>  <span class="co"># Initialize vectors to store samples</span></span>
<span id="cb100-5"><a href="#cb100-5" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb100-6"><a href="#cb100-6" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(n_samples)</span>
<span id="cb100-7"><a href="#cb100-7" tabindex="-1"></a></span>
<span id="cb100-8"><a href="#cb100-8" tabindex="-1"></a>  <span class="co"># Initial values</span></span>
<span id="cb100-9"><a href="#cb100-9" tabindex="-1"></a>  x_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb100-10"><a href="#cb100-10" tabindex="-1"></a>  y_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)  <span class="co"># Starting with a reasonable value for y</span></span>
<span id="cb100-11"><a href="#cb100-11" tabindex="-1"></a></span>
<span id="cb100-12"><a href="#cb100-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>n_samples) {</span>
<span id="cb100-13"><a href="#cb100-13" tabindex="-1"></a>    <span class="co"># Sample x given y</span></span>
<span id="cb100-14"><a href="#cb100-14" tabindex="-1"></a>    y_current <span class="ot">&lt;-</span> y_samples[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb100-15"><a href="#cb100-15" tabindex="-1"></a>    x_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y_current)</span>
<span id="cb100-16"><a href="#cb100-16" tabindex="-1"></a></span>
<span id="cb100-17"><a href="#cb100-17" tabindex="-1"></a>    <span class="co"># Sample y given x</span></span>
<span id="cb100-18"><a href="#cb100-18" tabindex="-1"></a>    x_current <span class="ot">&lt;-</span> x_samples[i]</span>
<span id="cb100-19"><a href="#cb100-19" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> x_current <span class="sc">+</span> a</span>
<span id="cb100-20"><a href="#cb100-20" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> n <span class="sc">-</span> x_current <span class="sc">+</span> b</span>
<span id="cb100-21"><a href="#cb100-21" tabindex="-1"></a>    y_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, alpha, beta)</span>
<span id="cb100-22"><a href="#cb100-22" tabindex="-1"></a>  }</span>
<span id="cb100-23"><a href="#cb100-23" tabindex="-1"></a></span>
<span id="cb100-24"><a href="#cb100-24" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">X =</span> x_samples, <span class="at">Y =</span> y_samples))</span>
<span id="cb100-25"><a href="#cb100-25" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" tabindex="-1"></a><span class="do">## statistical inference</span></span>
<span id="cb101-2"><a href="#cb101-2" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" tabindex="-1"></a><span class="co">#I think no statistical inference need for this problem</span></span></code></pre></div>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a><span class="do">## result reporting</span></span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a>gibbs_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(samples){</span>
<span id="cb102-3"><a href="#cb102-3" tabindex="-1"></a><span class="co"># Plot the results</span></span>
<span id="cb102-4"><a href="#cb102-4" tabindex="-1"></a><span class="fu">ggplot</span>(samples, <span class="fu">aes</span>(<span class="at">x =</span> X, <span class="at">y =</span> Y)) <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.2</span>) <span class="sc">+</span></span>
<span id="cb102-6"><a href="#cb102-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Gibbs Sampler: Bivariate Density&quot;</span>, <span class="at">x =</span> <span class="st">&quot;X&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Y&quot;</span>) <span class="sc">+</span></span>
<span id="cb102-7"><a href="#cb102-7" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb102-8"><a href="#cb102-8" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># Total trials</span></span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>   <span class="co"># Shape parameter for Beta distribution</span></span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span>   <span class="co"># Shape parameter for Beta distribution</span></span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">10000</span>  <span class="co"># Number of samples</span></span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>discard_samples <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a></span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" tabindex="-1"></a><span class="co"># Generate samples</span></span>
<span id="cb103-11"><a href="#cb103-11" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n_samples, n, a, b)</span>
<span id="cb103-12"><a href="#cb103-12" tabindex="-1"></a>samples <span class="ot">&lt;-</span> samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>discard_samples),]</span>
<span id="cb103-13"><a href="#cb103-13" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" tabindex="-1"></a><span class="fu">gibbs_plot</span>(samples)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion-17" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,we find that generated sample via Gibbs sampler
in stationary and satisfy correspondent maginal distribution.</p>
</div>
</div>
<div id="exercise-gelman-rubin-method" class="section level3">
<h3>Exercise Gelman-Rubin Method</h3>
<div id="question-19" class="section level4">
<h4>Question</h4>
<p>For each of the above exercise, use the Gelman-Rubin method to
monitor convergence of the chain, and run the chain until it converges
approximately to the target distribution according to <span class="math inline">\(\hat{R}&lt;1.2\)</span>.</p>
</div>
<div id="answer-18" class="section level4">
<h4>Answer</h4>
<p>To monitor the convergence of the Gibbs sampler using the
Gelman-Rubin method (also known as the potential scale reduction factor,
<span class="math inline">\(\hat{R}\)</span>),we’ll need to run multiple
chains in parallel and then compute <span class="math inline">\(\hat{R}\)</span> for each parameter of
interest.</p>
<p>Here’s how we can modify the Gibbs sampler implementation to include
the Gelman-Rubin convergence diagnostic:</p>
<ul>
<li><p>Run multiple chains: Initialize several chains with different
starting values.</p></li>
<li><p>Store samples: Keep track of the samples from each
chain.</p></li>
<li><p>Calculate <span class="math inline">\(\hat{R}\)</span>: After
each sampling iteration, calculate <span class="math inline">\(\hat{R}\)</span> to assess convergence.</p></li>
</ul>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="co">#data generating</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a><span class="co">#Metropolis-Hasting function with multiple chains</span></span>
<span id="cb104-4"><a href="#cb104-4" tabindex="-1"></a>metropolis_hastings_multiple_chains <span class="ot">&lt;-</span> <span class="cf">function</span>(n_chains,n_samples,proposal_sd,x0){</span>
<span id="cb104-5"><a href="#cb104-5" tabindex="-1"></a>  <span class="co"># Initialize a matrix to store samples for each chain</span></span>
<span id="cb104-6"><a href="#cb104-6" tabindex="-1"></a>  chains <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_samples, <span class="at">ncol =</span> n_chains)</span>
<span id="cb104-7"><a href="#cb104-7" tabindex="-1"></a>  <span class="co"># Run multiple chains</span></span>
<span id="cb104-8"><a href="#cb104-8" tabindex="-1"></a>  </span>
<span id="cb104-9"><a href="#cb104-9" tabindex="-1"></a>  <span class="cf">for</span>(chain <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_chains){</span>
<span id="cb104-10"><a href="#cb104-10" tabindex="-1"></a>    <span class="co"># Store samples in the chains matrix</span></span>
<span id="cb104-11"><a href="#cb104-11" tabindex="-1"></a>    chains[,chain] <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings</span>(n_samples,proposal_sd,x0[chain])</span>
<span id="cb104-12"><a href="#cb104-12" tabindex="-1"></a>  }</span>
<span id="cb104-13"><a href="#cb104-13" tabindex="-1"></a>  <span class="fu">return</span>(chains)</span>
<span id="cb104-14"><a href="#cb104-14" tabindex="-1"></a>}</span>
<span id="cb104-15"><a href="#cb104-15" tabindex="-1"></a></span>
<span id="cb104-16"><a href="#cb104-16" tabindex="-1"></a></span>
<span id="cb104-17"><a href="#cb104-17" tabindex="-1"></a></span>
<span id="cb104-18"><a href="#cb104-18" tabindex="-1"></a></span>
<span id="cb104-19"><a href="#cb104-19" tabindex="-1"></a><span class="co"># Gibbs sampler function with multiple chains</span></span>
<span id="cb104-20"><a href="#cb104-20" tabindex="-1"></a>gibbs_sampler_multiple_chains <span class="ot">&lt;-</span> <span class="cf">function</span>(n_chains, n_samples, n, a, b) {</span>
<span id="cb104-21"><a href="#cb104-21" tabindex="-1"></a>  <span class="co"># Initialize a matrix to store samples for each chain</span></span>
<span id="cb104-22"><a href="#cb104-22" tabindex="-1"></a>  chains_x <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_samples, <span class="at">ncol =</span> n_chains)</span>
<span id="cb104-23"><a href="#cb104-23" tabindex="-1"></a>  chains_y <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> n_samples, <span class="at">ncol =</span> n_chains)</span>
<span id="cb104-24"><a href="#cb104-24" tabindex="-1"></a></span>
<span id="cb104-25"><a href="#cb104-25" tabindex="-1"></a>  <span class="co"># Run multiple chains</span></span>
<span id="cb104-26"><a href="#cb104-26" tabindex="-1"></a>  </span>
<span id="cb104-27"><a href="#cb104-27" tabindex="-1"></a>  <span class="cf">for</span>(chain <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_chains){</span>
<span id="cb104-28"><a href="#cb104-28" tabindex="-1"></a>    <span class="co"># Store samples in the chains matrix</span></span>
<span id="cb104-29"><a href="#cb104-29" tabindex="-1"></a>    chains_x[, chain] <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n_samples, n, a, b)<span class="sc">$</span>X</span>
<span id="cb104-30"><a href="#cb104-30" tabindex="-1"></a>    chains_y[, chain] <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n_samples, n, a, b)<span class="sc">$</span>Y</span>
<span id="cb104-31"><a href="#cb104-31" tabindex="-1"></a>  }</span>
<span id="cb104-32"><a href="#cb104-32" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">X =</span> chains_x, <span class="at">Y =</span> chains_y))</span>
<span id="cb104-33"><a href="#cb104-33" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" tabindex="-1"></a><span class="co">#statistical inference</span></span>
<span id="cb105-2"><a href="#cb105-2" tabindex="-1"></a><span class="co"># Function to compute Gelman-Rubin diagnostic</span></span>
<span id="cb105-3"><a href="#cb105-3" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb105-4"><a href="#cb105-4" tabindex="-1"></a>        <span class="co"># psi[i,j] is the statistic psi(X[i,1:j])</span></span>
<span id="cb105-5"><a href="#cb105-5" tabindex="-1"></a>        <span class="co"># for chain in i-th row of X</span></span>
<span id="cb105-6"><a href="#cb105-6" tabindex="-1"></a>        psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb105-7"><a href="#cb105-7" tabindex="-1"></a>        n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb105-8"><a href="#cb105-8" tabindex="-1"></a>        k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb105-9"><a href="#cb105-9" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" tabindex="-1"></a>        psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)     <span class="co">#row means</span></span>
<span id="cb105-11"><a href="#cb105-11" tabindex="-1"></a>        B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means)        <span class="co">#between variance est.</span></span>
<span id="cb105-12"><a href="#cb105-12" tabindex="-1"></a>        psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)  <span class="co">#within variances</span></span>
<span id="cb105-13"><a href="#cb105-13" tabindex="-1"></a>        W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w)               <span class="co">#within est.</span></span>
<span id="cb105-14"><a href="#cb105-14" tabindex="-1"></a>        v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n)     <span class="co">#upper variance est.</span></span>
<span id="cb105-15"><a href="#cb105-15" tabindex="-1"></a>        r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W             <span class="co">#G-R statistic</span></span>
<span id="cb105-16"><a href="#cb105-16" tabindex="-1"></a>        <span class="fu">return</span>(r.hat)</span>
<span id="cb105-17"><a href="#cb105-17" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a><span class="co">#Result Reporting</span></span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a>GB_monitor_plot <span class="ot">&lt;-</span> <span class="cf">function</span>(chains,n_chains,b,n_samples){</span>
<span id="cb106-3"><a href="#cb106-3" tabindex="-1"></a>  <span class="co">#compute diagnostic statistics</span></span>
<span id="cb106-4"><a href="#cb106-4" tabindex="-1"></a>    psi <span class="ot">&lt;-</span> <span class="fu">t</span>(<span class="fu">apply</span>(chains, <span class="dv">1</span>, cumsum))</span>
<span id="cb106-5"><a href="#cb106-5" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi))</span>
<span id="cb106-6"><a href="#cb106-6" tabindex="-1"></a>        psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb106-7"><a href="#cb106-7" tabindex="-1"></a></span>
<span id="cb106-8"><a href="#cb106-8" tabindex="-1"></a>    <span class="co">#plot psi for the four chains</span></span>
<span id="cb106-9"><a href="#cb106-9" tabindex="-1"></a><span class="co">#    par(mfrow=c(2,2))</span></span>
<span id="cb106-10"><a href="#cb106-10" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_chains)</span>
<span id="cb106-11"><a href="#cb106-11" tabindex="-1"></a>      <span class="cf">if</span>(i<span class="sc">==</span><span class="dv">1</span>){</span>
<span id="cb106-12"><a href="#cb106-12" tabindex="-1"></a>        <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_samples,psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_samples], <span class="at">type=</span><span class="st">&quot;l&quot;</span>,</span>
<span id="cb106-13"><a href="#cb106-13" tabindex="-1"></a>            <span class="at">xlab=</span><span class="st">&#39;Index&#39;</span>, <span class="at">ylab=</span><span class="fu">bquote</span>(phi))</span>
<span id="cb106-14"><a href="#cb106-14" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb106-15"><a href="#cb106-15" tabindex="-1"></a>        <span class="fu">lines</span>(psi[i, (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_samples], <span class="at">col=</span>i)</span>
<span id="cb106-16"><a href="#cb106-16" tabindex="-1"></a>    }</span>
<span id="cb106-17"><a href="#cb106-17" tabindex="-1"></a>    <span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>)) <span class="co">#restore default</span></span>
<span id="cb106-18"><a href="#cb106-18" tabindex="-1"></a>    <span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb106-19"><a href="#cb106-19" tabindex="-1"></a>    rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n_samples)</span>
<span id="cb106-20"><a href="#cb106-20" tabindex="-1"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n_samples){</span>
<span id="cb106-21"><a href="#cb106-21" tabindex="-1"></a>        rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])}</span>
<span id="cb106-22"><a href="#cb106-22" tabindex="-1"></a>    <span class="fu">plot</span>((b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_samples,rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>n_samples], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb106-23"><a href="#cb106-23" tabindex="-1"></a>    <span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.1</span>, <span class="at">lty=</span><span class="dv">2</span>)</span>
<span id="cb106-24"><a href="#cb106-24" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a><span class="co"># Parameters</span></span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span>  <span class="co"># Total trials</span></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span>   <span class="co"># Shape parameter for Beta distribution</span></span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span>   <span class="co"># Shape parameter for Beta distribution</span></span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>n_chains <span class="ot">&lt;-</span> <span class="dv">4</span>  <span class="co"># Number of chains</span></span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a>n_samples <span class="ot">&lt;-</span> <span class="dv">15000</span>  <span class="co"># Number of samples</span></span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a>proposal_sd <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">1000</span>       <span class="co">#burn-in length</span></span>
<span id="cb107-10"><a href="#cb107-10" tabindex="-1"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb107-11"><a href="#cb107-11" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">5</span>,<span class="sc">-</span><span class="dv">10</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb107-12"><a href="#cb107-12" tabindex="-1"></a></span>
<span id="cb107-13"><a href="#cb107-13" tabindex="-1"></a><span class="co">#Method1</span></span>
<span id="cb107-14"><a href="#cb107-14" tabindex="-1"></a><span class="co"># Run the Metropolis-Hastings algorithm until convergence</span></span>
<span id="cb107-15"><a href="#cb107-15" tabindex="-1"></a>convergence_threshold <span class="ot">&lt;-</span> <span class="fl">1.2</span></span>
<span id="cb107-16"><a href="#cb107-16" tabindex="-1"></a>R_hat <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb107-17"><a href="#cb107-17" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb107-18"><a href="#cb107-18" tabindex="-1"></a></span>
<span id="cb107-19"><a href="#cb107-19" tabindex="-1"></a><span class="cf">while</span> (R_hat <span class="sc">&gt;=</span> convergence_threshold) {</span>
<span id="cb107-20"><a href="#cb107-20" tabindex="-1"></a>  chains1 <span class="ot">&lt;-</span> <span class="fu">metropolis_hastings_multiple_chains</span>(n_chains,n_samples,proposal_sd,x0)</span>
<span id="cb107-21"><a href="#cb107-21" tabindex="-1"></a>  chains1 <span class="ot">&lt;-</span> <span class="fu">t</span>(chains1)</span>
<span id="cb107-22"><a href="#cb107-22" tabindex="-1"></a>  R_hat<span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(chains1)</span>
<span id="cb107-23"><a href="#cb107-23" tabindex="-1"></a>  </span>
<span id="cb107-24"><a href="#cb107-24" tabindex="-1"></a>}</span>
<span id="cb107-25"><a href="#cb107-25" tabindex="-1"></a><span class="fu">print</span>(R_hat)</span></code></pre></div>
<pre><code>## [1] 1.014364</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" tabindex="-1"></a><span class="fu">GB_monitor_plot</span>(chains1,n_chains,b,n_samples)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb110-2"><a href="#cb110-2" tabindex="-1"></a><span class="co"># Run the Gibbs sampler until convergence</span></span>
<span id="cb110-3"><a href="#cb110-3" tabindex="-1"></a>convergence_threshold <span class="ot">&lt;-</span> <span class="fl">1.2</span></span>
<span id="cb110-4"><a href="#cb110-4" tabindex="-1"></a>R_hat <span class="ot">&lt;-</span> <span class="cn">Inf</span></span>
<span id="cb110-5"><a href="#cb110-5" tabindex="-1"></a>samples <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb110-6"><a href="#cb110-6" tabindex="-1"></a></span>
<span id="cb110-7"><a href="#cb110-7" tabindex="-1"></a><span class="cf">while</span> (R_hat <span class="sc">&gt;=</span> convergence_threshold) {</span>
<span id="cb110-8"><a href="#cb110-8" tabindex="-1"></a>  chains2 <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler_multiple_chains</span>(n_chains, n_samples, n, a, b)</span>
<span id="cb110-9"><a href="#cb110-9" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">t</span>(chains2<span class="sc">$</span>X)</span>
<span id="cb110-10"><a href="#cb110-10" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">t</span>(chains2<span class="sc">$</span>Y)</span>
<span id="cb110-11"><a href="#cb110-11" tabindex="-1"></a>  <span class="co"># Compute R_hat for both X and Y</span></span>
<span id="cb110-12"><a href="#cb110-12" tabindex="-1"></a>  R_hat_x <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(X)</span>
<span id="cb110-13"><a href="#cb110-13" tabindex="-1"></a>  R_hat_y <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(Y)</span>
<span id="cb110-14"><a href="#cb110-14" tabindex="-1"></a>  R_hat <span class="ot">&lt;-</span> <span class="fu">max</span>(R_hat_x, R_hat_y)</span>
<span id="cb110-15"><a href="#cb110-15" tabindex="-1"></a>  </span>
<span id="cb110-16"><a href="#cb110-16" tabindex="-1"></a>}</span>
<span id="cb110-17"><a href="#cb110-17" tabindex="-1"></a></span>
<span id="cb110-18"><a href="#cb110-18" tabindex="-1"></a><span class="fu">GB_monitor_plot</span>(X,n_chains,b,n_samples)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="fu">GB_monitor_plot</span>(Y,n_chains,b,n_samples)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="conclusion-18" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,Exercise 9.3<code>s series don</code>t
convergence with sample goes large,I guess it is the choice of proposal
distirbution or initial values caused.Exercise 9.8 has a better result
and get a stationary series when sample gets large.</p>
</div>
</div>
<div id="exercise-proof-of-stationary" class="section level3">
<h3>Exercise Proof of stationary</h3>
<div id="question-20" class="section level4">
<h4>Question</h4>
<p>Proof the Stationary of Metropolis-Hastings sampler Algorithm in
continuous situation.</p>
<p>Algorithm(continuous situation)</p>
<ul>
<li><p>Target pdf:<span class="math inline">\(f(x)\)</span></p></li>
<li><p>Replace i and j with s and r</p></li>
<li><p>Proposal distribution (pdf):<span class="math inline">\(g(r|s)\)</span></p></li>
<li><p>Acceptance probability:<span class="math inline">\(\alpha(s,r)=min\{\frac{f(r)g(s|r)}{f(s)g(r|s)},1\}\)</span></p></li>
<li><p>Transition kernel(mixture distribution)</p></li>
</ul>
<p><span class="math display">\[
K(r,s)=I(s\neq r)\alpha(r,s)g(s|r)+I(s=r)[1-\int \alpha(r,s)g(s|r)]
\]</span></p>
<ul>
<li>Stationarity:<span class="math inline">\(K(s,r)f(s)=K(r,s)f(r)\)</span></li>
</ul>
</div>
<div id="answer-19" class="section level4">
<h4>Answer</h4>
<p>To prove the stationarity of the Metropolis-Hastings (MH) sampler
algorithm in a continuous setting, we need to show that the transition
kernel <span class="math inline">\(K(s, r)\)</span> preserves the target
distribution <span class="math inline">\(f(x)\)</span>. Specifically, we
will demonstrate that</p>
<p><span class="math display">\[
K(s, r) f(s) = K(r, s) f(r)
\]</span></p>
<p>for all <span class="math inline">\(s\)</span> and <span class="math inline">\(r\)</span>.</p>
<div id="step-1-define-the-transition-kernel" class="section level5">
<h5>Step 1: Define the Transition Kernel</h5>
<p>The transition kernel is defined as:</p>
<p><span class="math display">\[
K(r,s) = I(s \neq r) \alpha(r,s) g(s|r) + I(s = r) \left[1 - \int
\alpha(r,s) g(s|r) ds\right]
\]</span></p>
<p>where <span class="math inline">\(I\)</span> is an indicator
function, <span class="math inline">\(\alpha(s, r)\)</span> is the
acceptance probability, and <span class="math inline">\(g(s|r)\)</span>
is the proposal distribution.</p>
</div>
<div id="step-2-write-the-acceptance-probability" class="section level5">
<h5>Step 2: Write the Acceptance Probability</h5>
<p>The acceptance probability is given by:</p>
<p><span class="math display">\[
\alpha(s, r) = \min \left\{1, \frac{f(r) g(s|r)}{f(s) g(r|s)}\right\}
\]</span></p>
</div>
<div id="step-3-show-the-detailed-balance-condition" class="section level5">
<h5>Step 3: Show the Detailed Balance Condition</h5>
<p>To establish stationarity, we will show that:</p>
<p><span class="math display">\[
K(s, r) f(s) = K(r, s) f(r)
\]</span></p>
<div id="case-1" class="section level6">
<h6>Case 1:</h6>
<p><span class="math inline">\(s \neq r\)</span></p>
<p><span class="math display">\[
K(s, r) f(s) = \alpha(s, r) g(r|s) f(s)
\]</span></p>
<p>Substituting <span class="math inline">\(\alpha(s, r)\)</span>:</p>
<p><span class="math display">\[
K(s, r) f(s) = \min \left\{1, \frac{f(r) g(s|r)}{f(s) g(r|s)}\right\}
g(r|s) f(s)
\]</span></p>
<p>Now, we need to compute <span class="math inline">\(K(r,
s)\)</span>:</p>
<p><span class="math display">\[
K(r, s) f(r) = \alpha(r, s) g(s|r) f(r)
\]</span></p>
<p>Substituting <span class="math inline">\(\alpha(r, s)\)</span>:</p>
<p><span class="math display">\[
K(r, s) f(r) = \min \left\{1, \frac{f(s) g(r|s)}{f(r) g(s|r)}\right\}
g(s|r) f(r)
\]</span></p>
</div>
</div>
<div id="step-4-comparing-the-two-cases" class="section level5">
<h5>Step 4: Comparing the Two Cases</h5>
<p>Now, we need to show that these two expressions are equal. Notice
that:</p>
<ol style="list-style-type: decimal">
<li><p>If <span class="math inline">\(\alpha(s, r) = 1\)</span>, then
<span class="math inline">\(f(r) g(s|r) = f(s) g(r|s)\)</span>.</p></li>
<li><p>If <span class="math inline">\(\alpha(s, r) &lt; 1\)</span>, we
have:</p>
<p><span class="math display">\[
\alpha(s, r) g(r|s) f(s) = \frac{f(r) g(s|r)}{f(s) g(r|s)} g(r|s) f(s)
\]</span></p>
<p>which simplifies to:</p>
<p><span class="math display">\[
f(r) g(s|r)
\]</span></p>
<p>Therefore, the equality holds as:</p></li>
</ol>
<p><span class="math display">\[
K(s, r) f(s) = K(r, s) f(r)
\]</span></p>
<div id="case-2" class="section level6">
<h6>Case 2:</h6>
<p><span class="math inline">\(s = r\)</span></p>
<p>In this case, we have:</p>
<p><span class="math display">\[
K(s, s) f(s) = \left[1 - \int \alpha(s,r) g(s|r) dr\right] f(s)
\]</span></p>
<p>And for <span class="math inline">\(K(r, r)\)</span>:</p>
<p><span class="math display">\[
K(r, r) f(r) = \left[1 - \int \alpha(r,s) g(r|s) ds\right] f(r)
\]</span></p>
<p>The same argument holds, showing that both terms will converge since
the integral will equalize in both cases.</p>
</div>
</div>
</div>
<div id="conclusion-19" class="section level4">
<h4>Conclusion</h4>
<p>The stationarity of the Metropolis-Hastings sampler is established
through the detailed balance condition, ensuring that the target
distribution is preserved across transitions in the Markov chain.</p>
</div>
</div>
</div>
<div id="homework7" class="section level2">
<h2>Homework7</h2>
<div id="exercise-11.3" class="section level3">
<h3>Exercise 11.3</h3>
<div id="question-21" class="section level4">
<h4>Question</h4>
<p>(a)Write a function to compute the kth term in <span class="math display">\[
\sum_{k=0}^{\infty} \frac{(-1)^{k}}{k!2^{k}} \frac{\|a\|^{2 k+2}}{(2
k+1)(2 k+2)} \frac{\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)},
\]</span> where <span class="math inline">\(d \geq 1\)</span>is an
integer, a is a vector in <span class="math inline">\(\mathbb{R}^{d}\)</span>, and <span class="math inline">\(\|\cdot\|\)</span> denotes the Euclidean norm.
Perform the arithmetic so that the coefficients can be computed for
(almost) arbitrarily large <span class="math inline">\(k\)</span> and
<span class="math inline">\(d\)</span>. (This sum converges for all
<span class="math inline">\(a \in \mathbb{R}^{d}\)</span> ).</p>
<ol start="2" style="list-style-type: lower-alpha">
<li><p>Modify the function so that it computes and returns the
sum.</p></li>
<li><p>Evaluate the sum when <span class="math inline">\(a=(1,2)^{T}\)</span>.</p></li>
</ol>
</div>
<div id="answer-20" class="section level4">
<h4>Answer</h4>
<div id="a-compute-the-kth-term" class="section level5">
<h5>(a) Compute the kth term</h5>
<p>We will write a function to compute the <code>kth term</code></p>
<p><span class="math display">\[
\frac{(-1)^{k}}{k!2^{k}} \frac{\|a\|^{2 k+2}}{(2 k+1)(2 k+2)}
\frac{\Gamma\left(\frac{d+1}{2}\right)
\Gamma\left(k+\frac{3}{2}\right)}{\Gamma\left(k+\frac{d}{2}+1\right)}
\]</span></p>
<p>We can use <code>gamma</code> function to compute the gamma function
values,use <code>factorial</code> to compute the factorial.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a>kth_term <span class="ot">&lt;-</span> <span class="cf">function</span>(k, a, d) {</span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>  <span class="co"># compute Euclid norm ||a||</span></span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a>  norm_a <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb112-4"><a href="#cb112-4" tabindex="-1"></a>  </span>
<span id="cb112-5"><a href="#cb112-5" tabindex="-1"></a>  <span class="co"># 计算每一部分</span></span>
<span id="cb112-6"><a href="#cb112-6" tabindex="-1"></a>  part1 <span class="ot">&lt;-</span> (<span class="sc">-</span><span class="dv">1</span>)<span class="sc">^</span>k <span class="sc">/</span> (<span class="fu">factorial</span>(k) <span class="sc">*</span> <span class="dv">2</span><span class="sc">^</span>k)</span>
<span id="cb112-7"><a href="#cb112-7" tabindex="-1"></a>  part2 <span class="ot">&lt;-</span> norm_a<span class="sc">^</span>(<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>) <span class="sc">/</span> ((<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">*</span> (<span class="dv">2</span> <span class="sc">*</span> k <span class="sc">+</span> <span class="dv">2</span>))</span>
<span id="cb112-8"><a href="#cb112-8" tabindex="-1"></a>  part3 <span class="ot">&lt;-</span> <span class="fu">gamma</span>((d <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">+</span> <span class="fl">1.5</span>) <span class="sc">/</span> <span class="fu">gamma</span>(k <span class="sc">+</span> d <span class="sc">/</span> <span class="dv">2</span> <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb112-9"><a href="#cb112-9" tabindex="-1"></a>  </span>
<span id="cb112-10"><a href="#cb112-10" tabindex="-1"></a>  <span class="fu">return</span>(part1 <span class="sc">*</span> part2 <span class="sc">*</span> part3)</span>
<span id="cb112-11"><a href="#cb112-11" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="b-compute-the-sum-of-series" class="section level5">
<h5>(b) compute the sum of series</h5>
<p>Next,we modify the function to compute the sum of series.We will set
a error threshold <code>tol</code>，when the absolute value is less than
<code>tol</code> ,then start iterate.</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" tabindex="-1"></a>series_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(a, d, <span class="at">tol =</span> <span class="fl">1e-10</span>, <span class="at">max_terms =</span> <span class="dv">1000</span>) {</span>
<span id="cb113-2"><a href="#cb113-2" tabindex="-1"></a>  total_sum <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb113-3"><a href="#cb113-3" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb113-4"><a href="#cb113-4" tabindex="-1"></a>  </span>
<span id="cb113-5"><a href="#cb113-5" tabindex="-1"></a>  <span class="cf">repeat</span> {</span>
<span id="cb113-6"><a href="#cb113-6" tabindex="-1"></a>    term <span class="ot">&lt;-</span> <span class="fu">kth_term</span>(k, a, d)</span>
<span id="cb113-7"><a href="#cb113-7" tabindex="-1"></a>    total_sum <span class="ot">&lt;-</span> total_sum <span class="sc">+</span> term</span>
<span id="cb113-8"><a href="#cb113-8" tabindex="-1"></a>    </span>
<span id="cb113-9"><a href="#cb113-9" tabindex="-1"></a>    <span class="co"># if the value is less than threshold,exit!!!</span></span>
<span id="cb113-10"><a href="#cb113-10" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(term) <span class="sc">&lt;</span> tol <span class="sc">||</span> k <span class="sc">&gt;=</span> max_terms) {</span>
<span id="cb113-11"><a href="#cb113-11" tabindex="-1"></a>      <span class="cf">break</span></span>
<span id="cb113-12"><a href="#cb113-12" tabindex="-1"></a>    }</span>
<span id="cb113-13"><a href="#cb113-13" tabindex="-1"></a>    </span>
<span id="cb113-14"><a href="#cb113-14" tabindex="-1"></a>    k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb113-15"><a href="#cb113-15" tabindex="-1"></a>  }</span>
<span id="cb113-16"><a href="#cb113-16" tabindex="-1"></a>  </span>
<span id="cb113-17"><a href="#cb113-17" tabindex="-1"></a>  <span class="fu">return</span>(total_sum)</span>
<span id="cb113-18"><a href="#cb113-18" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="c-compute-the-series-sum-whena-1-2t" class="section level5">
<h5>(c) compute the series sum when<span class="math inline">\(a = (1,
2)^T\)</span></h5>
<p>Last,we can use function ‘series_sum’ to compute the series sum
when<span class="math inline">\(a=(1,2)^T\)</span>and<span class="math inline">\(d=2\)</span></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb114-2"><a href="#cb114-2" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb114-3"><a href="#cb114-3" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">series_sum</span>(a, d)</span>
<span id="cb114-4"><a href="#cb114-4" tabindex="-1"></a>result</span></code></pre></div>
<pre><code>## [1] 1.532164</code></pre>
</div>
</div>
<div id="conclusion-20" class="section level4">
<h4>Conclusion</h4>
<p>After we run code,the result of series sum when<span class="math inline">\(a=(1,2)^T\)</span>is 1.532.</p>
</div>
</div>
<div id="exercise-11.4" class="section level3">
<h3>Exercise 11.4</h3>
<div id="question-22" class="section level4">
<h4>Question</h4>
<p>Find the intersection points <span class="math inline">\(A(k)\)</span> in (0,<span class="math inline">\(\sqrt{k}\)</span>) of the curves <span class="math display">\[
S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^{2}(k-1)}{k-a^{2}}}\right)
\]</span> and <span class="math display">\[
S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^{2} k}{k+1-a^{2}}}\right),
\]</span> for <span class="math inline">\(k=4: 25,100,500,1000\)</span>,
where t(k) is a Student t random variable with k degrees of freedom.
(These intersection points determine the critical values for a t -test
for scale-mixture errors proposed by Székely [260].) #### Answer</p>
<p>To find the intersection points <span class="math inline">\(A(k)\)</span> of the curves<span class="math inline">\(S_{k-1}(a)\)</span>and <span class="math inline">\(S_k(a)\)</span>for specified values of<span class="math inline">\(k\)</span>, we can proceed by defining and
numerically solving for<span class="math inline">\(a\)</span> where the
two curves are equal.</p>
<div id="defines_k-1a-ands_ka" class="section level5">
<h5>1. Define<span class="math inline">\(S_{k-1}(a)\)</span> and<span class="math inline">\(S_k(a)\)</span></h5>
<p>Given: <span class="math display">\[
S_{k-1}(a) = P\left(t(k-1) &gt; \sqrt{\frac{a^2 (k-1)}{k - a^2}}\right)
\]</span> <span class="math display">\[
S_k(a) = P\left(t(k) &gt; \sqrt{\frac{a^2 k}{k + 1 - a^2}}\right)
\]</span> where<span class="math inline">\(t(k-1)\)</span> and<span class="math inline">\(t(k)\)</span>are Student’s<span class="math inline">\(t\)</span>-distributions with<span class="math inline">\(k-1\)</span> and<span class="math inline">\(k\)</span> degrees of freedom, respectively.</p>
<p>In R, the probability<span class="math inline">\(P(t(k) &gt;
x)\)</span> can be computed using the cumulative distribution function
of the <span class="math inline">\(t\)</span>-distribution: <span class="math display">\[
P(t(k) &gt; x) = 1 - F_{t(k)}(x),
\]</span> where<span class="math inline">\(F_{t(k)}\)</span>is the
cumulative distribution function of<span class="math inline">\(t\)</span> with<span class="math inline">\(k\)</span> degrees of freedom.</p>
</div>
<div id="define-the-difference-function" class="section level5">
<h5>2. Define the Difference Function</h5>
<p>Define a function<span class="math inline">\(f(a; k) = S_{k-1}(a) -
S_k(a)\)</span>, and then find the root of this function (i.e.,
where<span class="math inline">\(f(a; k) = 0\)</span>) within the
interval<span class="math inline">\((0, \sqrt{k})\)</span>.</p>
</div>
<div id="implementation-in-r" class="section level5">
<h5>3. Implementation in R</h5>
<p>We can use the bisection method to find the root of<span class="math inline">\(f(a; k)\)</span> within the interval<span class="math inline">\((0, \sqrt{k})\)</span>for each specified <span class="math inline">\(k\)</span>.</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="co"># Define S_k-1 and S_k</span></span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>S_k_minus_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>)), <span class="at">df =</span> k <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb116-4"><a href="#cb116-4" tabindex="-1"></a>}</span>
<span id="cb116-5"><a href="#cb116-5" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" tabindex="-1"></a>S_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb116-7"><a href="#cb116-7" tabindex="-1"></a>  <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>)), <span class="at">df =</span> k)</span>
<span id="cb116-8"><a href="#cb116-8" tabindex="-1"></a>}</span>
<span id="cb116-9"><a href="#cb116-9" tabindex="-1"></a></span>
<span id="cb116-10"><a href="#cb116-10" tabindex="-1"></a><span class="co"># Define function to find root using Bisection method</span></span>
<span id="cb116-11"><a href="#cb116-11" tabindex="-1"></a>find_intersection_bisection <span class="ot">&lt;-</span> <span class="cf">function</span>(k, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb116-12"><a href="#cb116-12" tabindex="-1"></a>  <span class="co"># Define the function to find zero</span></span>
<span id="cb116-13"><a href="#cb116-13" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="fu">S_k_minus_1</span>(a, k) <span class="sc">-</span> <span class="fu">S_k</span>(a, k)</span>
<span id="cb116-14"><a href="#cb116-14" tabindex="-1"></a>  </span>
<span id="cb116-15"><a href="#cb116-15" tabindex="-1"></a>   <span class="co"># Initial interval (0, sqrt(k))</span></span>
<span id="cb116-16"><a href="#cb116-16" tabindex="-1"></a>  epsilon <span class="ot">&lt;-</span> <span class="fl">1e-3</span></span>
<span id="cb116-17"><a href="#cb116-17" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> epsilon</span>
<span id="cb116-18"><a href="#cb116-18" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(k)<span class="sc">-</span>epsilon</span>
<span id="cb116-19"><a href="#cb116-19" tabindex="-1"></a>  </span>
<span id="cb116-20"><a href="#cb116-20" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">f</span>(lower) <span class="sc">*</span> <span class="fu">f</span>(upper) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb116-21"><a href="#cb116-21" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;No sign change detected in the initial interval; adjust the interval.&quot;</span>)</span>
<span id="cb116-22"><a href="#cb116-22" tabindex="-1"></a>  }</span>
<span id="cb116-23"><a href="#cb116-23" tabindex="-1"></a>  </span>
<span id="cb116-24"><a href="#cb116-24" tabindex="-1"></a>  </span>
<span id="cb116-25"><a href="#cb116-25" tabindex="-1"></a>  <span class="co"># Bisection method loop</span></span>
<span id="cb116-26"><a href="#cb116-26" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb116-27"><a href="#cb116-27" tabindex="-1"></a>    mid <span class="ot">&lt;-</span> (lower <span class="sc">+</span> upper) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb116-28"><a href="#cb116-28" tabindex="-1"></a>    f_mid <span class="ot">&lt;-</span> <span class="fu">f</span>(mid)</span>
<span id="cb116-29"><a href="#cb116-29" tabindex="-1"></a>    </span>
<span id="cb116-30"><a href="#cb116-30" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(f_mid) <span class="sc">&lt;</span> tol) {</span>
<span id="cb116-31"><a href="#cb116-31" tabindex="-1"></a>      <span class="fu">return</span>(mid)</span>
<span id="cb116-32"><a href="#cb116-32" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">f</span>(lower) <span class="sc">*</span> f_mid <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb116-33"><a href="#cb116-33" tabindex="-1"></a>      upper <span class="ot">&lt;-</span> mid</span>
<span id="cb116-34"><a href="#cb116-34" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb116-35"><a href="#cb116-35" tabindex="-1"></a>      lower <span class="ot">&lt;-</span> mid</span>
<span id="cb116-36"><a href="#cb116-36" tabindex="-1"></a>    }</span>
<span id="cb116-37"><a href="#cb116-37" tabindex="-1"></a>  }</span>
<span id="cb116-38"><a href="#cb116-38" tabindex="-1"></a>  </span>
<span id="cb116-39"><a href="#cb116-39" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">&quot;Bisection method did not converge.&quot;</span>)</span>
<span id="cb116-40"><a href="#cb116-40" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb116-41"><a href="#cb116-41" tabindex="-1"></a>}</span>
<span id="cb116-42"><a href="#cb116-42" tabindex="-1"></a></span>
<span id="cb116-43"><a href="#cb116-43" tabindex="-1"></a><span class="co"># Calculate intersection points for specified values of k</span></span>
<span id="cb116-44"><a href="#cb116-44" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb116-45"><a href="#cb116-45" tabindex="-1"></a></span>
<span id="cb116-46"><a href="#cb116-46" tabindex="-1"></a>root <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_values))</span>
<span id="cb116-47"><a href="#cb116-47" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k_values)){</span>
<span id="cb116-48"><a href="#cb116-48" tabindex="-1"></a>  root[i] <span class="ot">&lt;-</span> <span class="fu">find_intersection_bisection</span>(k_values[i])</span>
<span id="cb116-49"><a href="#cb116-49" tabindex="-1"></a>}</span>
<span id="cb116-50"><a href="#cb116-50" tabindex="-1"></a></span>
<span id="cb116-51"><a href="#cb116-51" tabindex="-1"></a><span class="fu">names</span>(root) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;k=&quot;</span>, k_values)</span>
<span id="cb116-52"><a href="#cb116-52" tabindex="-1"></a>root</span></code></pre></div>
<pre><code>##       k=4       k=5       k=6       k=7       k=8       k=9      k=10      k=11 
##  1.492122  1.533513  1.562649  1.584282  1.601216  1.614182  1.625117  1.634035 
##      k=12      k=13      k=14      k=15      k=16      k=17      k=18      k=19 
##  1.642455  1.647936  1.653534  1.658643  1.664230  1.667150  1.669924  1.673130 
##      k=20      k=21      k=22      k=23      k=24      k=25     k=100     k=500 
##  1.677301  1.678457  1.681321  1.686331  1.684337  1.689777  5.000000 11.180340 
##    k=1000 
## 15.811388</code></pre>
</div>
</div>
<div id="conclusion-21" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,we find that when k is lager,the intersection
<span class="math inline">\(a\)</span> become lager too.</p>
</div>
</div>
<div id="exercise-11.5" class="section level3">
<h3>Exercise 11.5</h3>
<div id="question-23" class="section level4">
<h4>Question</h4>
<p>Write a function to solve the equation <span class="math display">\[
\begin{array}{l}
\frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)}
\Gamma\left(\frac{k-1}{2}\right)}
\int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \\
\quad=\frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k}
\Gamma\left(\frac{k}{2}\right)}
\int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u
\end{array}
\]</span> for <span class="math inline">\(a\)</span>, where <span class="math display">\[
c_{k}=\sqrt{\frac{a^{2} k}{k+1-a^{2}}} .
\]</span></p>
<p>Compare the solutions with the points <span class="math inline">\(A(k)\)</span> in Exercise 11.4.</p>
</div>
<div id="answer-21" class="section level4">
<h4>Answer</h4>
<p>To solve this equation for<span class="math inline">\(a\)</span>, we
need to implement the equation as a function of<span class="math inline">\(a\)</span>and then find the root of the difference
between the left and right sides.</p>
<div id="steps-to-implement-the-solution" class="section level5">
<h5>Steps to Implement the Solution</h5>
<ol style="list-style-type: decimal">
<li><p><strong>Define<span class="math inline">\(c_k\)</span> and<span class="math inline">\(c_{k-1}\)</span></strong>: We have<span class="math inline">\(c_k = \sqrt{\frac{a^2
k}{k+1-a^2}}\)</span>and<span class="math inline">\(c_{k-1} =
\sqrt{\frac{a^2 (k-1)}{k-a^2}}\)</span>.</p></li>
<li><p><strong>Define the Integrals</strong>: The two integrals in the
equation can be expressed as: <span class="math display">\[
\int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} \, d u
  \]</span> and <span class="math display">\[
\int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} \, d u.
  \]</span> We can numerically approximate these integrals using R’s
<code>integrate</code> function.</p></li>
<li><p><strong>Set Up the Equation</strong>: The left side and right
side of the equation involve Gamma functions, which we can calculate
with R’s <code>gamma</code> function.</p></li>
<li><p><strong>Solve for<span class="math inline">\(a\)</span></strong>:
Define a function to compute the difference between the two sides, and
use a root-finding algorithm (bisection method) to find the value
of<span class="math inline">\(a\)</span>that makes this difference
zero.</p></li>
</ol>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a><span class="co"># Define c_k and c_{k-1} as functions of a and k</span></span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a>c_k <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb118-3"><a href="#cb118-3" tabindex="-1"></a>  <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> k <span class="sc">/</span> (k <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb118-4"><a href="#cb118-4" tabindex="-1"></a>}</span>
<span id="cb118-5"><a href="#cb118-5" tabindex="-1"></a></span>
<span id="cb118-6"><a href="#cb118-6" tabindex="-1"></a>c_k_minus_1 <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb118-7"><a href="#cb118-7" tabindex="-1"></a>  <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> (k <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb118-8"><a href="#cb118-8" tabindex="-1"></a>}</span>
<span id="cb118-9"><a href="#cb118-9" tabindex="-1"></a></span>
<span id="cb118-10"><a href="#cb118-10" tabindex="-1"></a><span class="co"># Define the left side integral</span></span>
<span id="cb118-11"><a href="#cb118-11" tabindex="-1"></a>integral_left <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb118-12"><a href="#cb118-12" tabindex="-1"></a>  c_km1 <span class="ot">&lt;-</span> <span class="fu">c_k_minus_1</span>(a, k)</span>
<span id="cb118-13"><a href="#cb118-13" tabindex="-1"></a>  integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (k <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>k <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb118-14"><a href="#cb118-14" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">integrate</span>(integrand, <span class="dv">0</span>, c_km1)<span class="sc">$</span>value)</span>
<span id="cb118-15"><a href="#cb118-15" tabindex="-1"></a>}</span>
<span id="cb118-16"><a href="#cb118-16" tabindex="-1"></a></span>
<span id="cb118-17"><a href="#cb118-17" tabindex="-1"></a><span class="co"># Define the right side integral</span></span>
<span id="cb118-18"><a href="#cb118-18" tabindex="-1"></a>integral_right <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb118-19"><a href="#cb118-19" tabindex="-1"></a>  c_k_val <span class="ot">&lt;-</span> <span class="fu">c_k</span>(a, k)</span>
<span id="cb118-20"><a href="#cb118-20" tabindex="-1"></a>  integrand <span class="ot">&lt;-</span> <span class="cf">function</span>(u) (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> k)<span class="sc">^</span>(<span class="sc">-</span>(k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb118-21"><a href="#cb118-21" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">integrate</span>(integrand, <span class="dv">0</span>, c_k_val)<span class="sc">$</span>value)</span>
<span id="cb118-22"><a href="#cb118-22" tabindex="-1"></a>}</span>
<span id="cb118-23"><a href="#cb118-23" tabindex="-1"></a></span>
<span id="cb118-24"><a href="#cb118-24" tabindex="-1"></a><span class="co"># Define the full equation difference function</span></span>
<span id="cb118-25"><a href="#cb118-25" tabindex="-1"></a>equation_difference <span class="ot">&lt;-</span> <span class="cf">function</span>(a, k) {</span>
<span id="cb118-26"><a href="#cb118-26" tabindex="-1"></a>  gamma_ratio_left <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> (k <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb118-27"><a href="#cb118-27" tabindex="-1"></a>  gamma_ratio_right <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="sc">*</span> <span class="fu">gamma</span>((k <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">/</span> (<span class="fu">sqrt</span>(pi <span class="sc">*</span> k) <span class="sc">*</span> <span class="fu">gamma</span>(k <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb118-28"><a href="#cb118-28" tabindex="-1"></a>  </span>
<span id="cb118-29"><a href="#cb118-29" tabindex="-1"></a>  left_side <span class="ot">&lt;-</span> gamma_ratio_left <span class="sc">*</span> <span class="fu">integral_left</span>(a, k)</span>
<span id="cb118-30"><a href="#cb118-30" tabindex="-1"></a>  right_side <span class="ot">&lt;-</span> gamma_ratio_right <span class="sc">*</span> <span class="fu">integral_right</span>(a, k)</span>
<span id="cb118-31"><a href="#cb118-31" tabindex="-1"></a>  </span>
<span id="cb118-32"><a href="#cb118-32" tabindex="-1"></a>  <span class="fu">return</span>(left_side <span class="sc">-</span> right_side)</span>
<span id="cb118-33"><a href="#cb118-33" tabindex="-1"></a>}</span>
<span id="cb118-34"><a href="#cb118-34" tabindex="-1"></a></span>
<span id="cb118-35"><a href="#cb118-35" tabindex="-1"></a></span>
<span id="cb118-36"><a href="#cb118-36" tabindex="-1"></a><span class="co"># Define function to find root using Bisection method</span></span>
<span id="cb118-37"><a href="#cb118-37" tabindex="-1"></a>find_a <span class="ot">&lt;-</span> <span class="cf">function</span>(k, <span class="at">tol =</span> <span class="fl">1e-6</span>, <span class="at">max_iter =</span> <span class="dv">1000</span>) {</span>
<span id="cb118-38"><a href="#cb118-38" tabindex="-1"></a>  <span class="co"># Define the function to find zero</span></span>
<span id="cb118-39"><a href="#cb118-39" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(a) <span class="fu">equation_difference</span>(a,k)</span>
<span id="cb118-40"><a href="#cb118-40" tabindex="-1"></a>  </span>
<span id="cb118-41"><a href="#cb118-41" tabindex="-1"></a>  <span class="co"># Initial interval (0, sqrt(k))</span></span>
<span id="cb118-42"><a href="#cb118-42" tabindex="-1"></a>  epsilon <span class="ot">&lt;-</span> <span class="fl">1e-2</span></span>
<span id="cb118-43"><a href="#cb118-43" tabindex="-1"></a>  lower <span class="ot">&lt;-</span> epsilon <span class="sc">*</span> k</span>
<span id="cb118-44"><a href="#cb118-44" tabindex="-1"></a>  upper <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(k)<span class="sc">-</span>epsilon <span class="sc">*</span> k</span>
<span id="cb118-45"><a href="#cb118-45" tabindex="-1"></a>  </span>
<span id="cb118-46"><a href="#cb118-46" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">f</span>(lower) <span class="sc">*</span> <span class="fu">f</span>(upper) <span class="sc">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb118-47"><a href="#cb118-47" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;No sign change detected in the initial interval; adjust the interval.&quot;</span>)</span>
<span id="cb118-48"><a href="#cb118-48" tabindex="-1"></a>  }</span>
<span id="cb118-49"><a href="#cb118-49" tabindex="-1"></a>  <span class="co"># Bisection method loop</span></span>
<span id="cb118-50"><a href="#cb118-50" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>max_iter) {</span>
<span id="cb118-51"><a href="#cb118-51" tabindex="-1"></a>    mid <span class="ot">&lt;-</span> (lower <span class="sc">+</span> upper) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb118-52"><a href="#cb118-52" tabindex="-1"></a>    f_mid <span class="ot">&lt;-</span> <span class="fu">f</span>(mid)</span>
<span id="cb118-53"><a href="#cb118-53" tabindex="-1"></a>    </span>
<span id="cb118-54"><a href="#cb118-54" tabindex="-1"></a>    <span class="cf">if</span> (<span class="fu">abs</span>(f_mid) <span class="sc">&lt;</span> tol) {</span>
<span id="cb118-55"><a href="#cb118-55" tabindex="-1"></a>      <span class="fu">return</span>(mid)</span>
<span id="cb118-56"><a href="#cb118-56" tabindex="-1"></a>    } <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">f</span>(lower) <span class="sc">*</span> f_mid <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb118-57"><a href="#cb118-57" tabindex="-1"></a>      upper <span class="ot">&lt;-</span> mid</span>
<span id="cb118-58"><a href="#cb118-58" tabindex="-1"></a>    } <span class="cf">else</span> {</span>
<span id="cb118-59"><a href="#cb118-59" tabindex="-1"></a>      lower <span class="ot">&lt;-</span> mid</span>
<span id="cb118-60"><a href="#cb118-60" tabindex="-1"></a>    }</span>
<span id="cb118-61"><a href="#cb118-61" tabindex="-1"></a>  }</span>
<span id="cb118-62"><a href="#cb118-62" tabindex="-1"></a>  </span>
<span id="cb118-63"><a href="#cb118-63" tabindex="-1"></a>  <span class="fu">warning</span>(<span class="st">&quot;Bisection method did not converge.&quot;</span>)</span>
<span id="cb118-64"><a href="#cb118-64" tabindex="-1"></a>  <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb118-65"><a href="#cb118-65" tabindex="-1"></a>}</span>
<span id="cb118-66"><a href="#cb118-66" tabindex="-1"></a></span>
<span id="cb118-67"><a href="#cb118-67" tabindex="-1"></a></span>
<span id="cb118-68"><a href="#cb118-68" tabindex="-1"></a></span>
<span id="cb118-69"><a href="#cb118-69" tabindex="-1"></a><span class="co"># Compare solutions for specified k values</span></span>
<span id="cb118-70"><a href="#cb118-70" tabindex="-1"></a>k_values <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>)</span>
<span id="cb118-71"><a href="#cb118-71" tabindex="-1"></a>solutions <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(k_values))</span>
<span id="cb118-72"><a href="#cb118-72" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(k_values)){</span>
<span id="cb118-73"><a href="#cb118-73" tabindex="-1"></a>  solutions[i] <span class="ot">&lt;-</span> <span class="fu">find_a</span>(k_values[i])</span>
<span id="cb118-74"><a href="#cb118-74" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">c</span>(k_values[i],solutions[i]))</span>
<span id="cb118-75"><a href="#cb118-75" tabindex="-1"></a>  </span>
<span id="cb118-76"><a href="#cb118-76" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## [1] 4.0000 1.4921
## [1] 5.00000 1.53354
## [1] 6.000000 1.562709
## [1] 7.000000 1.584401
## [1] 8.000000 1.601186
## [1] 9.000000 1.614631
## [1] 10.000000  1.625255
## [1] 11.00000  1.63412
## [1] 12.000000  1.642318
## [1] 13.000000  1.648403
## [1] 14.000000  1.654475
## [1] 15.000000  1.659097
## [1] 16.000000  1.663984
## [1] 17.000000  1.668095
## [1] 18.000000  1.670115
## [1] 19.000000  1.674316
## [1] 20.000000  1.677342
## [1] 21.000000  1.679503
## [1] 22.00000  1.68108
## [1] 23.000000  1.682334
## [1] 24.000000  1.685662
## [1] 25.000000  1.687012</code></pre>
<pre><code>## Error in find_a(k_values[i]): No sign change detected in the initial interval; adjust the interval.</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" tabindex="-1"></a><span class="fu">names</span>(solutions) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;k=&quot;</span>, k_values)</span>
<span id="cb121-2"><a href="#cb121-2" tabindex="-1"></a>solutions</span></code></pre></div>
<pre><code>##      k=4      k=5      k=6      k=7      k=8      k=9     k=10     k=11 
## 1.492100 1.533540 1.562709 1.584401 1.601186 1.614631 1.625255 1.634120 
##     k=12     k=13     k=14     k=15     k=16     k=17     k=18     k=19 
## 1.642318 1.648403 1.654475 1.659097 1.663984 1.668095 1.670115 1.674316 
##     k=20     k=21     k=22     k=23     k=24     k=25    k=100    k=500 
## 1.677342 1.679503 1.681080 1.682334 1.685662 1.687012 0.000000 0.000000 
##   k=1000 
## 0.000000</code></pre>
<p>Some solutions cannot get via bisection method.We use another method
below.</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a>compare <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(root,solutions),<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">byrow =</span> T)</span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a><span class="fu">colnames</span>(compare) <span class="ot">&lt;-</span> k_values</span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a><span class="fu">rownames</span>(compare) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Exercise 11.4&#39;</span>,<span class="st">&#39;Exercise 11.5&#39;</span>)</span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>compare</span></code></pre></div>
<pre><code>##                      4        5        6        7        8        9       10
## Exercise 11.4 1.492122 1.533513 1.562649 1.584282 1.601216 1.614182 1.625117
## Exercise 11.5 1.492100 1.533540 1.562709 1.584401 1.601186 1.614631 1.625255
##                     11       12       13       14       15       16       17
## Exercise 11.4 1.634035 1.642455 1.647936 1.653534 1.658643 1.664230 1.667150
## Exercise 11.5 1.634120 1.642318 1.648403 1.654475 1.659097 1.663984 1.668095
##                     18       19       20       21       22       23       24
## Exercise 11.4 1.669924 1.673130 1.677301 1.678457 1.681321 1.686331 1.684337
## Exercise 11.5 1.670115 1.674316 1.677342 1.679503 1.681080 1.682334 1.685662
##                     25 100      500     1000
## Exercise 11.4 1.689777   5 11.18034 15.81139
## Exercise 11.5 1.687012   0  0.00000  0.00000</code></pre>
<p><span class="math inline">\(0\)</span> represent we can not find the
optimal values.</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" tabindex="-1"></a>find_root_of_equation <span class="ot">&lt;-</span> <span class="cf">function</span>(k) {</span>
<span id="cb125-2"><a href="#cb125-2" tabindex="-1"></a></span>
<span id="cb125-3"><a href="#cb125-3" tabindex="-1"></a>  <span class="co"># General integral function</span></span>
<span id="cb125-4"><a href="#cb125-4" tabindex="-1"></a>  integral_expr <span class="ot">&lt;-</span> <span class="cf">function</span>(u, n) {</span>
<span id="cb125-5"><a href="#cb125-5" tabindex="-1"></a>    (<span class="dv">1</span> <span class="sc">+</span> u<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (n <span class="sc">-</span> <span class="dv">1</span>))<span class="sc">^</span>(<span class="sc">-</span>n <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb125-6"><a href="#cb125-6" tabindex="-1"></a>  }</span>
<span id="cb125-7"><a href="#cb125-7" tabindex="-1"></a>  </span>
<span id="cb125-8"><a href="#cb125-8" tabindex="-1"></a>  <span class="co"># Calculate constant c_k</span></span>
<span id="cb125-9"><a href="#cb125-9" tabindex="-1"></a>  calculate_c <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a) {</span>
<span id="cb125-10"><a href="#cb125-10" tabindex="-1"></a>    <span class="fu">sqrt</span>(a<span class="sc">^</span><span class="dv">2</span> <span class="sc">*</span> n <span class="sc">/</span> (n <span class="sc">+</span> <span class="dv">1</span> <span class="sc">-</span> a<span class="sc">^</span><span class="dv">2</span>))</span>
<span id="cb125-11"><a href="#cb125-11" tabindex="-1"></a>  }</span>
<span id="cb125-12"><a href="#cb125-12" tabindex="-1"></a>  </span>
<span id="cb125-13"><a href="#cb125-13" tabindex="-1"></a>  <span class="co"># Compute the left or right side of the equation</span></span>
<span id="cb125-14"><a href="#cb125-14" tabindex="-1"></a>  compute_expression <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a) {</span>
<span id="cb125-15"><a href="#cb125-15" tabindex="-1"></a>    c <span class="ot">&lt;-</span> <span class="fu">calculate_c</span>(n <span class="sc">-</span> <span class="dv">1</span>, a)</span>
<span id="cb125-16"><a href="#cb125-16" tabindex="-1"></a>    integral_value <span class="ot">&lt;-</span> <span class="fu">integrate</span>(<span class="cf">function</span>(u) <span class="fu">integral_expr</span>(u, n), <span class="at">lower =</span> <span class="dv">0</span>, <span class="at">upper =</span> c)<span class="sc">$</span>value</span>
<span id="cb125-17"><a href="#cb125-17" tabindex="-1"></a>    <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(pi <span class="sc">*</span> (n <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="fu">exp</span>(<span class="fu">lgamma</span>(n <span class="sc">/</span> <span class="dv">2</span>) <span class="sc">-</span> <span class="fu">lgamma</span>((n <span class="sc">-</span> <span class="dv">1</span>) <span class="sc">/</span> <span class="dv">2</span>)) <span class="sc">*</span> integral_value</span>
<span id="cb125-18"><a href="#cb125-18" tabindex="-1"></a>  }</span>
<span id="cb125-19"><a href="#cb125-19" tabindex="-1"></a>  </span>
<span id="cb125-20"><a href="#cb125-20" tabindex="-1"></a>  <span class="co"># Define the function for the difference between left and right side</span></span>
<span id="cb125-21"><a href="#cb125-21" tabindex="-1"></a>  difference_function <span class="ot">&lt;-</span> <span class="cf">function</span>(a) {</span>
<span id="cb125-22"><a href="#cb125-22" tabindex="-1"></a>    left_side <span class="ot">&lt;-</span> <span class="fu">compute_expression</span>(k, a)</span>
<span id="cb125-23"><a href="#cb125-23" tabindex="-1"></a>    right_side <span class="ot">&lt;-</span> <span class="fu">compute_expression</span>(k <span class="sc">+</span> <span class="dv">1</span>, a)</span>
<span id="cb125-24"><a href="#cb125-24" tabindex="-1"></a>    left_side <span class="sc">-</span> right_side</span>
<span id="cb125-25"><a href="#cb125-25" tabindex="-1"></a>  }</span>
<span id="cb125-26"><a href="#cb125-26" tabindex="-1"></a>  </span>
<span id="cb125-27"><a href="#cb125-27" tabindex="-1"></a>  <span class="co"># Define a small epsilon for interval boundaries</span></span>
<span id="cb125-28"><a href="#cb125-28" tabindex="-1"></a>  epsilon <span class="ot">&lt;-</span> <span class="fl">1e-2</span></span>
<span id="cb125-29"><a href="#cb125-29" tabindex="-1"></a>  <span class="co"># Check if there is a root within the interval</span></span>
<span id="cb125-30"><a href="#cb125-30" tabindex="-1"></a>  <span class="cf">if</span> ((<span class="fu">difference_function</span>(epsilon) <span class="sc">&lt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">difference_function</span>(<span class="fu">sqrt</span>(k) <span class="sc">-</span> epsilon) <span class="sc">&gt;</span> <span class="dv">0</span>) <span class="sc">||</span></span>
<span id="cb125-31"><a href="#cb125-31" tabindex="-1"></a>      (<span class="fu">difference_function</span>(epsilon) <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">&amp;&amp;</span> <span class="fu">difference_function</span>(<span class="fu">sqrt</span>(k) <span class="sc">-</span> epsilon) <span class="sc">&lt;</span> <span class="dv">0</span>)) {</span>
<span id="cb125-32"><a href="#cb125-32" tabindex="-1"></a>    root <span class="ot">&lt;-</span> <span class="fu">uniroot</span>(difference_function, <span class="at">interval =</span> <span class="fu">c</span>(epsilon, <span class="fu">sqrt</span>(k) <span class="sc">-</span> epsilon))<span class="sc">$</span>root</span>
<span id="cb125-33"><a href="#cb125-33" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb125-34"><a href="#cb125-34" tabindex="-1"></a>    root <span class="ot">&lt;-</span> <span class="cn">NA</span></span>
<span id="cb125-35"><a href="#cb125-35" tabindex="-1"></a>  }</span>
<span id="cb125-36"><a href="#cb125-36" tabindex="-1"></a>  </span>
<span id="cb125-37"><a href="#cb125-37" tabindex="-1"></a>  <span class="fu">return</span>(root)</span>
<span id="cb125-38"><a href="#cb125-38" tabindex="-1"></a>}</span>
<span id="cb125-39"><a href="#cb125-39" tabindex="-1"></a></span>
<span id="cb125-40"><a href="#cb125-40" tabindex="-1"></a><span class="co"># Apply the function to a range of k values</span></span>
<span id="cb125-41"><a href="#cb125-41" tabindex="-1"></a>solutions <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="fu">c</span>(<span class="dv">4</span><span class="sc">:</span><span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>), <span class="cf">function</span>(k) {</span>
<span id="cb125-42"><a href="#cb125-42" tabindex="-1"></a>  <span class="fu">find_root_of_equation</span>(k)</span>
<span id="cb125-43"><a href="#cb125-43" tabindex="-1"></a>})</span>
<span id="cb125-44"><a href="#cb125-44" tabindex="-1"></a>solutions</span></code></pre></div>
<pre><code>##  [1] 1.492073 1.533555 1.562745 1.584429 1.601184 1.614516 1.625389 1.634418
##  [9] 1.642026 1.648552 1.654175 1.659099 1.663454 1.667287       NA 1.673832
## [17] 1.676605 1.679148 1.681468 1.683593 1.685546 1.687366       NA       NA
## [25] 1.730903</code></pre>
<p>This method also cannot get some values too.</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a>compare <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(root,solutions),<span class="at">nrow =</span> <span class="dv">2</span>,<span class="at">byrow =</span> T)</span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a><span class="fu">colnames</span>(compare) <span class="ot">&lt;-</span> k_values</span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a><span class="fu">rownames</span>(compare) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;Exercise 11.4&#39;</span>,<span class="st">&#39;Exercise 11.5&#39;</span>)</span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a>compare</span></code></pre></div>
<pre><code>##                      4        5        6        7        8        9       10
## Exercise 11.4 1.492122 1.533513 1.562649 1.584282 1.601216 1.614182 1.625117
## Exercise 11.5 1.492073 1.533555 1.562745 1.584429 1.601184 1.614516 1.625389
##                     11       12       13       14       15       16       17
## Exercise 11.4 1.634035 1.642455 1.647936 1.653534 1.658643 1.664230 1.667150
## Exercise 11.5 1.634418 1.642026 1.648552 1.654175 1.659099 1.663454 1.667287
##                     18       19       20       21       22       23       24
## Exercise 11.4 1.669924 1.673130 1.677301 1.678457 1.681321 1.686331 1.684337
## Exercise 11.5       NA 1.673832 1.676605 1.679148 1.681468 1.683593 1.685546
##                     25 100      500      1000
## Exercise 11.4 1.689777   5 11.18034 15.811388
## Exercise 11.5 1.687366  NA       NA  1.730903</code></pre>
</div>
</div>
<div id="conclusion-22" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,we find that for almost every <span class="math inline">\(k\)</span>(when <span class="math inline">\(k&lt;25\)</span>),the root via two different
manners is almost same.</p>
</div>
</div>
<div id="em-algorithm" class="section level3">
<h3>EM-Algorithm</h3>
<div id="question-24" class="section level4">
<h4>Question</h4>
<p>Suppose<span class="math inline">\(T_1,\cdots, T_n\)</span>are i.i.d.
samples drawn from the exponential distribution with expectation<span class="math inline">\(\lambda\)</span>. Those values greater than<span class="math inline">\(T\)</span>are not observed due to right
censorship, so that the observed values are<span class="math inline">\(Y_i = T_i I(T_i \leq \tau ) + \tau I(T_i &gt; \tau
)\)</span>, <span class="math inline">\(i = 1,\cdots, n\)</span>.
Suppose<span class="math inline">\(\tau = 1\)</span>and the
observed<span class="math inline">\(Y_i\)</span>values are as
follows:</p>
<p>0.54, 0.48, 0.33, 0.43, 1.00, 1.00, 0.91, 1.00, 0.21, 0.85</p>
<p>Use the E-M algorithm to estimate<span class="math inline">\(\lambda\)</span>, compare your result with the
observed data MLE (note:<span class="math inline">\(Y_i\)</span>follows
a mixture distribution)</p>
</div>
<div id="answer-22" class="section level4">
<h4>Answer</h4>
<p>In this problem, we have observed data that is subject to
right-censoring at<span class="math inline">\(\tau = 1\)</span>. Some of
the<span class="math inline">\(T_i\)</span>values are completely
observed (if<span class="math inline">\(T_i \leq \tau\)</span>) and
others are censored (if<span class="math inline">\(T_i &gt;
\tau\)</span>). We can estimate<span class="math inline">\(\lambda\)</span>, the mean of the exponential
distribution, using the Expectation-Maximization (EM) algorithm, which
is well-suited to handle incomplete or censored data.</p>
<div id="step-1-setting-up-the-likelihood-function" class="section level5">
<h5>Step 1: Setting up the likelihood function</h5>
<p>Given that<span class="math inline">\(T_i \sim
\text{Exp}(\lambda)\)</span>, the probability density function for<span class="math inline">\(T_i\)</span>is: <span class="math display">\[
f(t; \lambda) = \frac{1}{\lambda} e^{-t / \lambda}.
\]</span></p>
<p>The observed values are: <span class="math display">\[
Y_i = T_i I(T_i \leq \tau) + \tau I(T_i &gt; \tau),
\]</span> where<span class="math inline">\(Y_i = T_i\)</span>if<span class="math inline">\(T_i \leq \tau\)</span>and<span class="math inline">\(Y_i = \tau\)</span>if<span class="math inline">\(T_i &gt; \tau\)</span>.</p>
<p>The data is thus a mixture of fully observed and censored values: 1.
If<span class="math inline">\(Y_i &lt; \tau\)</span>,<span class="math inline">\(Y_i = T_i\)</span>, and we observe the exact time.
2. If<span class="math inline">\(Y_i = \tau\)</span>, then<span class="math inline">\(T_i\)</span>is censored, and we know only
that<span class="math inline">\(T_i &gt; \tau\)</span>.</p>
<p>The log-likelihood for the observed data consists of two parts: <span class="math display">\[
\log L(\lambda) = \sum_{i \in \text{uncensored}} \log
\left(\frac{1}{\lambda} e^{-Y_i / \lambda}\right) + \sum_{i \in
\text{censored}} \log \left(\int_\tau^\infty \frac{1}{\lambda} e^{-t /
\lambda} \, dt\right).
\]</span></p>
<p>The integral term for censored data simplifies to: <span class="math display">\[
\int_\tau^\infty \frac{1}{\lambda} e^{-t / \lambda} \, dt = e^{-\tau /
\lambda}.
\]</span></p>
<p>Thus, the log-likelihood becomes: <span class="math display">\[
\log L(\lambda) = -\frac{1}{\lambda} \sum_{i \in \text{uncensored}} Y_i
- \frac{1}{\lambda} \cdot \sum_{i \in \text{censored}} \tau - n \log
\lambda.
\]</span></p>
</div>
<div id="step-2-e-m-algorithm-forlambda" class="section level5">
<h5>Step 2: E-M Algorithm for<span class="math inline">\(\lambda\)</span></h5>
<p>Define: 1.<span class="math inline">\(U\)</span>: the set of indices
of uncensored data. 2.<span class="math inline">\(C\)</span>: the set of
indices of censored data.</p>
<p>The EM algorithm iteratively estimates<span class="math inline">\(\lambda\)</span>as follows:</p>
<ol style="list-style-type: decimal">
<li><p><strong>E-Step</strong>: For each censored observation<span class="math inline">\(Y_i = \tau\)</span>, replace the unobserved<span class="math inline">\(T_i\)</span>with its conditional expectation
given<span class="math inline">\(T_i &gt; \tau\)</span>: <span class="math display">\[
E(T_i | T_i &gt; \tau) = \tau + \lambda.
  \]</span> Define the complete data sufficient statistic: <span class="math display">\[
Q(\lambda | \lambda^{(t)}) = \sum_{i \in U} Y_i + \sum_{i \in C} E(T_i |
T_i &gt; \tau, \lambda^{(t)}).
  \]</span></p></li>
<li><p><strong>M-Step</strong>: Maximize the log-likelihood based on the
complete data: <span class="math display">\[
\lambda^{(t+1)} = \frac{\sum_{i \in U} Y_i + \sum_{i \in C} E(T_i | T_i
&gt; \tau, \lambda^{(t)})}{n}.
  \]</span></p></li>
</ol>
<p>This leads to the update: <span class="math display">\[
\lambda^{(t+1)} = \frac{\sum_{i \in U} Y_i + \sum_{i \in C} (\tau +
\lambda^{(t)})}{n}.
\]</span></p>
</div>
<div id="step-3-iterative-computation" class="section level5">
<h5>Step 3: Iterative Computation</h5>
<p>Let’s implement this algorithm in R:</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" tabindex="-1"></a><span class="co"># Observed data</span></span>
<span id="cb129-2"><a href="#cb129-2" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.54</span>, <span class="fl">0.48</span>, <span class="fl">0.33</span>, <span class="fl">0.43</span>, <span class="fl">1.00</span>, <span class="fl">1.00</span>, <span class="fl">0.91</span>, <span class="fl">1.00</span>, <span class="fl">0.21</span>, <span class="fl">0.85</span>)</span>
<span id="cb129-3"><a href="#cb129-3" tabindex="-1"></a>tau <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb129-4"><a href="#cb129-4" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(Y)</span>
<span id="cb129-5"><a href="#cb129-5" tabindex="-1"></a></span>
<span id="cb129-6"><a href="#cb129-6" tabindex="-1"></a><span class="co"># Initial estimate of lambda</span></span>
<span id="cb129-7"><a href="#cb129-7" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">mean</span>(Y)</span>
<span id="cb129-8"><a href="#cb129-8" tabindex="-1"></a>tolerance <span class="ot">&lt;-</span> <span class="fl">1e-6</span></span>
<span id="cb129-9"><a href="#cb129-9" tabindex="-1"></a>diff <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb129-10"><a href="#cb129-10" tabindex="-1"></a>max_iter <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb129-11"><a href="#cb129-11" tabindex="-1"></a>iter <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb129-12"><a href="#cb129-12" tabindex="-1"></a></span>
<span id="cb129-13"><a href="#cb129-13" tabindex="-1"></a><span class="co"># E-M Algorithm</span></span>
<span id="cb129-14"><a href="#cb129-14" tabindex="-1"></a><span class="cf">while</span> (diff <span class="sc">&gt;</span> tolerance <span class="sc">&amp;&amp;</span> iter <span class="sc">&lt;</span> max_iter) {</span>
<span id="cb129-15"><a href="#cb129-15" tabindex="-1"></a>  lambda_old <span class="ot">&lt;-</span> lambda</span>
<span id="cb129-16"><a href="#cb129-16" tabindex="-1"></a>  <span class="co"># Separate uncensored and censored observations</span></span>
<span id="cb129-17"><a href="#cb129-17" tabindex="-1"></a>  uncensored <span class="ot">&lt;-</span> Y[Y <span class="sc">&lt;</span> tau]</span>
<span id="cb129-18"><a href="#cb129-18" tabindex="-1"></a>  censored_count <span class="ot">&lt;-</span> <span class="fu">sum</span>(Y <span class="sc">==</span> tau)</span>
<span id="cb129-19"><a href="#cb129-19" tabindex="-1"></a>  </span>
<span id="cb129-20"><a href="#cb129-20" tabindex="-1"></a>  <span class="co"># E-Step: Expected total for censored values</span></span>
<span id="cb129-21"><a href="#cb129-21" tabindex="-1"></a>  expected_censored_sum <span class="ot">&lt;-</span> censored_count <span class="sc">*</span> (tau <span class="sc">+</span> lambda_old)</span>
<span id="cb129-22"><a href="#cb129-22" tabindex="-1"></a>  </span>
<span id="cb129-23"><a href="#cb129-23" tabindex="-1"></a>  <span class="co"># M-Step: Update lambda</span></span>
<span id="cb129-24"><a href="#cb129-24" tabindex="-1"></a>  lambda <span class="ot">&lt;-</span> (<span class="fu">sum</span>(uncensored) <span class="sc">+</span> expected_censored_sum) <span class="sc">/</span> n</span>
<span id="cb129-25"><a href="#cb129-25" tabindex="-1"></a>  </span>
<span id="cb129-26"><a href="#cb129-26" tabindex="-1"></a>  <span class="co"># Check for convergence</span></span>
<span id="cb129-27"><a href="#cb129-27" tabindex="-1"></a>  diff <span class="ot">&lt;-</span> <span class="fu">abs</span>(lambda <span class="sc">-</span> lambda_old)</span>
<span id="cb129-28"><a href="#cb129-28" tabindex="-1"></a>  iter <span class="ot">&lt;-</span> iter <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb129-29"><a href="#cb129-29" tabindex="-1"></a>}</span>
<span id="cb129-30"><a href="#cb129-30" tabindex="-1"></a></span>
<span id="cb129-31"><a href="#cb129-31" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Estimated lambda using EM algorithm:&quot;</span>, lambda, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Estimated lambda using EM algorithm: 0.9642856</code></pre>
</div>
<div id="step-4-comparison-with-the-mle" class="section level5">
<h5>Step 4: Comparison with the MLE</h5>
<p>For the observed data, the MLE for<span class="math inline">\(\lambda\)</span>can be computed assuming that
the<span class="math inline">\(Y_i\)</span>values follow a mixture
distribution. This requires calculating the MLE separately using the
likelihood that considers both observed and censored values directly,
without the iterative EM approach.</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="co"># Calculate MLE directly for comparison (using uncensored data only)</span></span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a>lambda_mle <span class="ot">&lt;-</span> <span class="fu">mean</span>(uncensored) <span class="sc">/</span> (<span class="dv">1</span> <span class="sc">-</span> censored_count <span class="sc">/</span> n)</span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a></span>
<span id="cb131-4"><a href="#cb131-4" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Observed data MLE for lambda:&quot;</span>, lambda_mle, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Observed data MLE for lambda: 0.7653061</code></pre>
</div>
</div>
<div id="conclusion-23" class="section level4">
<h4>Conclusion</h4>
<p>From the result above,we find that estimated <span class="math inline">\(\lambda\)</span> via EM algorithm is bigger than
MLE,which is more reasonable because EM algorithm considers unobserved
data at the same time.</p>
</div>
</div>
</div>
<div id="homework8" class="section level2">
<h2>Homework8</h2>
<div id="exercises-11.7" class="section level3">
<h3>Exercises 11.7</h3>
<div id="question-25" class="section level4">
<h4>Question</h4>
<p>Use the simplex algorithm to solve the following problem. Minimize
<span class="math inline">\(4 x+2 y+9 z\)</span> subject to <span class="math display">\[
\begin{array}{l}
2 x+y+z \leq 2 \\
x-y+3 z \leq 3 \\
x \geq 0, y \geq 0, z \geq 0
\end{array}
\]</span></p>
</div>
<div id="answer-23" class="section level4">
<h4>Answer</h4>
<p>我们可以利用lpSolve包实现单纯形法来解决线性规划问题。</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" tabindex="-1"></a><span class="co"># 加载 lpSolve 包</span></span>
<span id="cb133-2"><a href="#cb133-2" tabindex="-1"></a><span class="fu">library</span>(lpSolve)</span></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a><span class="co"># 定义目标函数的系数 (Minimize 4x + 2y + 9z)</span></span>
<span id="cb134-2"><a href="#cb134-2" tabindex="-1"></a>objective <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">9</span>)</span>
<span id="cb134-3"><a href="#cb134-3" tabindex="-1"></a></span>
<span id="cb134-4"><a href="#cb134-4" tabindex="-1"></a><span class="co"># 定义约束矩阵 (左侧系数)</span></span>
<span id="cb134-5"><a href="#cb134-5" tabindex="-1"></a>constraints <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(</span>
<span id="cb134-6"><a href="#cb134-6" tabindex="-1"></a>  <span class="dv">2</span>,  <span class="dv">1</span>,  <span class="dv">1</span>,  <span class="co"># 2x + y + z &lt;= 2</span></span>
<span id="cb134-7"><a href="#cb134-7" tabindex="-1"></a>  <span class="dv">1</span>, <span class="sc">-</span><span class="dv">1</span>,  <span class="dv">3</span>   <span class="co"># x - y + 3z &lt;= 3</span></span>
<span id="cb134-8"><a href="#cb134-8" tabindex="-1"></a>), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb134-9"><a href="#cb134-9" tabindex="-1"></a></span>
<span id="cb134-10"><a href="#cb134-10" tabindex="-1"></a><span class="co"># 定义约束的右侧值</span></span>
<span id="cb134-11"><a href="#cb134-11" tabindex="-1"></a>rhs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb134-12"><a href="#cb134-12" tabindex="-1"></a></span>
<span id="cb134-13"><a href="#cb134-13" tabindex="-1"></a><span class="co"># 定义约束类型</span></span>
<span id="cb134-14"><a href="#cb134-14" tabindex="-1"></a>constraint_directions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;&lt;=&quot;</span>, <span class="st">&quot;&lt;=&quot;</span>)</span>
<span id="cb134-15"><a href="#cb134-15" tabindex="-1"></a></span>
<span id="cb134-16"><a href="#cb134-16" tabindex="-1"></a><span class="co"># 求解线性规划</span></span>
<span id="cb134-17"><a href="#cb134-17" tabindex="-1"></a>solution <span class="ot">&lt;-</span> <span class="fu">lp</span>(<span class="st">&quot;min&quot;</span>, objective, constraints, constraint_directions, rhs, </span>
<span id="cb134-18"><a href="#cb134-18" tabindex="-1"></a>               <span class="at">all.int =</span> <span class="cn">FALSE</span>) <span class="co"># 确保变量是非负连续的</span></span>
<span id="cb134-19"><a href="#cb134-19" tabindex="-1"></a></span>
<span id="cb134-20"><a href="#cb134-20" tabindex="-1"></a><span class="co"># 输出结果</span></span>
<span id="cb134-21"><a href="#cb134-21" tabindex="-1"></a><span class="cf">if</span> (solution<span class="sc">$</span>status <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb134-22"><a href="#cb134-22" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Optimal Solution Found:</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb134-23"><a href="#cb134-23" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Objective Value (Minimum):&quot;</span>, solution<span class="sc">$</span>objval, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb134-24"><a href="#cb134-24" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;Values of x, y, z:&quot;</span>, solution<span class="sc">$</span>solution, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb134-25"><a href="#cb134-25" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb134-26"><a href="#cb134-26" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&quot;No Optimal Solution Found.</span><span class="sc">\n</span><span class="st">&quot;</span>)</span>
<span id="cb134-27"><a href="#cb134-27" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Optimal Solution Found:
## Objective Value (Minimum): 0 
## Values of x, y, z: 0 0 0</code></pre>
</div>
<div id="conclusion-24" class="section level4">
<h4>Conclusion</h4>
<p>从上面的结果可以看出，上面约束问题的最优解为0，在<span class="math inline">\(x=0,y=0,z=0\)</span>处取到。</p>
</div>
</div>
<div id="exercises-345" class="section level3">
<h3>Exercises 3,4,5</h3>
<div id="question-26" class="section level4">
<h4>Question</h4>
<ul>
<li>Use both for loops and lapply() to fit linear models to the mtcars
using the formulas stored in this list:</li>
</ul>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>mpg <span class="sc">~</span> disp,</span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li>Fit the model mpg ~ disp to each of the bootstrap replicates of
mtcars in the list below by using a for loop and lapply(). Can you do it
without an anonymous function?</li>
</ul>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a>rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">rep =</span> <span class="cn">TRUE</span>)</span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>mtcars[rows, ]</span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a>})</span></code></pre></div>
<ul>
<li>For each model in the previous two exercises, extract <span class="math inline">\(R^2\)</span> using the function below.</li>
</ul>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
</div>
<div id="answer-24" class="section level4">
<h4>Answer</h4>
<ul>
<li>Exercise 3</li>
</ul>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="co"># 加载数据集</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a></span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a><span class="co"># 定义公式列表</span></span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a>formulas <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb139-6"><a href="#cb139-6" tabindex="-1"></a>  mpg <span class="sc">~</span> disp,</span>
<span id="cb139-7"><a href="#cb139-7" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp),</span>
<span id="cb139-8"><a href="#cb139-8" tabindex="-1"></a>  mpg <span class="sc">~</span> disp <span class="sc">+</span> wt,</span>
<span id="cb139-9"><a href="#cb139-9" tabindex="-1"></a>  mpg <span class="sc">~</span> <span class="fu">I</span>(<span class="dv">1</span> <span class="sc">/</span> disp) <span class="sc">+</span> wt</span>
<span id="cb139-10"><a href="#cb139-10" tabindex="-1"></a>)</span></code></pre></div>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" tabindex="-1"></a><span class="co"># 方法1: 使用 for 循环</span></span>
<span id="cb140-2"><a href="#cb140-2" tabindex="-1"></a>lm_results_for <span class="ot">&lt;-</span> <span class="fu">list</span>()  <span class="co"># 用于存储结果的列表</span></span>
<span id="cb140-3"><a href="#cb140-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(formulas)) {</span>
<span id="cb140-4"><a href="#cb140-4" tabindex="-1"></a>  lm_results_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(formulas[[i]], <span class="at">data =</span> mtcars)</span>
<span id="cb140-5"><a href="#cb140-5" tabindex="-1"></a>}</span>
<span id="cb140-6"><a href="#cb140-6" tabindex="-1"></a><span class="fu">names</span>(lm_results_for) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Model_&quot;</span>, <span class="fu">seq_along</span>(formulas))  <span class="co"># 给结果命名</span></span>
<span id="cb140-7"><a href="#cb140-7" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Results using for loop:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Results using for loop:&quot;</code></pre>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a><span class="fu">print</span>(lm_results_for)</span></code></pre></div>
<pre><code>## $Model_1
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## $Model_2
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## $Model_3
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## $Model_4
## 
## Call:
## lm(formula = formulas[[i]], data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a><span class="co"># 方法2: 使用 lapply 函数</span></span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a>lm_results_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(formulas, <span class="cf">function</span>(formula) <span class="fu">lm</span>(formula, <span class="at">data =</span> mtcars))</span>
<span id="cb144-3"><a href="#cb144-3" tabindex="-1"></a><span class="fu">names</span>(lm_results_lapply) <span class="ot">&lt;-</span> <span class="fu">paste0</span>(<span class="st">&quot;Model_&quot;</span>, <span class="fu">seq_along</span>(formulas))  <span class="co"># 给结果命名</span></span>
<span id="cb144-4"><a href="#cb144-4" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Results using lapply:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Results using lapply:&quot;</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="fu">print</span>(lm_results_lapply)</span></code></pre></div>
<pre><code>## $Model_1
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## $Model_2
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## $Model_3
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## $Model_4
## 
## Call:
## lm(formula = formula, data = mtcars)
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<ul>
<li>Exercise 4</li>
</ul>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a><span class="co"># 引导样本生成</span></span>
<span id="cb148-2"><a href="#cb148-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)  <span class="co"># 确保结果可重复</span></span>
<span id="cb148-3"><a href="#cb148-3" tabindex="-1"></a>bootstraps <span class="ot">&lt;-</span> <span class="fu">lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</span>
<span id="cb148-4"><a href="#cb148-4" tabindex="-1"></a>  rows <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(mtcars), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb148-5"><a href="#cb148-5" tabindex="-1"></a>  mtcars[rows, ]</span>
<span id="cb148-6"><a href="#cb148-6" tabindex="-1"></a>})</span></code></pre></div>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="co"># 初始化存储结果的列表</span></span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a>lm_results_for <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" tabindex="-1"></a><span class="co"># 使用 for 循环拟合模型</span></span>
<span id="cb149-5"><a href="#cb149-5" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(bootstraps)) {</span>
<span id="cb149-6"><a href="#cb149-6" tabindex="-1"></a>  lm_results_for[[i]] <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> bootstraps[[i]])</span>
<span id="cb149-7"><a href="#cb149-7" tabindex="-1"></a>}</span>
<span id="cb149-8"><a href="#cb149-8" tabindex="-1"></a></span>
<span id="cb149-9"><a href="#cb149-9" tabindex="-1"></a><span class="co"># 检查结果</span></span>
<span id="cb149-10"><a href="#cb149-10" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Results using for loop:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Results using for loop:&quot;</code></pre>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" tabindex="-1"></a><span class="fu">print</span>(lm_results_for)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59804     -0.03798  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.38760     -0.03411  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    30.27667     -0.04176  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.25457     -0.03271  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.07161     -0.04129  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    28.51716     -0.03936  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    31.74975     -0.04647  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    27.47887     -0.03405  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.57749     -0.04043  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = bootstraps[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.60505     -0.04017</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" tabindex="-1"></a><span class="co"># 定义命名函数用于拟合模型</span></span>
<span id="cb153-2"><a href="#cb153-2" tabindex="-1"></a>fit_model <span class="ot">&lt;-</span> <span class="cf">function</span>(data) {</span>
<span id="cb153-3"><a href="#cb153-3" tabindex="-1"></a>  <span class="fu">lm</span>(mpg <span class="sc">~</span> disp, <span class="at">data =</span> data)</span>
<span id="cb153-4"><a href="#cb153-4" tabindex="-1"></a>}</span>
<span id="cb153-5"><a href="#cb153-5" tabindex="-1"></a></span>
<span id="cb153-6"><a href="#cb153-6" tabindex="-1"></a><span class="co"># 使用 lapply 调用命名函数</span></span>
<span id="cb153-7"><a href="#cb153-7" tabindex="-1"></a>lm_results_lapply <span class="ot">&lt;-</span> <span class="fu">lapply</span>(bootstraps, fit_model)</span>
<span id="cb153-8"><a href="#cb153-8" tabindex="-1"></a></span>
<span id="cb153-9"><a href="#cb153-9" tabindex="-1"></a><span class="co"># 检查结果</span></span>
<span id="cb153-10"><a href="#cb153-10" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Results using lapply:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Results using lapply:&quot;</code></pre>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" tabindex="-1"></a><span class="fu">print</span>(lm_results_lapply)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.59804     -0.03798  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.38760     -0.03411  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    30.27667     -0.04176  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.25457     -0.03271  
## 
## 
## [[5]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.07161     -0.04129  
## 
## 
## [[6]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    28.51716     -0.03936  
## 
## 
## [[7]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    31.74975     -0.04647  
## 
## 
## [[8]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    27.47887     -0.03405  
## 
## 
## [[9]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.57749     -0.04043  
## 
## 
## [[10]]
## 
## Call:
## lm(formula = mpg ~ disp, data = data)
## 
## Coefficients:
## (Intercept)         disp  
##    29.60505     -0.04017</code></pre>
<ul>
<li>Exercise 5</li>
</ul>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" tabindex="-1"></a>rsq <span class="ot">&lt;-</span> <span class="cf">function</span>(mod) <span class="fu">summary</span>(mod)<span class="sc">$</span>r.squared</span></code></pre></div>
<p>对练习3（多个公式拟合）的<span class="math inline">\(R^2\)</span>提取</p>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a><span class="co"># 假设模型列表来自之前的 for 循环 lm_results_for</span></span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a>r2_for <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(lm_results_for))  <span class="co"># 初始化存储 R^2 的向量</span></span>
<span id="cb158-3"><a href="#cb158-3" tabindex="-1"></a></span>
<span id="cb158-4"><a href="#cb158-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(lm_results_for)) {</span>
<span id="cb158-5"><a href="#cb158-5" tabindex="-1"></a>  r2_for[i] <span class="ot">&lt;-</span> <span class="fu">rsq</span>(lm_results_for[[i]])</span>
<span id="cb158-6"><a href="#cb158-6" tabindex="-1"></a>}</span>
<span id="cb158-7"><a href="#cb158-7" tabindex="-1"></a></span>
<span id="cb158-8"><a href="#cb158-8" tabindex="-1"></a><span class="co"># 输出 R^2 结果</span></span>
<span id="cb158-9"><a href="#cb158-9" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;R^2 values using for loop:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;R^2 values using for loop:&quot;</code></pre>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="fu">print</span>(r2_for)</span></code></pre></div>
<pre><code>##  [1] 0.6497636 0.6820834 0.7530595 0.6101709 0.7226119 0.7533418 0.7311415
##  [8] 0.6293502 0.6554375 0.7238971</code></pre>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="#cb162-1" tabindex="-1"></a><span class="co"># 假设模型列表来自之前的 lapply lm_results_lapply</span></span>
<span id="cb162-2"><a href="#cb162-2" tabindex="-1"></a>r2_lapply <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lm_results_lapply, rsq)  <span class="co"># sapply 将结果简化为向量</span></span>
<span id="cb162-3"><a href="#cb162-3" tabindex="-1"></a></span>
<span id="cb162-4"><a href="#cb162-4" tabindex="-1"></a><span class="co"># 输出 R^2 结果</span></span>
<span id="cb162-5"><a href="#cb162-5" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;R^2 values using lapply:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;R^2 values using lapply:&quot;</code></pre>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="#cb164-1" tabindex="-1"></a><span class="fu">print</span>(r2_lapply)</span></code></pre></div>
<pre><code>##  [1] 0.6497636 0.6820834 0.7530595 0.6101709 0.7226119 0.7533418 0.7311415
##  [8] 0.6293502 0.6554375 0.7238971</code></pre>
<p>对练习4(引导样本拟合)进行<span class="math inline">\(R^2\)</span>提取</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1" tabindex="-1"></a><span class="co"># 假设模型列表来自引导样本的 for 循环 lm_results_for</span></span>
<span id="cb166-2"><a href="#cb166-2" tabindex="-1"></a>bootstrap_r2_for <span class="ot">&lt;-</span> <span class="fu">numeric</span>(<span class="fu">length</span>(lm_results_for))</span>
<span id="cb166-3"><a href="#cb166-3" tabindex="-1"></a></span>
<span id="cb166-4"><a href="#cb166-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(lm_results_for)) {</span>
<span id="cb166-5"><a href="#cb166-5" tabindex="-1"></a>  bootstrap_r2_for[i] <span class="ot">&lt;-</span> <span class="fu">rsq</span>(lm_results_for[[i]])</span>
<span id="cb166-6"><a href="#cb166-6" tabindex="-1"></a>}</span>
<span id="cb166-7"><a href="#cb166-7" tabindex="-1"></a></span>
<span id="cb166-8"><a href="#cb166-8" tabindex="-1"></a><span class="co"># 输出 R^2 结果</span></span>
<span id="cb166-9"><a href="#cb166-9" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Bootstrap R^2 values using for loop:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Bootstrap R^2 values using for loop:&quot;</code></pre>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="#cb168-1" tabindex="-1"></a><span class="fu">print</span>(bootstrap_r2_for)</span></code></pre></div>
<pre><code>##  [1] 0.6497636 0.6820834 0.7530595 0.6101709 0.7226119 0.7533418 0.7311415
##  [8] 0.6293502 0.6554375 0.7238971</code></pre>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a><span class="co"># 假设模型列表来自引导样本的 lapply lm_results_lapply</span></span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a>bootstrap_r2_lapply <span class="ot">&lt;-</span> <span class="fu">sapply</span>(lm_results_lapply, rsq)</span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a></span>
<span id="cb170-4"><a href="#cb170-4" tabindex="-1"></a><span class="co"># 输出 R^2 结果</span></span>
<span id="cb170-5"><a href="#cb170-5" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Bootstrap R^2 values using lapply:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Bootstrap R^2 values using lapply:&quot;</code></pre>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a><span class="fu">print</span>(bootstrap_r2_lapply)</span></code></pre></div>
<pre><code>##  [1] 0.6497636 0.6820834 0.7530595 0.6101709 0.7226119 0.7533418 0.7311415
##  [8] 0.6293502 0.6554375 0.7238971</code></pre>
</div>
<div id="conclusion-25" class="section level4">
<h4>Conclusion</h4>
<p>从以上结果可以看出，用函数型循环lapply可以和for循环达到同样的效果，且具有更好的开发效率和运行效率。</p>
</div>
</div>
<div id="excecises-3-and-6-page-213-214-advanced-r" class="section level3">
<h3>Excecises 3 and 6 (page 213-214, Advanced R)</h3>
<div id="question-27" class="section level4">
<h4>Question</h4>
<ul>
<li>The following code simulates the performance of a t-test for
non-normal data. Use sapply() and an anonymous function to extract the
p-value from every trial.</li>
</ul>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="#cb174-1" tabindex="-1"></a>trials <span class="ot">&lt;-</span> <span class="fu">replicate</span>(</span>
<span id="cb174-2"><a href="#cb174-2" tabindex="-1"></a><span class="dv">100</span>,</span>
<span id="cb174-3"><a href="#cb174-3" tabindex="-1"></a><span class="fu">t.test</span>(<span class="fu">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="fu">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</span>
<span id="cb174-4"><a href="#cb174-4" tabindex="-1"></a><span class="at">simplify =</span> <span class="cn">FALSE</span></span>
<span id="cb174-5"><a href="#cb174-5" tabindex="-1"></a>)</span></code></pre></div>
<ul>
<li>Implement a combination of Map() and vapply() to create an lapply()
variant that iterates in parallel over all of its inputs and stores its
outputs in a vector (or a matrix). What argu- ments should the function
take?</li>
</ul>
</div>
<div id="answer-25" class="section level4">
<h4>Answer</h4>
<ul>
<li>Exercise3</li>
</ul>
<p>从 trials 列表中提取每次试验的 p 值，可以使用 sapply()
和匿名函数实现:</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1" tabindex="-1"></a><span class="co"># 使用 sapply 和匿名函数提取 p 值</span></span>
<span id="cb175-2"><a href="#cb175-2" tabindex="-1"></a>p_values <span class="ot">&lt;-</span> <span class="fu">sapply</span>(trials, <span class="cf">function</span>(trial) trial<span class="sc">$</span>p.value)</span>
<span id="cb175-3"><a href="#cb175-3" tabindex="-1"></a></span>
<span id="cb175-4"><a href="#cb175-4" tabindex="-1"></a><span class="co"># 查看结果</span></span>
<span id="cb175-5"><a href="#cb175-5" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;Extracted p-values:&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;Extracted p-values:&quot;</code></pre>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="#cb177-1" tabindex="-1"></a><span class="fu">print</span>(p_values)</span></code></pre></div>
<pre><code>##   [1] 0.807919932 0.665511753 0.827771652 0.534899644 0.211737338 0.528643574
##   [7] 0.036299941 0.016286246 0.812200341 0.183029433 0.045674206 0.420195198
##  [13] 0.577173408 0.874254166 0.677908319 0.347553226 0.361554497 0.918737314
##  [19] 0.559098294 0.002509499 0.768217661 0.898061689 0.003256698 1.000000000
##  [25] 0.160902588 0.968015378 0.945869071 0.487230574 0.790842602 0.312865917
##  [31] 0.526127245 0.960313898 0.408238277 0.535864285 0.129220433 0.521667733
##  [37] 0.952101571 0.929053803 0.971746957 0.011601477 0.374260383 0.692475913
##  [43] 0.153917384 0.645121214 0.181853971 0.224322502 0.163462092 1.000000000
##  [49] 0.826032130 0.679110040 0.371457538 0.839837144 0.503046077 0.201307366
##  [55] 0.383173622 0.528297119 0.146797813 0.148537031 0.069654366 0.165229047
##  [61] 0.295638950 0.895620390 0.219622769 0.843794785 0.313497276 0.815388972
##  [67] 0.232485704 0.992897313 0.894949409 0.737031460 0.033341396 0.915558739
##  [73] 0.605572394 0.295777799 0.838840978 0.574006877 0.156308726 0.912461904
##  [79] 0.312905736 0.673237060 0.868453722 0.165275770 0.776816328 0.170876446
##  [85] 0.888611596 0.345857314 0.804162036 0.587077292 0.419642761 0.018360012
##  [91] 0.771416249 0.745960582 0.239627472 0.824506887 0.990644333 0.290741422
##  [97] 0.594800048 0.272107922 0.981034416 0.947306215</code></pre>
<p>检查结果</p>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a><span class="co"># 检查第一个试验的 p 值</span></span>
<span id="cb179-2"><a href="#cb179-2" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;P-value from the first trial:&quot;</span>, p_values[<span class="dv">1</span>], <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## P-value from the first trial: 0.8079199</code></pre>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a><span class="co"># 检查显著性水平（例如 0.05）的比例</span></span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a>significant <span class="ot">&lt;-</span> <span class="fu">mean</span>(p_values <span class="sc">&lt;</span> <span class="fl">0.05</span>)</span>
<span id="cb181-3"><a href="#cb181-3" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;Proportion of significant p-values (p &lt; 0.05):&quot;</span>, significant, <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<pre><code>## Proportion of significant p-values (p &lt; 0.05): 0.08</code></pre>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="#cb183-1" tabindex="-1"></a><span class="co"># 绘制 p 值的分布</span></span>
<span id="cb183-2"><a href="#cb183-2" tabindex="-1"></a><span class="fu">hist</span>(p_values, <span class="at">breaks =</span> <span class="dv">20</span>, <span class="at">main =</span> <span class="st">&quot;Distribution of p-values&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;p-value&quot;</span>, <span class="at">col =</span> <span class="st">&quot;skyblue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<ul>
<li>Exercise6</li>
</ul>
<p>以下是一个结合 Map() 和 vapply() 的自定义函数实现，这个函数可以像
lapply() 一样并行迭代多个输入，并将输出存储为向量或矩阵。</p>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1" tabindex="-1"></a>parallel_lapply <span class="ot">&lt;-</span> <span class="cf">function</span>(..., FUN, FUN.VALUE) {</span>
<span id="cb184-2"><a href="#cb184-2" tabindex="-1"></a>  <span class="co"># 使用 Map 将多个输入组合成列表</span></span>
<span id="cb184-3"><a href="#cb184-3" tabindex="-1"></a>  inputs <span class="ot">&lt;-</span> <span class="fu">Map</span>(list, ...)</span>
<span id="cb184-4"><a href="#cb184-4" tabindex="-1"></a>  </span>
<span id="cb184-5"><a href="#cb184-5" tabindex="-1"></a>  <span class="co"># 使用 vapply 并行应用函数，确保输出为向量或矩阵</span></span>
<span id="cb184-6"><a href="#cb184-6" tabindex="-1"></a>  <span class="fu">vapply</span>(inputs, <span class="cf">function</span>(args) <span class="fu">do.call</span>(FUN, args), <span class="at">FUN.VALUE =</span> FUN.VALUE)</span>
<span id="cb184-7"><a href="#cb184-7" tabindex="-1"></a>}</span></code></pre></div>
<p>参数说明</p>
<pre><code>...：
    传入多个并行迭代的输入（如向量、列表等）。
    
FUN：
    要应用的函数，作用于每组并行输入。
    
FUN.VALUE：
    用于 vapply() 的模板，指定输出的类型和结构（如 numeric(1) 表示返回单个数值，numeric(2) 表示返回长度为 2 的向量）。</code></pre>
<p>下面举例具体说明下：</p>
<p>实例1：并行加法</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="#cb186-1" tabindex="-1"></a><span class="co"># 定义一个加法函数</span></span>
<span id="cb186-2"><a href="#cb186-2" tabindex="-1"></a>add <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) x <span class="sc">+</span> y</span>
<span id="cb186-3"><a href="#cb186-3" tabindex="-1"></a></span>
<span id="cb186-4"><a href="#cb186-4" tabindex="-1"></a><span class="co"># 使用 parallel_lapply 实现并行加法</span></span>
<span id="cb186-5"><a href="#cb186-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">parallel_lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">6</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">FUN =</span> add, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">1</span>))</span>
<span id="cb186-6"><a href="#cb186-6" tabindex="-1"></a><span class="fu">print</span>(result)  <span class="co"># 输出: [1]  7  9 11 13 15</span></span></code></pre></div>
<pre><code>## [1]  7  9 11 13 15</code></pre>
<p>实例2：将并行输入组合成矩阵</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a><span class="co"># 定义一个组合函数</span></span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a>combine <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) <span class="fu">c</span>(x, y)</span>
<span id="cb188-3"><a href="#cb188-3" tabindex="-1"></a></span>
<span id="cb188-4"><a href="#cb188-4" tabindex="-1"></a><span class="co"># 使用 parallel_lapply 并行组合</span></span>
<span id="cb188-5"><a href="#cb188-5" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">parallel_lapply</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">FUN =</span> combine, <span class="at">FUN.VALUE =</span> <span class="fu">numeric</span>(<span class="dv">2</span>))</span>
<span id="cb188-6"><a href="#cb188-6" tabindex="-1"></a><span class="fu">print</span>(result)</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]    1    2    3
## [2,]    4    5    6</code></pre>
</div>
<div id="conclusion-26" class="section level4">
<h4>Conclusion</h4>
<p>并行计算可以达到与原来一样的效果且加快运行效率。</p>
</div>
</div>
<div id="excecise4-4-5-page-365-advanced-r" class="section level3">
<h3>Excecise4 4-5 (page 365, Advanced R)</h3>
<div id="question-28" class="section level4">
<h4>Question</h4>
<ul>
<li><p>Make a faster version of chisq.test() that only computes the
chi-square test statistic when the input is two numeric vectors with no
missing values. You can try simplifying chisq.test() or by coding from
the mathematical definition (<a href="http://en" class="uri">http://en</a>.
wikipedia.org/wiki/Pearson%27s_chi-squared_test).</p></li>
<li><p>Can you make a faster version of table() for the case of an input
of two integer vectors with no missing values? Can you use it to speed
up your chi-square test?</p></li>
</ul>
</div>
<div id="answer-26" class="section level4">
<h4>Answer</h4>
<ul>
<li>Exercise4</li>
</ul>
<p>以下是一个加速版的 <code>chisq.test()</code>
实现，只计算卡方检验的统计量（<span class="math inline">\(\chi^2\)</span>），假设输入为两个没有缺失值的数值向量。</p>
<p>公式定义如下：</p>
<p><span class="math display">\[
\chi^2 = \sum \frac{(O_i - E_i)^2}{E_i}
\]</span></p>
<p>其中： - <span class="math inline">\(O_i\)</span>
表示观测值（<code>observed</code>）。 - <span class="math inline">\(E_i\)</span>
表示期望值（<code>expected</code>）。</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a><span class="co"># 加速版卡方检验函数</span></span>
<span id="cb190-2"><a href="#cb190-2" tabindex="-1"></a>fast_chisq_test <span class="ot">&lt;-</span> <span class="cf">function</span>(observed, expected) {</span>
<span id="cb190-3"><a href="#cb190-3" tabindex="-1"></a>  <span class="co"># 确保输入是数值向量，且长度一致</span></span>
<span id="cb190-4"><a href="#cb190-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.numeric</span>(observed) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.numeric</span>(expected)) {</span>
<span id="cb190-5"><a href="#cb190-5" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;输入必须是数值向量。&quot;</span>)</span>
<span id="cb190-6"><a href="#cb190-6" tabindex="-1"></a>  }</span>
<span id="cb190-7"><a href="#cb190-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(observed) <span class="sc">!=</span> <span class="fu">length</span>(expected)) {</span>
<span id="cb190-8"><a href="#cb190-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;观测值和期望值的长度必须一致。&quot;</span>)</span>
<span id="cb190-9"><a href="#cb190-9" tabindex="-1"></a>  }</span>
<span id="cb190-10"><a href="#cb190-10" tabindex="-1"></a>  </span>
<span id="cb190-11"><a href="#cb190-11" tabindex="-1"></a>  <span class="co"># 确保没有缺失值</span></span>
<span id="cb190-12"><a href="#cb190-12" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(<span class="fu">is.na</span>(observed)) <span class="sc">||</span> <span class="fu">any</span>(<span class="fu">is.na</span>(expected))) {</span>
<span id="cb190-13"><a href="#cb190-13" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;输入向量中不能包含缺失值。&quot;</span>)</span>
<span id="cb190-14"><a href="#cb190-14" tabindex="-1"></a>  }</span>
<span id="cb190-15"><a href="#cb190-15" tabindex="-1"></a>  </span>
<span id="cb190-16"><a href="#cb190-16" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb190-17"><a href="#cb190-17" tabindex="-1"></a>  chi_square_statistic <span class="ot">&lt;-</span> <span class="fu">sum</span>((observed <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb190-18"><a href="#cb190-18" tabindex="-1"></a>  </span>
<span id="cb190-19"><a href="#cb190-19" tabindex="-1"></a>  <span class="fu">return</span>(chi_square_statistic)</span>
<span id="cb190-20"><a href="#cb190-20" tabindex="-1"></a>}</span></code></pre></div>
<p>以下给出几个具体实例：</p>
<p>示例 1：简单计算</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1" tabindex="-1"></a><span class="co"># 定义观测值和期望值</span></span>
<span id="cb191-2"><a href="#cb191-2" tabindex="-1"></a>observed <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>, <span class="dv">40</span>)</span>
<span id="cb191-3"><a href="#cb191-3" tabindex="-1"></a>expected <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">18</span>, <span class="dv">35</span>, <span class="dv">35</span>)</span>
<span id="cb191-4"><a href="#cb191-4" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" tabindex="-1"></a><span class="co"># 使用加速版函数计算卡方统计量</span></span>
<span id="cb191-6"><a href="#cb191-6" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test</span>(observed, expected)</span>
<span id="cb191-7"><a href="#cb191-7" tabindex="-1"></a><span class="fu">print</span>(result)  </span></code></pre></div>
<pre><code>## [1] 1.984127</code></pre>
<p>可以使用 R 自带的 <code>chisq.test()</code> 来验证结果：</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1" tabindex="-1"></a><span class="co"># 使用 chisq.test() 验证</span></span>
<span id="cb193-2"><a href="#cb193-2" tabindex="-1"></a>chisq_result <span class="ot">&lt;-</span> <span class="fu">chisq.test</span>(<span class="at">x =</span> observed, <span class="at">p =</span> expected <span class="sc">/</span> <span class="fu">sum</span>(expected), <span class="at">rescale.p =</span> <span class="cn">TRUE</span>)</span>
<span id="cb193-3"><a href="#cb193-3" tabindex="-1"></a><span class="fu">print</span>(chisq_result<span class="sc">$</span>statistic)  <span class="co"># 输出的卡方统计量应该与 fast_chisq_test 一致</span></span></code></pre></div>
<pre><code>## X-squared 
##  1.984127</code></pre>
<ul>
<li>Exercise5</li>
</ul>
<p>以下是针对两个整数向量输入（没有缺失值）的加速版 <code>table()</code>
和基于它的卡方检验实现。这种方法通过直接索引构建列联表，比 R 默认的
<code>table()</code> 更高效，并将其用于加速卡方检验。</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" tabindex="-1"></a><span class="co"># 针对两个整数向量的快速 table 函数</span></span>
<span id="cb195-2"><a href="#cb195-2" tabindex="-1"></a>fast_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb195-3"><a href="#cb195-3" tabindex="-1"></a>  <span class="co"># 确保输入是整数向量并且长度一致</span></span>
<span id="cb195-4"><a href="#cb195-4" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span><span class="fu">is.integer</span>(x) <span class="sc">||</span> <span class="sc">!</span><span class="fu">is.integer</span>(y)) {</span>
<span id="cb195-5"><a href="#cb195-5" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;两个输入必须是整数向量。&quot;</span>)</span>
<span id="cb195-6"><a href="#cb195-6" tabindex="-1"></a>  }</span>
<span id="cb195-7"><a href="#cb195-7" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">length</span>(x) <span class="sc">!=</span> <span class="fu">length</span>(y)) {</span>
<span id="cb195-8"><a href="#cb195-8" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&quot;两个向量的长度必须一致。&quot;</span>)</span>
<span id="cb195-9"><a href="#cb195-9" tabindex="-1"></a>  }</span>
<span id="cb195-10"><a href="#cb195-10" tabindex="-1"></a>  </span>
<span id="cb195-11"><a href="#cb195-11" tabindex="-1"></a>  <span class="co"># 获取 x 和 y 的唯一值</span></span>
<span id="cb195-12"><a href="#cb195-12" tabindex="-1"></a>  x_levels <span class="ot">&lt;-</span> <span class="fu">unique</span>(x)</span>
<span id="cb195-13"><a href="#cb195-13" tabindex="-1"></a>  y_levels <span class="ot">&lt;-</span> <span class="fu">unique</span>(y)</span>
<span id="cb195-14"><a href="#cb195-14" tabindex="-1"></a>  </span>
<span id="cb195-15"><a href="#cb195-15" tabindex="-1"></a>  <span class="co"># 初始化列联表</span></span>
<span id="cb195-16"><a href="#cb195-16" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">length</span>(x_levels), <span class="at">ncol =</span> <span class="fu">length</span>(y_levels))</span>
<span id="cb195-17"><a href="#cb195-17" tabindex="-1"></a>  <span class="fu">rownames</span>(contingency_table) <span class="ot">&lt;-</span> x_levels</span>
<span id="cb195-18"><a href="#cb195-18" tabindex="-1"></a>  <span class="fu">colnames</span>(contingency_table) <span class="ot">&lt;-</span> y_levels</span>
<span id="cb195-19"><a href="#cb195-19" tabindex="-1"></a>  </span>
<span id="cb195-20"><a href="#cb195-20" tabindex="-1"></a>  <span class="co"># 填充列联表</span></span>
<span id="cb195-21"><a href="#cb195-21" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_along</span>(x)) {</span>
<span id="cb195-22"><a href="#cb195-22" tabindex="-1"></a>    row_index <span class="ot">&lt;-</span> <span class="fu">match</span>(x[i], x_levels)</span>
<span id="cb195-23"><a href="#cb195-23" tabindex="-1"></a>    col_index <span class="ot">&lt;-</span> <span class="fu">match</span>(y[i], y_levels)</span>
<span id="cb195-24"><a href="#cb195-24" tabindex="-1"></a>    contingency_table[row_index, col_index] <span class="ot">&lt;-</span> contingency_table[row_index, col_index] <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb195-25"><a href="#cb195-25" tabindex="-1"></a>  }</span>
<span id="cb195-26"><a href="#cb195-26" tabindex="-1"></a>  </span>
<span id="cb195-27"><a href="#cb195-27" tabindex="-1"></a>  <span class="fu">return</span>(contingency_table)</span>
<span id="cb195-28"><a href="#cb195-28" tabindex="-1"></a>}</span></code></pre></div>
<p>使用示例如下</p>
<div class="sourceCode" id="cb196"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a><span class="co"># 示例输入</span></span>
<span id="cb196-2"><a href="#cb196-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb196-3"><a href="#cb196-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb196-4"><a href="#cb196-4" tabindex="-1"></a></span>
<span id="cb196-5"><a href="#cb196-5" tabindex="-1"></a><span class="co"># 计算列联表</span></span>
<span id="cb196-6"><a href="#cb196-6" tabindex="-1"></a>result_table <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb196-7"><a href="#cb196-7" tabindex="-1"></a><span class="fu">print</span>(result_table)</span></code></pre></div>
<pre><code>##   1 2 3
## 1 1 2 0
## 2 1 1 1
## 3 1 0 1</code></pre>
<p>以下基于 <code>fast_table</code> 来实现快速卡方检验</p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" tabindex="-1"></a><span class="co"># 基于 fast_table 的快速卡方检验</span></span>
<span id="cb198-2"><a href="#cb198-2" tabindex="-1"></a>fast_chisq_test_with_table <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb198-3"><a href="#cb198-3" tabindex="-1"></a>  <span class="co"># 计算列联表</span></span>
<span id="cb198-4"><a href="#cb198-4" tabindex="-1"></a>  contingency_table <span class="ot">&lt;-</span> <span class="fu">fast_table</span>(x, y)</span>
<span id="cb198-5"><a href="#cb198-5" tabindex="-1"></a>  </span>
<span id="cb198-6"><a href="#cb198-6" tabindex="-1"></a>  <span class="co"># 计算行和、列和及总数</span></span>
<span id="cb198-7"><a href="#cb198-7" tabindex="-1"></a>  row_totals <span class="ot">&lt;-</span> <span class="fu">rowSums</span>(contingency_table)</span>
<span id="cb198-8"><a href="#cb198-8" tabindex="-1"></a>  col_totals <span class="ot">&lt;-</span> <span class="fu">colSums</span>(contingency_table)</span>
<span id="cb198-9"><a href="#cb198-9" tabindex="-1"></a>  grand_total <span class="ot">&lt;-</span> <span class="fu">sum</span>(contingency_table)</span>
<span id="cb198-10"><a href="#cb198-10" tabindex="-1"></a>  </span>
<span id="cb198-11"><a href="#cb198-11" tabindex="-1"></a>  <span class="co"># 计算期望频数</span></span>
<span id="cb198-12"><a href="#cb198-12" tabindex="-1"></a>  expected <span class="ot">&lt;-</span> <span class="fu">outer</span>(row_totals, col_totals, <span class="at">FUN =</span> <span class="st">&quot;*&quot;</span>) <span class="sc">/</span> grand_total</span>
<span id="cb198-13"><a href="#cb198-13" tabindex="-1"></a>  </span>
<span id="cb198-14"><a href="#cb198-14" tabindex="-1"></a>  <span class="co"># 计算卡方统计量</span></span>
<span id="cb198-15"><a href="#cb198-15" tabindex="-1"></a>  chi_square_statistic <span class="ot">&lt;-</span> <span class="fu">sum</span>((contingency_table <span class="sc">-</span> expected)<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> expected)</span>
<span id="cb198-16"><a href="#cb198-16" tabindex="-1"></a>  </span>
<span id="cb198-17"><a href="#cb198-17" tabindex="-1"></a>  <span class="fu">return</span>(chi_square_statistic)</span>
<span id="cb198-18"><a href="#cb198-18" tabindex="-1"></a>}</span></code></pre></div>
<p>使用示例：</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="#cb199-1" tabindex="-1"></a><span class="co"># 示例输入</span></span>
<span id="cb199-2"><a href="#cb199-2" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb199-3"><a href="#cb199-3" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>))</span>
<span id="cb199-4"><a href="#cb199-4" tabindex="-1"></a></span>
<span id="cb199-5"><a href="#cb199-5" tabindex="-1"></a><span class="co"># 计算卡方统计量</span></span>
<span id="cb199-6"><a href="#cb199-6" tabindex="-1"></a>chisq_result <span class="ot">&lt;-</span> <span class="fu">fast_chisq_test_with_table</span>(x, y)</span>
<span id="cb199-7"><a href="#cb199-7" tabindex="-1"></a><span class="fu">print</span>(chisq_result)</span></code></pre></div>
<pre><code>## [1] 2.888889</code></pre>
</div>
<div id="conclusion-27" class="section level4">
<h4>Conclusion</h4>
<p>通过使用性能优化，不仅可以得到同样的输出，避免了原来函数通用性开销与一系列检查，大大加快了运行效率。</p>
</div>
</div>
</div>
<div id="homework9" class="section level2">
<h2>Homework9</h2>
<div id="exercise-9.8-1" class="section level3">
<h3>Exercise 9.8</h3>
<div id="question-29" class="section level4">
<h4>Question</h4>
<p>This example appears in [40]. Consider the bivariate density <span class="math display">\[
f(x, y) \propto\binom{n}{x} y^{x+a-1}(1-y)^{n-x+b-1}, \quad x=0,1,
\ldots, n, 0 \leq y \leq 1
\]</span> It can be shown (see e.g. [23]) that for fixed <span class="math inline">\(a, b, n\)</span>, the conditional distributions
are <span class="math inline">\(\operatorname{Binomial}(n, y)\)</span>
and <span class="math inline">\(\operatorname{Beta}(x+a, n-x+b)\)</span>
. Use the Gibbs sampler to generate a chain with target joint density
<span class="math inline">\(f(x, y)\)</span> .</p>
<ul>
<li>Write an Rcpp function for Exercise 9.8.</li>
<li>Compare the corresponding generated random numbers with those by the
R function you wrote using the function “qqplot”.</li>
<li>Compare the computation time of the two functions with the function
“microbenchmark”.</li>
<li>Comments your results.</li>
</ul>
</div>
<div id="answer-27" class="section level4">
<h4>Answer</h4>
<p>要用Rcpp编写一个函数来实现以目标联合密度 <span class="math inline">\(f(x, y)\)</span>
为目标的Gibbs采样器，我们可以使用以下步骤：</p>
<ol style="list-style-type: decimal">
<li>Gibbs采样的核心是利用条件分布交替抽样，条件分布分别为：
<ul>
<li><span class="math inline">\(x \sim \text{Binomial}(n,
y)\)</span></li>
<li><span class="math inline">\(y \sim \text{Beta}(x + a, n - x +
b)\)</span></li>
</ul></li>
<li>在Rcpp中，我们可以使用C++标准库的随机数生成器以及Rcpp提供的分布函数（如
<code>R::rbinom</code> 和 <code>R::rbeta</code>）来实现。</li>
</ol>
<div id="step1撰写rcpp函数" class="section level5">
<h5>Step1:撰写Rcpp函数</h5>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="#cb201-1" tabindex="-1"></a><span class="fu">library</span>(Rcpp)</span></code></pre></div>
<pre><code>## Warning: package &#39;Rcpp&#39; was built under R version 4.4.2</code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" tabindex="-1"></a>dir_cpp <span class="ot">&lt;-</span> <span class="st">&#39;../src/&#39;</span></span>
<span id="cb203-2"><a href="#cb203-2" tabindex="-1"></a></span>
<span id="cb203-3"><a href="#cb203-3" tabindex="-1"></a><span class="co"># Can create source file in Rstudio</span></span>
<span id="cb203-4"><a href="#cb203-4" tabindex="-1"></a><span class="fu">sourceCpp</span>(<span class="fu">paste0</span>(dir_cpp,<span class="st">&quot;gibbs_sampler.cpp&quot;</span>))</span>
<span id="cb203-5"><a href="#cb203-5" tabindex="-1"></a></span>
<span id="cb203-6"><a href="#cb203-6" tabindex="-1"></a></span>
<span id="cb203-7"><a href="#cb203-7" tabindex="-1"></a><span class="co"># 设置参数</span></span>
<span id="cb203-8"><a href="#cb203-8" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb203-9"><a href="#cb203-9" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb203-10"><a href="#cb203-10" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb203-11"><a href="#cb203-11" tabindex="-1"></a>num_samples <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb203-12"><a href="#cb203-12" tabindex="-1"></a>burn_in <span class="ot">&lt;-</span> <span class="dv">500</span></span>
<span id="cb203-13"><a href="#cb203-13" tabindex="-1"></a></span>
<span id="cb203-14"><a href="#cb203-14" tabindex="-1"></a><span class="co"># 调用Gibbs采样函数</span></span>
<span id="cb203-15"><a href="#cb203-15" tabindex="-1"></a>Rcpp_results <span class="ot">&lt;-</span> <span class="fu">gibbs_sampler</span>(n, a, b, num_samples, burn_in)</span>
<span id="cb203-16"><a href="#cb203-16" tabindex="-1"></a></span>
<span id="cb203-17"><a href="#cb203-17" tabindex="-1"></a>Rcpp_results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">X =</span> Rcpp_results[,<span class="dv">1</span>],<span class="at">Y =</span> Rcpp_results[,<span class="dv">2</span>])</span>
<span id="cb203-18"><a href="#cb203-18" tabindex="-1"></a><span class="co"># 检查生成的样本</span></span>
<span id="cb203-19"><a href="#cb203-19" tabindex="-1"></a><span class="fu">head</span>(Rcpp_results)</span></code></pre></div>
<pre><code>##   X         Y
## 1 6 0.4890508
## 2 5 0.2830671
## 3 1 0.1214095
## 4 2 0.2394302
## 5 3 0.1541863
## 6 2 0.3785430</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" tabindex="-1"></a><span class="co"># 可视化样本</span></span>
<span id="cb205-2"><a href="#cb205-2" tabindex="-1"></a><span class="fu">plot</span>(Rcpp_results[,<span class="dv">1</span>], Rcpp_results[,<span class="dv">2</span>], <span class="at">main =</span> <span class="st">&quot;Gibbs Sampler Samples&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAtFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmkNtmtttmtv+QOgCQZgCQZjqQkGaQkLaQtpCQttuQtv+Q2/+2ZgC2Zjq2kGa227a229u22/+2/7a2/9u2///bkDrbkGbbtmbbtpDb27bb29vb2//b/9vb////tmb/25D/27b//7b//9v///8bIPw/AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJOElEQVR4nO2d7WKbNhhG5TRevGVdZy9d16Rpt8Xdmq20ybaQxNz/fU0SH8aA9AgQX+Y5PzYcxMurgySgFlhExIoYOoGxQ0EACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEaC7p7LYR48epfubi7EsuHaCtOPqcr88sldn+cC7H44bbGzuI99BhxT0NBMn7M4rKuoHRTtWWN3Vmq4z9ijmaCMj9ib8JVUFDa0ml/lur4j5ijmaBQHq63Mv7XlRDrKGtBf8pupxt6fjn6ctj+t3LTKHqSitUBv7uQFXt5E0XPG3F2d67WfVmJ05t9kNPbrDq7jzLSK1WvQCx+vRAnt/4iFtNsJUhGX9zopcfvpadU0P4w5peD6pb2uJJqlWndOW5UdWLOi0HkyngPSZHTLGjSBjxGLDfCRoLUsTn0FQta3kZfhVqVW1ZlH9TiOiktM1m8+ZRt+c1DXDOV61qVE29VkbUOcpIEydrobaIh0Dv4x1/EUpqtBMVJlgQtkmb8Ob8sy55+ig5L66P2WzIE3KtTkBYZH9JlUj9VncskiN6DXLfWOuQOgnidv4ilNH0ICpN2fnAWC5Sb3HKc/Ys3uRHx63nWsHfXccs+S1pl/N+0Ovkgywf516yHBGkf9xWxIs0WgpIuVhS0fNgL2i8/XcQ5/J4LsLt/v0oaujj9cL+xVUfu5VLvIRRGQR4iVqXZWFAySDu1IPm/p/fn+xE1655J/1sndXA63lm3ygvyE7GQZjtB2Wl+d3+RE5R18IPlWOm7dFEmvPhFbnq3kn8JdblslCxWpzRiZKeGvCA/EQtpthSUu1AUr6JM0EnuLJYuy4x/fFANOD002WWdXCnzXj6oC5jq410658hrmic96B50MR8RS2m2E7Q3pC7R7NdBH7NuXthUrsyWDdXJldtftahIB4K8RCym2VKQPJe+XqWjPriS1qeYl/tL1J3+Q7LptTo9q/Ns5Yjx93UcJLnufbpeJUEPB2kfEUtpthXUPdZ/EugtIgUBKAhAQYARCxoHFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIIBnQWIy9Cuo/n6HpmdBXYXzgOGgUVBCqVknHykooSgo/TxjQdVCip/nK6jCSNVqCqr+SEEUBDOgIJABBYEMBhW0FeJMPy5iekJ95oIC/cyKfkKk+Oxrk3DNKN47GM7j1R+7FbS7Uo9d68dsAsNT+d0LMtXY8LlXQc8b2bPC+LFPw5z+eQtiC0JkY5BW1TqcI7WEzPAs5ljjmsWP6DqIglDISQoKOjyLNbuwqVm85xYkMjzFMn+epiCf4SgIhSg2xFpCBha0S95rYHw2duZjUJC+VyksvaipSTg3JiQod/3c463GhATpm9WYLm9Wp9vF+mlBUz6LBek9WJdj0JQFZa8mNL7Ecu6COglnH3PmKKhWDWcoqJsa1yxOQWA1BYHVYxbEMajmJhQENqEgsEmvgtL+PWpBHINAmU5qXLM4BYHVPQsSGa6FjR+PU1CtcBSEylAQKENBoAwFgTJDCprCheKwgmokWq+gv3AUVPpjqZFPUVDyOzctEUlSB3/rZdR1LH6QqAu5gurnKdo6EhU5jUuQaDVIuzl6XBl/K2/0gtLPjccgpcg0uSX7RTNzmSMXpH7N6DLaXZm+OE2+cQYtaNRjUAtBqn3EZkxTN1QZVQIJKv5tTIKaj0HPm9LP2lSxlaWm3IIOEnWh9nVQINZTGqSLRyufqBP1LxTV795NR1D/LUjP5KSgplBQgu1RhFEJGmAMqoySEQ0tyGSkmLFDmXoF3cMNLMg9Ub8F3cPNWZA8gWnsjyKU2/xcBLk9ijDfMchxIvmwghxbVCeCHB9FmK8gtiCE26MIMxbk9ijCsIJ4odisxVQl6regezgKAuHYxUC4YQU5tqj5CEI3NpZEnaAgXwXdw3EMAuEGFuSeqN+C7uEoCIQbdgyqkajfgu7hehbUPFG/Be1RMqKuBTVsMaWMvRd0D0dBIBy7GAhHQSCcZ0ERWN08Ub8F3cP5FlTcBccgPwrsUBDgmAR14uuIBHXToijIIVG/Bd3DzVnQ7kqna5/d0VJQacyZ0BjUy+yOfuhEUD/fzfdDJ4L6md3RD2xBgK7GoB5md/RDR2exPmZ39MOEroO6OY0jpiRoELoW5PFRhGHouQWJjKhCQC+XxjUZsouNQgBiUEFTYMib1Ukw2M3qZOhCkMOthltQsL7d6rabtyjucLPqFvRYBbEFIfDNqlvQoxWEb1bdgh6vIE9BKajdegqioHbrj1/QMUFBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIA/gWFQtjeCqu/WrO/s3pr+QdL9R7QM8u26nXPxtdgPn732SHDQ7wLCuW+Q/P+d1dyXWCtY2j5F91QrnremLcO1N5Nhp43+rsYkGEB34Libz62xirEL8o1TQ5RPG/MguLo5q13V2fmvYfxN8IowwK+BWEBCtsBDJbvjIIev7UfeJugUKz1t3luGWZ4F6SrYP9eUVbBvF4GMI9B4clfG+sIZu1icVpuGWb4FhS3DdDFLV+rqQ5gFhSoThI3E2NoywCsrThluGcIQaFljFZf2VoELcDRV03zcWXSPwZBDg3Y9rWs3twiSMc1vxEdjC9j6GJ4CAysY0gyOcVgIK6WeagGrWMMgzQ8iQbm67gUcwuK55eYj35ceeP6cASneXQZZh4g9liupNUQlZtkUt4Uj0EDXyjqXmK7yom7kDU/261GCG5Utrb1SdOyZ1iAN6sACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCDA2AWpmWDPGzynqDPGLkjNlrK/i6djxi5ITY3+yXm2UweMXlC0tT7Y0TnjF2SeON8Loxe0u/rZdcZuJ4xeULD8zzKrtXvGLkjNjHaeFd8FYxe01ROjBxymxy5ocCgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIMD/CFYn3JJZ6OIAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="step2撰写r函数" class="section level5">
<h5>Step2:撰写R函数</h5>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1" tabindex="-1"></a><span class="co"># Gibbs sampler function</span></span>
<span id="cb206-2"><a href="#cb206-2" tabindex="-1"></a>r_gibbs_sampler <span class="ot">&lt;-</span> <span class="cf">function</span>(n, a, b ,num_samples, burn_in) {</span>
<span id="cb206-3"><a href="#cb206-3" tabindex="-1"></a>  <span class="co"># Initialize vectors to store samples</span></span>
<span id="cb206-4"><a href="#cb206-4" tabindex="-1"></a>  x_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb206-5"><a href="#cb206-5" tabindex="-1"></a>  y_samples <span class="ot">&lt;-</span> <span class="fu">numeric</span>(num_samples)</span>
<span id="cb206-6"><a href="#cb206-6" tabindex="-1"></a></span>
<span id="cb206-7"><a href="#cb206-7" tabindex="-1"></a>  <span class="co"># Initial values</span></span>
<span id="cb206-8"><a href="#cb206-8" tabindex="-1"></a>  x_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">0</span><span class="sc">:</span>n,<span class="dv">1</span>)</span>
<span id="cb206-9"><a href="#cb206-9" tabindex="-1"></a>  y_samples[<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>)  <span class="co"># Starting with a reasonable value for y</span></span>
<span id="cb206-10"><a href="#cb206-10" tabindex="-1"></a></span>
<span id="cb206-11"><a href="#cb206-11" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>num_samples) {</span>
<span id="cb206-12"><a href="#cb206-12" tabindex="-1"></a>    <span class="co"># Sample x given y</span></span>
<span id="cb206-13"><a href="#cb206-13" tabindex="-1"></a>    y_current <span class="ot">&lt;-</span> y_samples[i <span class="sc">-</span> <span class="dv">1</span>]</span>
<span id="cb206-14"><a href="#cb206-14" tabindex="-1"></a>    x_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="dv">1</span>, n, y_current)</span>
<span id="cb206-15"><a href="#cb206-15" tabindex="-1"></a></span>
<span id="cb206-16"><a href="#cb206-16" tabindex="-1"></a>    <span class="co"># Sample y given x</span></span>
<span id="cb206-17"><a href="#cb206-17" tabindex="-1"></a>    x_current <span class="ot">&lt;-</span> x_samples[i]</span>
<span id="cb206-18"><a href="#cb206-18" tabindex="-1"></a>    alpha <span class="ot">&lt;-</span> x_current <span class="sc">+</span> a</span>
<span id="cb206-19"><a href="#cb206-19" tabindex="-1"></a>    beta <span class="ot">&lt;-</span> n <span class="sc">-</span> x_current <span class="sc">+</span> b</span>
<span id="cb206-20"><a href="#cb206-20" tabindex="-1"></a>    y_samples[i] <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="dv">1</span>, alpha, beta)</span>
<span id="cb206-21"><a href="#cb206-21" tabindex="-1"></a>  }</span>
<span id="cb206-22"><a href="#cb206-22" tabindex="-1"></a></span>
<span id="cb206-23"><a href="#cb206-23" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">data.frame</span>(<span class="at">X =</span> x_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)], <span class="at">Y =</span> y_samples[<span class="sc">-</span>(<span class="dv">1</span><span class="sc">:</span>burn_in)]))</span>
<span id="cb206-24"><a href="#cb206-24" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1" tabindex="-1"></a>R_results <span class="ot">&lt;-</span> <span class="fu">r_gibbs_sampler</span>(n, a, b, num_samples, burn_in)</span>
<span id="cb207-2"><a href="#cb207-2" tabindex="-1"></a></span>
<span id="cb207-3"><a href="#cb207-3" tabindex="-1"></a><span class="co"># 检查生成的样本</span></span>
<span id="cb207-4"><a href="#cb207-4" tabindex="-1"></a><span class="fu">head</span>(R_results)</span></code></pre></div>
<pre><code>##   X         Y
## 1 3 0.4204349
## 2 5 0.4120563
## 3 4 0.4388138
## 4 2 0.3516701
## 5 4 0.4312922
## 6 4 0.3629821</code></pre>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" tabindex="-1"></a><span class="co"># 可视化样本</span></span>
<span id="cb209-2"><a href="#cb209-2" tabindex="-1"></a><span class="fu">plot</span>(R_results[,<span class="dv">1</span>], R_results[,<span class="dv">2</span>], <span class="at">main =</span> <span class="st">&quot;Gibbs Sampler Samples&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;y&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="step3使用qqplot比较两种gibbs采样方法" class="section level5">
<h5>Step3:使用qqplot比较两种Gibbs采样方法</h5>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" tabindex="-1"></a><span class="co"># Q-Q 图比较</span></span>
<span id="cb210-2"><a href="#cb210-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>)) <span class="co"># 设置图形布局为 1 行 2 列</span></span>
<span id="cb210-3"><a href="#cb210-3" tabindex="-1"></a><span class="fu">qqplot</span>(R_results[, <span class="dv">1</span>], Rcpp_results[, <span class="dv">1</span>], </span>
<span id="cb210-4"><a href="#cb210-4" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;QQ Plot of R vs Rcpp (X)&quot;</span>,,<span class="at">xlab =</span> <span class="st">&#39;R&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;Rcpp&#39;</span>)</span>
<span id="cb210-5"><a href="#cb210-5" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb210-6"><a href="#cb210-6" tabindex="-1"></a><span class="fu">qqplot</span>(R_results[, <span class="dv">2</span>], Rcpp_results[, <span class="dv">2</span>], </span>
<span id="cb210-7"><a href="#cb210-7" tabindex="-1"></a>       <span class="at">main =</span> <span class="st">&quot;QQ Plot of R vs Rcpp (Y)&quot;</span>,,<span class="at">xlab =</span> <span class="st">&#39;R&#39;</span>,<span class="at">ylab =</span> <span class="st">&#39;Rcpp&#39;</span>)</span>
<span id="cb210-8"><a href="#cb210-8" tabindex="-1"></a><span class="fu">abline</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>从上面的Q-Q图可以看出，图上的点接近对角线，说明用R函数和Rcpp产生的随机数分布一致。</p>
</div>
<div id="step4比较两种方式的计算时间" class="section level5">
<h5>Step4:比较两种方式的计算时间</h5>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" tabindex="-1"></a><span class="co"># 性能比较</span></span>
<span id="cb211-2"><a href="#cb211-2" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span>
<span id="cb211-3"><a href="#cb211-3" tabindex="-1"></a>ts <span class="ot">&lt;-</span> <span class="fu">microbenchmark</span>(<span class="at">gibbsR=</span><span class="fu">r_gibbs_sampler</span>(n, a, b, num_samples, burn_in),<span class="at">gibbsRcpp=</span><span class="fu">gibbs_sampler</span>(n, a, b, num_samples, burn_in))</span>
<span id="cb211-4"><a href="#cb211-4" tabindex="-1"></a><span class="fu">summary</span>(ts)[,<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">6</span>)]</span></code></pre></div>
<pre><code>##        expr      lq   median       uq
## 1    gibbsR 11.1355 12.06695 13.52800
## 2 gibbsRcpp  1.2086  1.22530  1.35785</code></pre>
<p>从上面的结果可以看出，Rcpp撰写的Gibbs抽样算法具有更快的运行速度。</p>
</div>
</div>
<div id="conclusion-28" class="section level4">
<h4>Conclusion</h4>
<div id="step5对上面的结果给出总结" class="section level5">
<h5>Step5:对上面的结果给出总结</h5>
<ul>
<li>Rcpp与R相比在效果上区别不大，都可以很好的完成任务</li>
<li>Rcpp与R相比具有更快的运行速度，如在本例中其速度接近R函数的10倍</li>
<li>Rcpp的开发成本更高，一般撰写比R函数更加困难一些</li>
</ul>
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
